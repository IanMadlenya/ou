<!DOCTYPE html>
<!-- saved from url=(0014)about:internet -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta http-equiv="x-ua-compatible" content="IE=9" >

<title>Ornstein Uhlenbeck/Vasicek Model of Crop Prices in Alberta </title>

<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 12px;
   margin: 8px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 { 
   font-size:2.2em; 
}

h2 { 
   font-size:1.8em; 
}

h3 { 
   font-size:1.4em; 
}

h4 { 
   font-size:1.0em; 
}

h5 { 
   font-size:0.9em; 
}

h6 { 
   font-size:0.8em; 
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre {	
   margin-top: 0;
   max-width: 95%;
   border: 1px solid #ccc;
   white-space: pre-wrap;
}

pre code {
   display: block; padding: 0.5em;
}

code.r, code.cpp {
   background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * { 
      background: transparent !important; 
      color: black !important; 
      filter:none !important; 
      -ms-filter: none !important; 
   }

   body { 
      font-size:12pt; 
      max-width:100%; 
   }
       
   a, a:visited { 
      text-decoration: underline; 
   }

   hr { 
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote { 
      padding-right: 1em; 
      page-break-inside: avoid; 
   }

   tr, img { 
      page-break-inside: avoid; 
   }

   img { 
      max-width: 100% !important; 
   }

   @page :left { 
      margin: 15mm 20mm 15mm 10mm; 
   }
     
   @page :right { 
      margin: 15mm 10mm 15mm 20mm; 
   }

   p, h2, h3 { 
      orphans: 3; widows: 3; 
   }

   h2, h3 { 
      page-break-after: avoid; 
   }
}

</style>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: rgb(88, 72, 246)
   }

   pre .number {
     color: rgb(0, 0, 205);
   }

   pre .comment {
     color: rgb(76, 136, 107);
   }

   pre .keyword {
     color: rgb(0, 0, 255);
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: rgb(3, 106, 7);
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>


<!-- MathJax scripts -->
<script type="text/javascript" src="https://c328740.ssl.cf1.rackcdn.com/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



</head>

<body>
<h1>Ornstein Uhlenbeck/Vasicek Model of Crop Prices in Alberta </h1>

<h2>1 Introduction</h2>

<p>We use the historic data to estimate the parameters for Ornstein Uhlenbeck process of crop prices in Alberta. And then we use the estimated parameters for Monte Carlo simulation.</p>

<h2>2 Calibrating Ornstein Uhlenbeck Model</h2>

<h3>2.1 Method</h3>

<p>The Ornstein-Uhlenbeck or Vasicek process is   a stochastic process which is stationary, Gaussian, and Markovian. </p>

<p>Over time, the process tends to drift towards its long-term mean: such a process is called mean-reverting.</p>

<p>The Ornstein-Uhlenbeck or Vasicek process is the unique solution to the following stochastic differential equation:(Stochastic Differential Equation, 2008, p44.)</p>

<p>Ornstein-Uhlenbeck model
\[ dX_t =  - \theta_2 X_t dt +\theta_3dW_t,     \]</p>

<p>Vasicek modified it to </p>

<p>\[ dX_t = (\theta_1 - \theta_2X_t)dt +\theta_3dW_t,    X_0 = x_0 \]</p>

<p>\( (\theta_1 - \theta_2X_t)dt \) is <strong>deterministic part</strong>; \( \theta_3dW_t \) is <strong>stochastic part</strong>.</p>

<p>\( dW_t \) is the Brownian motion, which follows random normal distributioin \( N(0,t) \).</p>

<p>\( (\theta_1 - \theta_2X_t) \) is <strong>drift</strong>; \( \theta_3 \) is <strong>diffusion</strong>.</p>

<p>In finance, the model more often is written as:</p>

<p>\[  dS_t = \theta(\mu - S_t)dt + \sigma dW_t \]</p>

<p>where  \( \sigma \) is interpreted as the  instantaneous volatility ,   \( \sigma^2/(2\theta) \) is the long term variance;  \( \mu \) is the long-run equilibrium value of the process, and \( \theta \) is the speed of reversion.</p>

<p>\( \theta \) increases the speed at which the system stabilizes around the long term mean \( \mu \).</p>

<p>\( \sigma \) increases the amount of  randomness entering the system.</p>

<p>&ldquo;The Ornstein-Uhlenbeck process is one of several approaches used to model (with modifications) interest rates, currency exchange rates, and commodity prices stochastically. The parameter \( \mu \) represents the equilibrium or mean value supported by fundamentals; \( \sigma \) the degree of volatility around it caused by shocks, and \( \theta \) the rate by which these shocks dissipate and the variable reverts towards the mean.&rdquo;(Wikipedia)</p>

<p>For \( \theta_2>0 \),  \( X_t~ \) are assumed iid \[ N(\frac{\theta_1}{\theta_2},\frac{\theta_3^{2}}{2\theta_2}) \].</p>

<p>\[ \frac{\theta_1}{\theta_2} = \mu   ~~\mbox{and}~~ \theta_2 = \theta ~~\mbox{and}~~ \theta_3 = \sigma \].</p>

<p>For any \( t>=0 \), the density of the distribution of \( X_t \) given \( X_0 = x_0 \), with mean and variance respectively:</p>

<p>\[ m(t,x) = E_\theta(X_t ~|~ X_0 = x_0) = \frac{\theta_1}{\theta_2} + (x_0-\frac{\theta_1}{\theta_2})e^{-\theta_2t} \]</p>

<p>and</p>

<p>\[ v(t,x) = Var_\theta(X_t ~|~ X_0 = x_0) =\frac{\theta_3^2 (1- e^{-2 \theta_2 t} )}{2 \theta_2}   \]</p>

<h3>2.1.0 Data processing</h3>

<p>We got monthly price data of crops in Alberta from <strong>Statistics Canada</strong><a href="http://www5.statcan.gc.ca/subject-sujet/result-resultat?pid=920&amp;id=2024&amp;lang=eng&amp;type=ARRAY&amp;sortType=3&amp;pageNum=0">http://www5.statcan.gc.ca/subject-sujet/result-resultat?pid=920&amp;id=2024&amp;lang=eng&amp;type=ARRAY&amp;sortType=3&amp;pageNum=0</a>.</p>

<p>In excel, we transform the date format to month/day/year, which save some time.</p>

<pre><code class="r">setwd(&quot;E:/Dropbox/book/economics/485/projects/pricemodel/oumodel&quot;)

crop.price &lt;- read.csv(&quot;abcropprice.csv&quot;, header = T, sep = &quot;,&quot;)
# set the date format
crop.price[, 1] &lt;- as.Date(crop.price[, 1], format = &quot;%d/%m/%Y&quot;)

head(crop.price)
</code></pre>

<pre><code>##         Date Wheat.excluding.durum  Oats Barley Canola Dry.peas
## 1 1985-01-01                 166.0 114.6  127.4  342.0       NA
## 2 1985-02-01                 167.2 116.2  127.4  347.3       NA
## 3 1985-03-01                 166.9 118.4  130.3  350.0       NA
## 4 1985-04-01                 164.8 115.7  127.4  363.8       NA
## 5 1985-05-01                 166.8 105.7  125.6  354.6       NA
## 6 1985-06-01                 166.6 102.2  121.4  349.6       NA
</code></pre>

<p>For the Ornstein Uhlenbeck Model, long term data has more breaks or jumps, so we only use the short term data which is from stable period and capture the current characteristics of the stochastic process. We decide to use the data after 2007.</p>

<pre><code class="r">price &lt;- crop.price[crop.price$Date &gt; &quot;2006-12-01&quot;, ]
head(price)
</code></pre>

<pre><code>##           Date Wheat.excluding.durum  Oats Barley Canola Dry.peas
## 265 2007-01-01                 169.9 149.0  134.5  339.1      181
## 266 2007-02-01                 170.7 152.6  142.7  350.1      189
## 267 2007-03-01                 174.5 163.4  144.8  353.0      205
## 268 2007-04-01                 167.2 165.3  147.2  354.0      230
## 269 2007-05-01                 165.2 165.3  154.4  362.6      239
## 270 2007-06-01                 167.4 167.4  160.8  370.8      249
</code></pre>

<h3>2.2  Calibration using Maximum Likelihood estimates</h3>

<p>There are many ways to calculate the parameters. </p>

<h4>2.2.2 Function &ldquo;ouFit.ML&rdquo;</h4>

<p>Second, we manually use the function from &ldquo;Calibrating the Ornstein-Uhlenbeck (Vasicek) model&rdquo;<a href="http://www.sitmo.com/article/calibrating-the-ornstein-uhlenbeck-model/">http://www.sitmo.com/article/calibrating-the-ornstein-uhlenbeck-model/</a></p>

<p>Function &ldquo;ouFit.ML&rdquo; is saved in file &ldquo;oufit.R&rdquo;.</p>

<pre><code class="r"># function for Calibration using Maximum Likelihood estimates
ouFit.ML = function(spread) {
    n = length(spread)
    delta = 1  # delta 
    Sx = sum(spread[1:n - 1])
    Sy = sum(spread[2:n])
    Sxx = sum((spread[1:n - 1])^2)
    Syy = sum((spread[2:n])^2)
    Sxy = sum((spread[1:n - 1]) * (spread[2:n]))
    mu = (Sy * Sxx - Sx * Sxy)/((n - 1) * (Sxx - Sxy) - (Sx^2 - Sx * Sy))
    theta = -log((Sxy - mu * Sx - mu * Sy + (n - 1) * mu^2)/(Sxx - 2 * mu * 
        Sx + (n - 1) * mu^2))/delta
    a = exp(-theta * delta)
    sigmah2 = (Syy - 2 * a * Sxy + a^2 * Sxx - 2 * mu * (1 - a) * (Sy - a * 
        Sx) + (n - 1) * mu^2 * (1 - a)^2)/(n - 1)
    sigma = sqrt((sigmah2) * 2 * theta/(1 - a^2))
    theta = list(theta = theta, mu = mu, sigma = sigma, sigmah2 = sigmah2)
    return(theta)
}
</code></pre>

<h5>2.2.2.1 Calculate the parameters for wheat</h5>

<pre><code class="r"># source(&#39;oufit.R&#39;) # not necessary

wheat &lt;- as.vector(price[, 2])  # convert to vector 
head(wheat)
</code></pre>

<pre><code>## [1] 169.9 170.7 174.5 167.2 165.2 167.4
</code></pre>

<pre><code class="r"># plot(wheat, type = &#39;l&#39;)
ouFit.ML(wheat)
</code></pre>

<pre><code>## $theta
## [1] 0.1198
## 
## $mu
## [1] 249.9
## 
## $sigma
## [1] 21.99
## 
## $sigmah2
## [1] 430.1
</code></pre>

<pre><code class="r">paraWheat &lt;- c(ouFit.ML(wheat)[[1]], ouFit.ML(wheat)[[2]], ouFit.ML(wheat)[[3]])
</code></pre>

<h5>2.2.2.2 Calculate the parameters for oats</h5>

<pre><code class="r">oats &lt;- as.vector(na.omit(price[, 3]))  # get rid of n/a and convert to vector 
head(oats)
</code></pre>

<pre><code>## [1] 149.0 152.6 163.4 165.3 165.3 167.4
</code></pre>

<pre><code class="r"># plot(oats, type = &#39;l&#39;)
ouFit.ML(oats)
</code></pre>

<pre><code>## $theta
## [1] 0.08256
## 
## $mu
## [1] 186.2
## 
## $sigma
## [1] 9.471
## 
## $sigmah2
## [1] 82.68
</code></pre>

<pre><code class="r">paraOats &lt;- c(ouFit.ML(oats)[[1]], ouFit.ML(oats)[[2]], ouFit.ML(oats)[[3]])
</code></pre>

<h5>2.2.2.3 Calculate the parameters for barley</h5>

<pre><code class="r">barley &lt;- as.vector(na.omit(price[, 4]))  # get rid of n/a and convert to vector 
head(barley)
</code></pre>

<pre><code>## [1] 134.5 142.7 144.8 147.2 154.4 160.8
</code></pre>

<pre><code class="r"># plot(barley, type = &#39;l&#39;)
ouFit.ML(barley)
</code></pre>

<pre><code>## $theta
## [1] 0.04971
## 
## $mu
## [1] 188.8
## 
## $sigma
## [1] 11.29
## 
## $sigmah2
## [1] 121.3
</code></pre>

<pre><code class="r">paraBarley &lt;- c(ouFit.ML(barley)[[1]], ouFit.ML(barley)[[2]], ouFit.ML(barley)[[3]])
</code></pre>

<h5>2.2.2.4 Calculate the parameters for canola</h5>

<pre><code class="r">canola &lt;- as.vector(na.omit(price[, 5]))  # get rid of n/a and convert to vector 
head(canola)
</code></pre>

<pre><code>## [1] 339.1 350.1 353.0 354.0 362.6 370.8
</code></pre>

<pre><code class="r"># plot(canola, type = &#39;l&#39;)
ouFit.ML(canola)
</code></pre>

<pre><code>## $theta
## [1] 0.04689
## 
## $mu
## [1] 507.7
## 
## $sigma
## [1] 18.46
## 
## $sigmah2
## [1] 325.5
</code></pre>

<pre><code class="r">paraCanola &lt;- c(ouFit.ML(canola)[[1]], ouFit.ML(canola)[[2]], ouFit.ML(canola)[[3]])
</code></pre>

<h5>2.2.2.5 Calculate the parameters for Dry peas</h5>

<pre><code class="r">dry.peas &lt;- as.vector(na.omit(price[, 6]))  # get rid of n/a and convert to vector 
head(dry.peas)
</code></pre>

<pre><code>## [1] 181 189 205 230 239 249
</code></pre>

<pre><code class="r"># plot(dry.peas, type = &#39;l&#39;)
ouFit.ML(dry.peas)
</code></pre>

<pre><code>## $theta
## [1] 0.05435
## 
## $mu
## [1] 279.5
## 
## $sigma
## [1] 14.08
## 
## $sigmah2
## [1] 187.7
</code></pre>

<pre><code class="r">paraDrypeas &lt;- c(ouFit.ML(dry.peas)[[1]], ouFit.ML(dry.peas)[[2]], ouFit.ML(dry.peas)[[3]])
</code></pre>

<h5>2.2.2.6 All the parameters estimates</h5>

<pre><code class="r">para &lt;- data.frame(rbind(paraWheat, paraOats, paraBarley, paraCanola, paraDrypeas))
rownames(para) &lt;- c(&quot;Wheat&quot;, &quot;Oats&quot;, &quot;Barley&quot;, &quot;Canola&quot;, &quot;Drypeas&quot;)
colnames(para) &lt;- c(&quot;Theta&quot;, &quot;Mu&quot;, &quot;Delta&quot;)
para
</code></pre>

<pre><code>##           Theta    Mu  Delta
## Wheat   0.11982 249.9 21.993
## Oats    0.08256 186.2  9.471
## Barley  0.04971 188.8 11.290
## Canola  0.04689 507.7 18.465
## Drypeas 0.05435 279.5 14.076
</code></pre>

<h5>2.2.2.7 The price graphs for crops</h5>

<pre><code class="r">plot(wheat, type = &quot;l&quot;, lwd = 2.5, ylim = c(120, 650), xlab = &quot;Crop prices&quot;, 
    col = 1)
lines(oats, type = &quot;l&quot;, lwd = 2.5, col = 2)
lines(barley, type = &quot;l&quot;, lwd = 2.5, col = 3)
lines(canola, type = &quot;l&quot;, lwd = 2.5, col = 4)
lines(dry.peas, type = &quot;l&quot;, lwd = 2.5, col = 5)
legend(&quot;topleft&quot;, c(&quot;wheat&quot;, &quot;oats&quot;, &quot;barley&quot;, &quot;canola&quot;, &quot;dry.peas&quot;), lty = c(1, 
    1), lwd = c(2.5, 2.5), col = c(1, 2, 3, 4, 5))
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAnFBMVEX9/v0AAAAAADkAAGUAAP8AOTkAOWUAOY8AZrUAzQAA//85AAA5ADk5AGU5OWU5OY85ZrU5j9plAABlADllAGVlOQBlOY9lZgBlZjllZmVlj49ltf2POQCPOTmPOWWPZgCPjzmPj2WP27WP29qP2/21ZgC1Zjm124+1/rW1/v3ajzna24/a/rXa/v39tWX924/9/rX9/tr9/v3/AAA0qAzbAAAANHRSTlP//////////////////////////////////////////////////////////////////wD/9XEwmgAAAAlwSFlzAAALEgAACxIB0t1+/AAAHWBJREFUeJztnYl63iiyhkeJz4ntdDpj9zLTx8ms9vTEM/Ei3/+9HaEVUAEFFAhEfU93rF9CpRKv2EH6Q89qUn842gHWMWLwjYrBNyoG36gYfKNi8I2KwTcqBt+oGHyjYvCNisE3KgbfqBh8o2LwjYrBNyoG36gYfKNi8I2KwTcqBt+oGHyjYvCNisE3KgbfqBh8o2LwjYrBNyoG36gYfKNi8I2KwTcqBt+oGHyjYvCNisE3KgbfqBh8o2LwjYrBNyoG36gYfKNi8I2KwTcqBt+oGHyjYvCNisE3KgbfqBh8o2LwjYrBNyoG36gYfKNi8I2KwTcqBt+oGHyjYvCNKgZ8xypZCcFHnHu8+bOLwTcqBt+oGHyjYvCNisE3KgbfqBh8o2LwjYrBN6rCwD9/+obcyeDjxOAbVR7wjmGC1y93/fMP9/3Th/98+lPX3fX9y233fqD9/HH4NW97es6yKwt45/jQ403/OPB+vHn+eDPg/94/DDsu+5ef7kVy5xSfQGVk9c+fv//r75evX+8F4+F/Qfzl5xH38IfBJ1AZ4F9+/vfPv3/698RYgL8dMoR3933/0A3ZPINPoDLA9w//98fXr3+/7Bfwc2q/veOsPpEKAf/UTaX8DF6U8UNRP/764Z7BA7qIPL8Q8GOd/v23FfyQ14uc/rHr/veXu9cvXKvXdTEoykAh4MszX7guLiLRM/gqJZgz+PY0M48hz+Ar1JLWGXxjWoCfDTzcfCMzX7023hHkGXx1uqgI/BsoKexuNO6pA4fkYPNtSaJdOniYuwx+6qnbRuNEn+3jZYznp5UCO5x8GVm94Cyo98to3PyDyPypdCrwolR//SqPxg2Z/js7+0bBq6hrBz+neHU0TkzIoDF/Jmmog8mXAX43GiegM3hAOujawc+1+m007oFr9ZB2/fO1gy/PfJECxmVCyTP4igSNxzH48wschz0MvOhs68ACmcHTyjD+Hkg+FrxYCyEEVMEZPKlM8y4OAj/Ph13/4k3Hqj3wfvsdKiTFP9xpO9wjdI2BN/I9CHw/rn2ILuMZvEvFgUeZvgIlhX34bVwrOQ7L9s8//vL+92mO9fA8Dc/E82egD68t8Ga8JYOHuSvgx/7aZVj2492yquLxsn+6Ef95e34ylQeepjknsvopu3/ZFtBNKydffv3+L2icrinwFrp1V+4E2hH+Oiy7rpx8/fqPX6HRGgbvPGRTguYc8v3IigbowyMkDctuKyf7x9+gnL4p8Da4daf4h8uV+A/36srJcV0doPOBD0vVlTfnfpMWSWorJ1//ArbsTgfeshjOCjeMfAWDNM9/TGq+GF0YF0La0Z4V/KNh7t3ZwM/rIKsBPzS6X790HTBNivvqvWRZD1cieFG5E+0woHONwfvIsh7OQfYY8EOba5wXzaNzkaoNvEjuokf1ab/shYaMcbTmXOBXetWAF51tg4DlTgweL9tCSBfYkmv1F6CksFOTfR6c+/xX6bWm87KaTh+3PRt4aNOww/M4rCzgYe6Sv6KK+PThv8vg3Ppa0yd50M7P87p0UvBObVilwblpWdV8aF95PBN4mZ33komqwc+NQXlwbl5IOYKH1tWcFbz36riqwY/Jej84N6X4eX+4+eJlAY/AGkS+DPDjC+s//Q4Nzm2DduHmS5cFNeZldhWDn2v1u8G5uVY/7Y8wX7is4H1PR6oQ8OWZzylzqY5iyuArlbkej3trKYOvVEbwyLfVMvhKtQe/vKoWR5TB1ynoZQfzrIxQAwgx+MMFT73weB195eCX+boIjXd6avC2mZc4Ay5VCv6icPAeKMJfVRdlIQ/4a1BS2Jfbsevmx1/e/2leI/ny89/GydXyW27FR4vEr+LB++TUZwYPc5fBi+7Z7k6sllzWSL7cfvguPk+kfHNyfsXtGKvlg09YJ483UUZWL4AOWf3YUTuvkRQjM69f79VvTs6vuC0d/NoaS9b9Em+iDPDT2OvdNBI7rZEcGT/cqd+cnF5xO7V1ygW/fTkk1QgLgY0ywEspflkjKcCLFK98c1JsPn0oHLzfhwTaBr+U8QLtPAD7cnupTsASB6ZX3I73WTJ4eNsdmuKKWBUC/vXLMiA7rpEcJ9r9eanVb8sppwy/bPB+o6oU3GsGL2leI2n5VMF0nx1FlNHrgsGHgV/WSJrBz7dZLHjzL2dwkmviVBx4t4oG7ztHlsHjtYIvkbwneJp7YPCHy3c1BIP3EIOnsFIf+OUuO6JYoxTgkdVJqjsIsMPgCeX9BYmTgk+sEsHj9uEORl7YoXpTfE8Xb0QyTKXxPIHsynYxeDL5fzqEzn9/S9WB9xsCySmDN2YnCd1vDHxR5E2+MHganQc8pfMM/jD5J2wG7yPPwa9sssyy8i77w67veULd4Msh7193Z/BeOg14Ys/PDt53uDubfPtpPFZIRV8fFIMnkXfHLLnjvgbrAu876plNdj/2R+n9ZvCHyBM8dUbv9GCvqsDnSDlB8pxukYA7gz9EXlMqfZa+07mgi+DTJBRfoUIpSyUpSD7g03D3jgmKT5MIRX53DqV6wc8BfFZP0/ugiuDTJMpfvGl/FQh+eU0RJhzwmn5aV7yCV5TivSe4ZNBEEg0+rStewaPLeJovTWJUJvg+OVGkPL2oqFZfKPgkjbMQ+flRD/gsYx2+KoT5JC/y9TTnGLxTPtXHeip3WYa1PVUWdy/yCZpz24oHSuWYwOSt0sBPygI+W4pn8Hhh3KqmOcfg8coCPti0n7JMUvYWgw8w7ScG7yOEXxSVO5Hb74t4UvD+s9ZzqFTumcCPFfr5JWUepr3E4L2UB/z8lvGko3P+09ZzqFjwCM+iwd++++dfvm1fh8Wb9hKD91N68OPbSC/7p7TNOd9Z65nUNvhQ0z5i8L5yusbgw1Uw95OA916nkkclg3c6x+DDxeCDTHuIwQfI4V0N4D3XqWQTgw8yjVeh4Mvm7vKPwQeLwYeZRstrYVpGlQ7e7uAJwB9FgMGHmUaLwYfK5iGDD1X53Bl8EjH4QNNoYZYkEl3KRxWAt/lYPnhEBE9BMq9hY/CBprGiBU9Hi8EHmsbKB7yzxU+3TL0G7jYvTwF+Xq3sCEr7TgoGb1R+8I4JG8tREmYM3iga8KgI3sBbpmFfyKHz+HW8jG6eBvxSziPsMPj+LOC3fNwUXNlPAK0S7i2BB8NfMHhN5wGvb12Ahz1sErhVgEyOlg4eGcFK1e1ibrpBR32MEvh1vE4PXt7W2uv77D8Km6MWWZoMnp4EvHbOeJal3R6DDfkS02LUEPjtXFPiDLd6gX2JaTmCfT0zeEvffKjZhTqDt4gCfGQEG7vm/e3KD1Ehb6/FCnT23OAJ7cqZB4O36mzgo04/Ugw+wnBdqBFi8GnCF6+ywaeLbk/Lp+PO4JMEr0Ctgvc0zeDpTGNUCvjzcS8bfNL49jHO4AlNI1QK+BNybxi8h3UGT2narcTxjTZ/Ru4tg0fbZ/Ckpt1i8AlVMPjk8Y0dZGPwpKadSh/fSPIMHlK6L03miG8M+lNyL/i7c3niG0G+YfDTd0eAr4+AX5pEmnYpV3wjVtXncSSvEODnTwqCX5qqPsX3bvLNgjek9VmpvjSZMbod70toGHwS0w7ljG4r+HNyR4J/NKXqCNN2HRDdhku2DP7lp/uny/7xEgqRqDnH4BMLW8YvX5TUlapyd0R0w9dsGfzr1/vhv+dPuOZctyjCrUNim8Fvmsv4gflT190AARKl+HLAn5R7fK0+SXPuoNimXF5ZuspszjH45MKBf/3SffjvT/ekpi06KrIZ/Kq5cvfl5vnzd6AYXwTW+4LBH7cWdV4FvdtzQmGbcwN4eJBm6cjfF/IB4JfV5/5n0kjvvK1sPbSPPFL8I5jiX24H5EQp/uLo98to7006MXd8GQ8Pzgm93H74DwV40pdLR4n2PddliqRW//wR6sb3BL8k9yJi+/Tcy2nOnTuayxMO/FPy0TnmnlnY0Tl604qYe25Fz8AJNi2LuWcXciIGND4TaVoSc88vn8mWqcp45n6Ajq/Vn7zZVKpwZfwtOOsqzvQs5n6MkCl+aM+9863Zo8Az9oOEz+pfvyQo45n7UUKCF/OrfWv2CPDM/TAdW8Yz98OEL+MTpHjmfpw8mnOP1GU8Z/QHCglerJehTvHM/Ughy3jzdLtg08z9UB3Wc8fcj9VR4Jn7wToIPHM/WgeAP/10tiqUG/z5p69WorzgCaBfR53NWpQVvJO6u7Pv+prJkygzeMcZrvcpXF8zeCLlBI/jbiE/Yp/J8wMQp4LAz8jN5KfUvv7L5GOUETyOu9gAj6+ox78MPlLFgJcSOkheIj3l9ww+SvnAo7mDmb2SwOWynhWmcsArP3S31Ix9KeYjnGtex8+rnwN36i/tZAgyg49RmeB3xTyDp1ah4PXfDJ5a5YJXdjB4apUKXt0BM26afOy9Fwte2XMy8BGOXyuK8KFk8Nu+c4EPR3atK9yJcsH30oDNqcCHE9NPPCl4Cf3JwKuuY+8CeF4iYqBo8MtIren+qiSv9Dpic2xDuPOCn9CfBbyEbx1bRpE3BgqPgeLBi2MnAS9DVoaWTejXh8R4o+cGb7y96sArPySchgR9PQ9DWu4zOAoqAW+am+FziaOl18jNz4Gy014QnBr8wN1wtCbyrpJ8T1iaaWY7LcydaPBEHxy0g++1aZjddqQauX3VGaPu7ijwVJ8fw4EfQ0nPQEXgMa4Gdc8ExkEseKrvxzvAL4Fk9acDv04dx59xGPgMKV6+szWxL+BrIY9zdJ1AfI0HehB4qg8OIsHrZ9QCHvuEhozAhMVBBbV6G/hKyPtQ9F4vclbwxvuqIbNfu+RTXuMY8Mmbc3bwZSf5Nf2mu8TV1THg01fuzPe1kI+djJJOFFNlHLoKJJ+gORf0/XjLSknHOenjNlhSHT2ZjgKfPMU7wTuDHaYsT+NR4FM356w3VTj5LC4dBj7YtBo2IMGXDp7aI2k18VaQDtyvgq5UNfiiyVNn9B2gI8EPzbmbh+isPnDctWzwpOa0UYol2R8GXlTuHsSHxD9HVe4IwBdGnp47uHMG7381iubc00306Jzx9Sce550UvK1xPHAf/vPr4V1OtR9GN+fSpHgv8EWRz8JdFPHdSN4fPUFzTpCHvl7B4CmkxswIWfk9g/cmX3atvlrwBK5Md6ZFzJVGfvjZLbv8yBcN3n0n5wW/TjNT9mrgxa8VvN9FKwdfaO2OhLuArsfLlUp+/LHt8bksg0+haE8m6Ls63cDYDh5/3ZLBY26jyLyeIsFP/+LAr6EY/LEiSPDwfgFaIj9tSuA9rszg6UWS0YMygQ9I8gWDR93EGcFbucvk9+Dx164dfIG1u2QZvQF8WJJn8ORKD34FvuwOSPLlgkfeQXF5PVWVHtAKfCrrN/C9f5Jn8JSimfZpL+KnrSupK0cBj443+2EG7yOi6b5u8GoP3thx65vkqwdfUCFPNNnKldOD+/Uk7x7lsB9m8HhRTbKLB4/JeIoFj2+XlAOexg4ipwcOyHk9g8+pRFMvNmHB49w5F/gDydPNpvYGD5JvAbzzbccZRDiLnga8c4Ky3YkKwCvkjwJ/KPcFvJ7k7WtR7F4cBt43IrtjV8sTXtcAXp9tpx6DTqwBfEyCX010IafRiPKyRvDmU+ZjXuRPA34iP53mk9dQiHSZHAzexr1x8GNZL87zfilDrGiXR4K+2zL67anwIX8w+Nk1EvAjcfHe29zkqcbA50D7UFd27nWCn/Lm2LrdcskRfD+l+iALmItovxGrPtSFro7Au10u7ls5oF2kXPDXxOCnE6+T5vc7u86uEn1NuyO0tsOJfQ9+tTG5Bjp4KPjrFOAXo4nQ7+ghuOtn2/xyLKGApQbRuzVKBN8nAb9apUe/rHSQr+g8Qftt9QuYSu+WHmi5QKHgp2x5DOqZe9psXq//augpnoFut9JhLFasZ8BmDM8DtIbCrX0gqVsDjswDwUtvfaQDr9judwVsZA6wnq+BN1s1HVIfSbODV1dvo+x+AU/HRr408NdSPuQ5soTQZoIQvMJqvY4947YdQvi1gA8kXyD4JU0mAm+yYfisEU6Sm2vt6Xoq9U0n2EsB99M4gBd/XOihAqGb+rMMEXEgeOmveuskHWFwd1pcJ5taP5/sjdhgdAR1y5m7kzxYE+jGTzUWBn51JxX4Hph+FPvWWxi8fmQLEd+mkIBaycNVwJF8WeAld8RWklk0u3sWO8wx4ZbKcSpC530AYoqm5JsM1B/82JNpuNtjwMvuJAOvZ+zX85VSgN+TJ+ceRr448Op2qgmTUvKWOglDr7BrektfQtQxk3Qd7cCbyZvBG044N/ilVJfKdjN49xqEPXjph5YdUHQXaeBt5E39PEZHigNPPYdG/0jENl1jH9Buyd6vLPXtUHUV69xtmb2xg8/kyyHg1ShWOj2Tv9zfAB5R3XcMKGy9uVHcpdWQe/CE5MsDH3FFjHZT8+b+Q3OLVzlTOk8P3u3Gb/x1Ja+DBVhumb3+BFj69MFnsTDwybnvwEslgRd4IIeIz+Nn5tO/QIJfOnKATlzbYE754H0yesyoFSSNvFwDsF5da3JCYWmw97v318l6W6Wf7HexI8Dv+lWknm+0dcz8BNgtBbzW0nedtwZMkDXJUy6011spmqFr5CsEv3aDeMTmFWpiCuxWJ/uwy3wc57nDBUu+IcT9RSb5aPABX5o0gPfk7v2ML27JD9k+87Gf5g4XLP31xM7bi0vyseBDvjsHg0dy36q9UeB7uD5n9gGb4LfS1zGErgl4IblDx4IHvjTpMg0Mmo3daZ7c48mDrjjOcoSSK1+uyROq9JtBnK1epfwUHzVaqhWEqHN0v7bJM4Tg13Fzc8XbJo9OOimIfBXP2Igu4/2/NGkA77ySkF4Qok7SJLUdoR48x1mGMEv8y7w8yO+poc9d0WcG7296H2/o5q+1IMRGldRbhAfvSPBLylN9wJIHanIeuUUY+fzggWjzAG/+jc5arVcLAy8uPXep7fa7BdXgvSoI82XygvduzkWA39+Z2IOblYa8GgI8zB3sR8WQfwMLZ7+aYUCSz1+5CwcPxNCwZ8tkvfN6pHvaObsQW/m+98DtEwH3JXxO8EBzzj5pGO7jdl1GCIyhdd45kNGaFADeltNLI2bA9V0+va0TaX3O2of3JZ89xQeDh1PGGG1w1cos2/Wc4M3cQcmHoYBjnrUL7Qt+PtGjSZe7OQfGKwY8dE/D3cbV6wG5wO+aAs4kLRUEQFGggF+DeIP3zuxz1+pDwRu4v2kVe6xrvuTNTUBE7U2VenCsncrVU6+sa+8Imnxm8O4SFJDycvZVb0vutoVLl+RFn/J00C+jX8JsKflNxjznWNuxfun7c98DdBWPzJ6iOffuHt1XHwD+CuS+xeB06EqR02vLFU0T8sCOZc8OeeGokvwnV5XsPRT8HCVY8hSVu9cvN0jw7rbSTiBHdXACkMttL/Bm7v6EhHNLDrB5qsD26+RXvdFrPWbRNOceLhOBhyEqUaOgXgo6UvLSuomdI67raFLGFlW3CcBP5yIfffthbHPu8X8+IcBj+kMVGe7AHDFr9u+6c8v0uITgr6YpVbt8Se19igAvTsZlegTNuRvx53HfntuZNq/jMoOH9lriRRqjxJJX303Rw+DtV8PqSqmPqJYU8H5mdadQlbyctXrMkKci4zxT4zW3Q+5HXl7/sD0E++eTLMFbYEQlctCYi3xG8LhJDpIMvlvjyJP8zFxeBaMN1Hdm8HTcacGjyOcDb5lrYQQP7XX1kNrPVq6qJfV+Wgozkd/eU0IEPnC+UJAQ5HOCN4cEvTD4TQZeWe+0vslmerWJRD6I+/7aObmvnZq21TV2A3neXg3GbEhGr+SZnlOROjm/l14oYHpgTbkz3JmQl/vapDdftGTwUFBnYSj37KAdmJyQqvlSyWQAb3DE0I2Um3u/NOmNhw8Av98PgQ/kLmUJuwnL9uC64CUXdkcU3PIoQn7uOx805QYPztAAwOtRtY5suK8rkZe7dsHBMdujZFtCC521y9/BZyCvzE9cXvCGuTkg+G17Q4aqR69Q5LdCGkdGLXmIeb4/cBLQXbb+Poy7pScrH/iN+Y7z284LgDucYCEtrKdJTeqpuhGrTeN8f5j7LtjWK49xO41M3beZwS+b0n6Ap9aPDSOzSB30BGCrQXFG1Qvoe2C22MHCpIIdOKRWL2X2UEoGuftpGfc0HFQ2Q6c5yTJcqQTuPZzlHNOc6+Tce3gM9GFWKWhMX6YpyuVJbiTgC4BrFfD0HQBeKbMF9u5qSdf7FBLXh+1K8oET3OTH1HadcrQnnx+8nrVPqOfOZWC4MsKDRODlzsFCMnO3SgCv+jNrmkCwCxs5aGUnr/5BSx70rwa8ruzgwXqcIfqiuScFXyfwRbnBqyy3qANjMX6Q2gp+Me95mS3Bh/t1vDKDN3HvoeinmJxgI6+Bx15tTfCRrh2r7OClH7uKnB42LXi1UberdMJaw1Sdz/e5wdu46+BJuFum8bwp4HGdwluI2rlnBb9rxu2Om38Fy5jklf675aedvHS0du4Zwe+b7/oJxg71GBkn8hg67C3opSPVc88LXvoF8lBhRFxaljI1Yt3WwSs/TFM25I4bIu8O00FTr+CY00ZPiLTgRve17NDviv/6uR8B3hz/UuQSglemP1qQKSOC+pj92bhnB2/v45QGbyIubLrqvGkOoTgCbi9hSb07RHnBuzPbNOAVF0CfdM9spc4ZuOcFX0Tv9pLy5x8Sc3g8+Jzcs4IvAfvE7QpO5lCSB2YHlXAX0coLPsIanQzUe3DsYNcIPQn3nOBLiTELO/nQ29Sfv5sychLlA19FpKnke7UNV8UdYJUTfIStfFJ7996kvZXcAFJFLJosSlvhv3I/H3YGD0mv+p2Pes/gTZI7eU+IncFbZe9frlsM3qqzYmfwzYrBNyoG36gYfKNi8I2KwTcqBt+oosF7f2mSVYRiwQd8RpxVgmLBA1+aRJpmHSpO8Y0quoz3/NIkqxBxrb5RMfhGxc25RsWVu0aVoDnXGV5OzipJKVM8q2RFgrc056RHwGklVMks12eY1nJMrX5TJTdbt2EG36hhBt+oYQbfqOHM4Oe6nb12V8nN1m04d4p//XLjDFPJzdZtOHtW//LTPeUVWUWIpoxnVScG36gYfKNi8I2KwTcqBt+oGHyjYvCNisE3KgLwL7fdfnZOvMQkz7s01sdZRfSGX7907+6TeDzEhRgqobQcD17E4uMlgSuqREfx8w/3Saw/Dk9UAsMPd2KCWgLDIi4eiS3HgxezMJ8/2SZmBelJ3OHDXQrrzz/+cpfA7Xk6agKPnz9/F2ZJLceDH71KM44zmE1g/fXrP4ekQ2/4+fNfRVafwOM5xZNajgcvpt+mAS8GhBNYf7wReSa94eeP4+OUIj6mwp3UcsEp/uX2JoX1weJrohT/PVEeNdR1+qf33wpL8YnK+DEBpbD+OM4nuklQxv86ckkQH3NSL6yMFxlyglr9xD2NdZHiExh+uJuyE3LDc4ontVxsO35KmHc1teMHi9St7VlPHXkPAffcNSoG36gYfKNi8I2KwTcqBt+oGHyjYvCNisE3KgbfqBh8o2LwjYrBNyoG36gYfKNi8I2KwTcqBt+oGHyjYvCNqinwT12Hma2YYrJ4cWoJ/KOYA/uQYmVvhWoI/LQI5fXL3fOPv7z/Ns2Ffvn5b+PE5X7ZEsd+H1L8cHj4NU+YfnK8rr9GNQR+/cbGuFbjYVyX93L74fvTCHXeGhfAffo2r657GFcwiBUsCZaMHKuWwC/sRBkuYIpVSbd3/etXkeTnLXFs+H8q5kUeIZYnn/Gdrg2BF2sOp40JruA8Mn0YF+lNWwv4Mez45m6R/3+cy4MTqSHwWxkvpfhh35zipy01xW9f3gK+xVS3GgK/1upHqksZfzkznbdm8ONC6k/fpkBP89r0U6kl8Es7fgQ/1+p/+vNSq5+2lmJgrdWLow9cqz+btnrbKWtwFjH43VYbahx8u2LwjYrBNyoG36gYfKNi8I2KwTcqBt+oGHyjYvCNisE3KgbfqBh8o2LwjYrBNyoG36j+HxY9pyQmFfQhAAAAAElFTkSuQmCC" alt="plot of chunk unnamed-chunk-10"/> </p>

<h2>3 Generate the price vectors/matrices by simulation</h2>

<p>There are two packages we can use to generate Vasicek process.</p>

<p>The following simulation equation can be used for generating paths (sampled with fixed time steps of \( \delta \)). The equation is an exact solution of the SDE.
\[ S_{i+1} = S+i e^{-\theta \delta} + \mu (1- e^{-\theta \delta}) + \delta \sqrt(\frac{1- e^{-2 \theta \delta}}{2 \theta}) N_{0,1} \]</p>

<h3>3.3 Function</h3>

<h4>3.3.1</h4>

<pre><code># Brownian motion
# Example from Dixit and Pindyck, 1994, pp.74-76
# Simple mean-reverting process:% dx = nu (xbar - x) dt + sigma dz
# 
OU.sim &lt;- function(para = c(0.01, 200, 1), x0= 1, periods=100){
        periods=100; #Number of periods
nu = c(0.0, 0.01, 0.02, 0.5); # speed of reversion
sigma = ouFit.ML(wheat)[[2]]; # in monthly terms
ones = c(1,1,1,1) # all one vector
sigma2 = (((sigma^2)*(2*nu)).*(ones-exp(-2*nu))).*0.5; #dt=1;
xbar=c(1, 1, 1, 1); # Level to which x tends to revert, or normal level
x=matrix(rep(0, periods*4), periods, 4) # all zero, 100*4 matrix
epsilon=matrix(rnorm(periods*4),periods,4); # random normal number, 100*4 matrix
x[1,]=c(1,1,1,1); # Starting value of first row of x 
i=2;
while i&lt;periods+1
#    x(i, :)=x(i-1, :)+nu.*(xbar-x(i-1, :)) + sigma*epsilon(i-1, :);
    x(i, :) = x(i-1, :) + xbar.*(ones(1,4)-exp(-nu)) + x(i-1, :).* ...
       (exp(-nu)-ones(1,4)) + sigma*epsilon(i-1, :);
    i=i+1;
end;

#figure (1)
#plot(x);
#xlabel(&#39;Period&#39;);
#ylabel(&#39;Value of x&#39;);
#title(&#39;Ornstein-Uhlenbeck Stochastic Mean-Reversion Process&#39;);
#legend(&#39;0.00&#39;, &#39;0.01&#39;, &#39;0.02&#39;,&#39;0.50&#39;); 



}


</code></pre>

<h3>3.1 &ldquo;yuima&rdquo; packages</h3>

<p>The simulation follows the method mentioned on &ldquo;1 4 Vasicek Model &rdquo;<a href="https://www.youtube.com/watch?v=5BpOYPNxWsA&amp;index=4&amp;list=PLRj8HuwfWZEsXW2pzAwAWYC8EZbD2ieOq">https://www.youtube.com/watch?v=5BpOYPNxWsA&amp;index=4&amp;list=PLRj8HuwfWZEsXW2pzAwAWYC8EZbD2ieOq</a></p>

<p>Recall &ldquo;yuima&rdquo; package uses this notation:</p>

<p>\[  dS_t = \theta(\mu - S_t)dt + \sigma dW_t \]</p>

<p>The delta of t<br/>
\[ dt=(1/n)=(1/100) \]</p>

<p>by default. We can change it by using \( grid=setSampling(Terminal=1,n=1000) \). </p>

<h4>3.1.1  Generate  1000 random samples  with 1000 time periods for wheats price using the parameters from estimate</h4>

<p>One simulation, different time different result. And time period still is 1000 (&ldquo;yuimu&rdquo; default: delta = 1/100, we change it to 1/1000).</p>

<pre><code class="r">require(yuima)
</code></pre>

<pre><code>## Loading required package: yuima
## Loading required package: zoo
## 
## Attaching package: &#39;zoo&#39;
## 
## The following objects are masked from &#39;package:base&#39;:
## 
##     as.Date, as.Date.numeric
## 
## Loading required package: stats4
## Loading required package: expm
## Loading required package: Matrix
## 
## Attaching package: &#39;expm&#39;
## 
## The following object is masked from &#39;package:Matrix&#39;:
## 
##     expm
## 
## ############################################
## This is YUIMA Project package.
## Check for the latest development version at:
## http://R-Forge.R-Project.org/projects/yuima
## ############################################
## 
## Attaching package: &#39;yuima&#39;
## 
## The following object is masked from &#39;package:stats&#39;:
## 
##     simulate
</code></pre>

<pre><code class="r">grid = setSampling(Terminal = 1, n = 1000)
m1 = setModel(drift = &quot;theta*(mu-x)&quot;, diffusion = &quot;sigma&quot;, state.var = &quot;x&quot;, 
    time.var = &quot;t&quot;, solve.var = &quot;x&quot;, xinit = ouFit.ML(wheat)[[2]])
Xwheat = simulate(m1, true.param = list(mu = ouFit.ML(wheat)[[2]], sigma = ouFit.ML(wheat)[[3]], 
    theta = ouFit.ML(wheat)[[1]]), sampling = grid)
plot(Xwheat)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-11"/> </p>

<p>Increasing the number of simulation to 1000, and time period still is 100 (&ldquo;yuimu&rdquo; default: delta = 1/100). Plot the mean of the 1000 silumtion result, different time , very similar result.</p>

<pre><code class="r">simnum = 1000
dist = c(0.31, 0.52, 0.6, 0.7, 0.95)
newsim = function(i) {
    simulate(m1, true.param = list(mu = ouFit.ML(wheat)[[2]], sigma = ouFit.ML(wheat)[[3]], 
        theta = ouFit.ML(wheat)[[1]]))@data@original.data
}
# newsim(1) simulation 1000 times, each time there are 100 time periods
sim = sapply(1:simnum, function(x) newsim(x))
# transfor to time seires format.
m2 = t(sim)
mwheat &lt;- apply(m2, 2, mean)

# plot the mean of the 1000 time simulation for the 100 time periods
plot(mwheat, type = &quot;l&quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAflBMVEX9/v0AAAAAADkAAGUAOTkAOWUAOY8AZrU5AAA5ADk5AGU5OWU5OY85ZrU5j9plAABlADllAGVlOQBlOY9lZmVltf2POQCPOTmPOWWPZgCPtY+P29qP2/21ZgC1/rW1/v3ajzna24/a/rXa/tra/v39tWX924/9/rX9/tr9/v3LqWF6AAAAKnRSTlP//////////////////////////////////////////////////////wAyqPBcAAAACXBIWXMAAAsSAAALEgHS3X78AAARD0lEQVR4nO2dD3/bthFAy3SL0y6z225OttVetS1WzO//BSfqL0WCJEAcgAPvvV8bSzJ9hPgEAgQg3g8tmOSH0gWAMiDeKIg3CuKNgnijIN4oiDcK4o2CeKMg3iiINwrijYJ4oyDeKIg3CuKNgnijIN4oiDcK4o2CeKMg3iiINwrijYJ4oyDeKIg3CuKNgnijIN4oiDcK4o2CeKMg3iiINwrijYJ4oyDeKIg3CuKNgnijIN4oiDcK4o2yLH7/qfnw0rbff/0jQ3EgF4vi3788H/5/RPzGWBR/Ev76gPht4VXjD+z+9DPit8RyG//96bH7sfsR8VuCXr1REG8Ub/F07rYFNd4oiDeK18hdB536beF7Hd++ffyWvDCQD8+ROzp3W4MabxSfkbthG99ADcSKn2YhNBQF8UaJFd916rqzvaOJR7xmBMQfO/T7v4aGhqIIiN9//ua8nEO8ZqLFP334/R9djf88OtcjXjPxnbv3L81D++YYskW8ZujVGwXxRokWP72uHvGaiRU/s64e8ZqRGMCZWFePeM1I1PjWva5+tXg+MRmIbuOn19UjXjMKe/VLM4YgAeKNgnijaBRPI58BfeIbenc5QLxRtIvnM5AI5eLp6KVCnfimRXwOdIung58MTeKbyz+IT48q8VfpzTUC4hOhSvy1hiM+ObrEXzpzt38RnwhF4nsnecQnR5v4/kPEJ0Sx+GbwIkiCeKNoF4/5ROgU32veEZ8GveKb8asghx7xzeAJ4pOCeKMUF9+MHpyfID4pasU3rpdBjNLiJwwjPjWIN0p58e7GvEF8WtSKD4oCwRQWPzkoj/jEIN4oGsQfG/SprRGfBhXiO/WIz0sx8b6z7YhPQznxngurEJ+GaPHTWaiWavxMw+4dBdYSK34mJw3iNRMrfiYL1WIb7/WNSMSnoWCND+v3gyzRbfw4C5VfaF+hiE9DqV69v0/MJwHxRpESH9q5WymeT4EUldV4xEtRl3jukCFGqZE7xBem1HX8WvGYF6LUyN0q8b6DPrBMVTUe8XIkGLnzylC+WjzmZaipV98E/iXMUJ94zIsg0blbkT8+QB7ikyAgfk3++DXim+ELEIGA+DX54xFfmmjx6/LHI7408Z27VfnjY8RjXoJCvfoV4kedPIghv/jQURjEJ0Fidi4sfzziVSAxVh+UP75JJZ6PQxAys3MB+eMTiV+YGoAhQrNz/vnjg8U7huhv/fvepwLxQQjMzgXlj2/CJ1fnxLe9iUDMh5C7Vy8tfml/MEFm8WfpQY6mxTeO7cAPxBulFvHOkzri15NX/MVhEvGYD6FK8Y6z/8QOYQrEGyWr+ObyA/HFqUS8szVHfAQViO8GZl3iJ+ODBznF3zrjoYaGMzCIj6YO8c7YiI+hWvGuaVjE+5NR/G1qJV6QOwTi/alVfNDLMKaE+HR+EO9NPvHN5G/kYP2VN9sS37bL38yHI5mnZb12Gg3il0G8UYqITw3il0G8URBvFMQbBfFGQbxRNike88sg3iiINwrijYJ4oyDeKIg3CuKNEi1+/6l52K1IMZoUxC8SK/7960u7ewi+l21iEL9IrPjuNme7xxVpxJOC+EWo8UaRaOMfaePrg169URBvFCnxdO4qY5s1HvOLIN4o8eJfj19aeg4OnRTELxEt/vWgfPfcvj6Ehk4K4peQGLnrRm90de4Qv4jEyF379hCcRjwxiF8i+lR/Siz71iUkuoT0SSOeGMQvQa/eKIg3ioz4/TgVEeJ1E92rfzo36J7JiDKB+CUEOncH5dT46hA41X9/+vgfxNeGSBu//+RYh4F41dCrNwrijSKx5i4sjXgeML9A9Fh9aBrxTCB+AZHZuZA04plA/AISNb4NSSOeCcQvIDCAE5RGPBeIX2CjvXrEL4F4oyDeKIg3CuKNgnijIN4oiDcK4o2CeKMg3ihbFY/5BRBvFMQbBfFGQbxREG8UxBsF8UZBvFE2K74teisW/WxXPOpn8RJ/+raE4zsTMaEzUL4EevEQf73pxfiOZjGhM1C+BHoJqPHCoTNQvgR62XIbr6IIWvETv5u4v1FM6BwoKIJW/E71v7y8PRxzDgmGzoGCImjFt40//ScZOgcKiqAVL/HvX18O/znvabY+dA4UFEErfm38wflb0zyKhs6BgiJohV69URBvFD/x71+aj//95WV+28DQWdBQBp34de6+PO4/f3MkoYgJnQUNZdCJ7+WcO+1M293n7vlwPnCN42s46KMyaCiUCgJq/M5V47u7XnWJqHRlk76C+Cm82/iJybnDaeCYj0jbfe7OIH6K6F79obq/PR4TUQWGzsKwDKzNuBB/OXfKNOkYx9dwjEfiVZRKA37i3yqdnUP8JL6zc/Kh89AMn6oolQKkVuAo7dwNCtEoKZUCPBdiBM7P+ITOQ2nxKg6Ci5DFlhW28YifQqpXryx//JXi4lUcBQd+bfzT9Kornfnjr4zE5y2W3s6kZ40/XM99cPbsleaPv9KMnmQWr+MwjPE/1b9/cbXxSvPHX0H8BJ7iu/XV7p69zvzxN5rh49ziu9O9loPRI7qNXx06EwrEn3arzL1/Gx+61lKN+Oshb3r/5tr51JPiBFzOOfINXVCXTfpGc2tm739k2fnkk+J4it9/mqjxSvPHD7ir64jv8Gzjp5fb6cwfPwDxIwSmZTXmjx9w16srJV7TARGaltWXP35If8gO8R1S07LhobNSRvxoMYAitj4teya7eNeQgaYD4it+uo1Xmj9+wN3QaY6CNY75IE0HJLqN15o/fkiD+Hti23it+eOHZBfvmJ9RdkBmWWzjteaPH+ISn7KAjWMNhrIDMstlAGe6jVeaP35EM36YW7yqIxIwVi8cOjOjWbq0q6IcTbyuI2JGfJ/04t2hNR0RxCfcg9+rZTAp/nIiTldCxOsE8YhPtwPfV8uA+GQ78H01JIIcNsWfx3Nyiw/ZIeKTgHjEJ4of8rJz08SHz6h453y5dHjvl52bIj4JTe/fZOF9X3ZuifiEIH4KxIsGRrwSUhVxKm6I+MTHD/FZ43rvEPFJQfwUiJeNi3gdqBaf9gDaFp+qjAnES5cU8VnDIl4JWsWPR5QRLwriJ0C8bNgg8f2txedsEJ817Hrx0kVFfN6wnjtEfGLSlHEmKuKVkKSQUuJ7WyNeGMS7Qbxw0JXi5YfuEZ83aJj4/k/Ei6JTfDN8gHhpEO8G8cJB14sXLqp18UlKKSe+38vTKF77TYxnyCzeb38ViK/jtuUzVCF+PFkXTXSNr+K25TMoF99zrkx8FbctnwHxTvzaeP23LZ8mQSlnQ4aKvzXvCsWvCq0F+WIivgoUim+GzxKc76XEa7+J8TQViL9d08lN0lHj1Ytvb3nzmt6zSBBfm3ihEseL150/3gPxcs4H9NjdcJOL+Mb961VEi1eeP94D/eIHL6sQrz1/vAfS5VyIt158QITofSyK154/3gN14pe2UCFeff74ZaoTL1JievXS5Yyvr4jPQ0Hx7hNjReIrnpZtMw+Cu8fhgyJMbBD2NqJ79bUvxGgR72L7CzFa4YIGWXPOu6ztBGQWX/tCjDa3+P4WsuKD3odIG1/zQox2K+JHE3dRA4gWevWiBQ0al3PPuSA+F4gfsyy+jvzxsxQWHyZscpNm+HJa8bXkj59DsKA+oWbEuy/v/HYzFL/Q14u+jq8kf/wsciX1itQMHvTEj6qt/25G4ucjSdT4toL88bOIldQv0KT45jiIu24/o5NFYvHV5I+fI7P462YO8atr/OhvU4tfHVoRqsSv3A/iVyBV0lBxgw8A4nOjRLx/MRAvg1BJA8LcaxIT3/8F4pfZkPjryo6lC0PEtyXE3199BYsfb9oMHyLeg9Li/a/jJnflEj8bEfEdMkVVIv4WDfFLiBQ1KAjiVZBf/KANXtK0uC/Er6K4eM8x+ul9IX4V5cWvaCkmnyPeGw3io/Y1+gwt9hoQ31FAfNydLRAvg0RRQ2NkED9XJsR3VCd+uLcF8eFf0DMiXqKsJcWPPwZ34hvHVQPijxQQH7fP+SuC+9skOXeE+COIH4D4nCFW721K/MyyXcQfqVv8eByvcT2cDjAG8fkirN/dnHivAGMQny/C+v0FX6wtb4H4fBHW7w/xq6lavGPXiPdka+KD/t4F4nMFiNgh4tdTn/jeHhEfQWxhC4pft2vEn0D8PYj326LAez2Pw6+9WTTiTywWdv6raOXEx/35JIi//V6j+PX7RfwJD/Ez2xR5q/NF8vnrGRDf//XkRqXER+w3WvwG7nPX4Rr2vPabFtM/GRS/hfvcdUyMdx8XMiwPlRgUv4n73LUzEx13V0vrFjUkIi7dqESNb2u/z13rO7OpSrzsyvwBNu5z11YqPuEfG+7VIz5RaF3EiK/qjV6QEl97525cWmfx/V/UDjX+zLC0S5U7diFEaRB/BvF3WMgffyJQfOP+DNRDtPj688efWC++rvd5QWTkru788SeCxV8f1/U+L0SP3NWfP/5EmPimtS5+A/njTzSzT4cvI359aGWEi1+apNcN4s8g/g4T+eOP+Im/l93Mbamc6F79BvLHH0H8HSbyxx+5H4+ZLPv96X12U90InOqrzx9/pCe+mVnbMqjkcatgSiLSxleeP/7E3diMr/jIu9UVhF79Bb8h2FGzXtm7vIL4CyvF10q0+I2sq/cdiEP8ma2sqw8RX9kbcyMyO7eBdfWIv8fMunrE32NmXb33ZFtT3RtzQ6/+AuL7IN6xWWVvzA3iLyC+jz3xS6Wud3T+HsRfQHwfxI83q+x9TYD4K34rqRAfG1odiO+B+PFWtb0vN4i/4ie+3qUX9yD+CuJ7mBO/XOja3tYEiL+C+B6Id29WP4i/gvgelsRvZ5GFD4i/gfgbpsRvZsrVB8T3QPwVa+LrK/NaEN9nI6NyPiC+D+IvGBNfZZnXgfg7aizzOhBvFMQbBfFGQbxREG8UxBsF8UZBvFEQbxTEGwXxRkG8URBvlJTiQTPpxPc/AzJhlAdTW7AVwRBfKFbpYIgvFKt0MMQXilU6GOILxSodDPGFYpUOhvhCsUoHExIPtYF4oyDeKIg3CuKNgnijIN4oiDcK4o2CeKNIiP/+1Hz8JhDnmMe2eZYLeEyWKBLs/cspwa5IwQ7vskviJxFs//MtUFg8AfHd4d09xMc5FP2Xl3b/04tYwF3zLFS61+f27eM3mVjdu9zJBHvrPkHnQIHxBMR3WWf34wSkK3jryv36LBVw/5ffnmVKd06sK1Ow/edvXSSBYK8f/nUIcA4UGE9A/PGNHD7FMhwiCQV8//r7oRKIBNt//md3qpcp2LnGyxTsYPocKDCegPjDOVBOfJexXCjg7rE7+4kE2386foKECnZqjGUKdhB/DhQYT1mNP2Ywlgl4iPIuV+PXVKqpYD+9tG8//lF/jZdr4481Syrg7ri4/FGmjf/b8aDKFOxcNUWC7Uu28d3ZWaZXf/IuF7Cr8TLBXp9PZxCJWOcaLxKsM30OFBhP1XX8qZI+K7yOPwSRuvTuLsLEBgWKXsdDjSDeKIg3CuKNgnijIN4oiDcK4o2CeKMg3iiINwrijYJ4oyDeKIg3CuKNgnijIN4oiDcK4o1iWfz9YuTjykw7IP4C4s1wEN99Ke78xew///Z8XkX9KvU9Ac1YF//p9FW9g+u3wwfgpPz7r//+VeSLQZqxLv7n69ePDqf67qtn3cNd81i6bMlB/OVH98X8p+b4JZfuS05bB/H9Gn8+w7/+ffNNPOJPXzG9tfFv3S0L/vd181Ue8edvnF569R9eLrdT2DaWxZsG8UZBvFEQbxTEGwXxRkG8URBvFMQbBfFGQbxREG8UxBsF8UZBvFEQbxTEGwXxRvk/p3dqVqHDazUAAAAASUVORK5CYII=" alt="plot of chunk unnamed-chunk-12"/> </p>

<pre><code class="r">
# find out the quantile to decribe the distribution
tile = sapply(1:100, function(x) quantile(m2[, x], dist))
tile
</code></pre>

<pre><code>##      [,1]  [,2]  [,3]  [,4]  [,5]  [,6]  [,7]  [,8]  [,9] [,10] [,11]
## 31% 249.9 248.9 248.4 247.9 247.9 247.6 247.4 247.1 246.9 247.0 246.8
## 52% 249.9 250.1 250.1 250.0 250.2 250.4 250.6 250.4 250.3 250.4 250.5
## 60% 249.9 250.5 250.9 251.0 251.2 251.5 251.7 251.8 251.8 251.9 251.9
## 70% 249.9 251.1 251.7 251.9 252.5 252.7 253.1 253.2 253.6 253.6 253.6
## 95% 249.9 253.5 255.3 256.5 257.2 258.0 258.6 259.1 259.9 260.4 260.6
##     [,12] [,13] [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22]
## 31% 246.9 246.7 246.4 246.4 245.9 245.8 245.6 245.6 245.4 245.1 245.2
## 52% 250.4 250.4 250.6 250.6 250.5 250.5 250.6 250.7 250.7 250.4 250.6
## 60% 251.9 251.7 252.1 252.0 252.1 252.1 252.4 252.6 252.4 252.2 252.5
## 70% 253.7 253.6 254.1 254.2 253.9 254.1 254.5 254.8 255.0 255.0 254.9
## 95% 261.6 262.1 262.5 262.8 263.1 263.4 264.2 264.4 264.7 264.7 265.0
##     [,23] [,24] [,25] [,26] [,27] [,28] [,29] [,30] [,31] [,32] [,33]
## 31% 244.9 244.7 244.8 244.9 244.4 244.4 244.5 244.2 244.0 243.6 243.5
## 52% 250.4 250.3 250.5 250.1 250.3 250.3 250.2 250.1 250.4 250.3 250.6
## 60% 252.3 252.3 252.4 252.4 252.4 252.3 252.7 252.4 252.7 252.8 252.9
## 70% 255.3 255.4 255.5 255.7 255.6 255.7 256.1 255.8 255.7 255.8 255.7
## 95% 265.4 266.2 266.9 266.8 267.0 267.5 268.1 268.4 268.5 269.3 269.3
##     [,34] [,35] [,36] [,37] [,38] [,39] [,40] [,41] [,42] [,43] [,44]
## 31% 243.2 243.3 243.2 242.9 242.9 242.7 243.1 242.9 242.5 242.3 242.1
## 52% 250.6 250.8 250.7 250.7 250.5 250.5 250.2 250.2 250.4 249.7 250.5
## 60% 252.9 252.9 252.9 253.0 252.9 253.2 253.0 252.9 252.9 253.0 252.9
## 70% 256.1 256.1 256.3 256.4 256.5 256.8 256.9 256.9 256.7 256.2 256.7
## 95% 269.1 269.7 270.2 270.3 270.4 269.7 269.6 270.9 271.6 272.3 272.1
##     [,45] [,46] [,47] [,48] [,49] [,50] [,51] [,52] [,53] [,54] [,55]
## 31% 241.7 241.9 242.1 241.9 242.3 241.9 242.0 242.2 241.8 241.8 241.5
## 52% 250.0 250.4 250.5 250.0 250.2 250.2 249.9 250.0 250.0 250.3 250.3
## 60% 253.4 253.2 253.0 253.1 253.4 253.7 253.3 252.9 252.9 253.0 253.1
## 70% 257.0 256.7 257.2 257.2 257.2 257.3 257.7 257.5 257.1 256.8 257.5
## 95% 272.0 272.5 272.8 272.9 273.1 273.6 273.9 273.0 272.6 273.5 273.6
##     [,56] [,57] [,58] [,59] [,60] [,61] [,62] [,63] [,64] [,65] [,66]
## 31% 241.4 241.2 241.3 240.8 240.9 240.7 241.1 241.3 241.4 240.9 241.4
## 52% 250.9 250.9 250.6 250.9 251.1 250.5 250.9 250.9 250.9 251.0 250.7
## 60% 253.6 253.8 254.0 254.2 253.8 254.2 253.9 254.1 254.1 254.0 254.2
## 70% 257.2 257.4 257.6 257.2 258.1 258.3 258.7 259.2 258.8 259.0 258.7
## 95% 274.5 273.9 275.4 276.2 275.7 275.8 275.9 276.6 277.0 277.1 276.5
##     [,67] [,68] [,69] [,70] [,71] [,72] [,73] [,74] [,75] [,76] [,77]
## 31% 241.3 241.3 241.2 241.2 241.0 241.0 240.8 240.8 240.5 240.4 240.5
## 52% 250.6 250.9 250.3 250.3 250.0 250.3 250.6 250.6 250.3 250.3 250.0
## 60% 254.3 254.1 253.9 253.8 253.7 254.2 253.9 254.0 253.8 253.8 253.7
## 70% 258.8 258.8 258.7 258.0 258.1 257.9 258.1 258.2 258.5 258.1 258.2
## 95% 276.9 277.1 276.7 276.2 277.8 277.7 277.7 278.3 278.7 278.8 278.5
##     [,78] [,79] [,80] [,81] [,82] [,83] [,84] [,85] [,86] [,87] [,88]
## 31% 240.4 240.8 240.9 240.4 240.7 240.2 240.3 239.9 239.6 239.3 239.4
## 52% 250.1 250.2 250.3 250.4 250.0 250.0 250.1 250.0 249.4 249.8 250.0
## 60% 254.0 253.6 253.4 253.6 253.9 254.1 254.2 253.7 253.9 253.8 253.8
## 70% 258.7 258.9 259.2 258.7 258.4 258.7 258.8 258.9 259.2 259.0 258.7
## 95% 279.7 280.2 280.3 280.2 280.5 281.6 282.0 281.9 281.6 281.9 282.4
##     [,89] [,90] [,91] [,92] [,93] [,94] [,95] [,96] [,97] [,98] [,99]
## 31% 239.7 239.9 239.7 239.8 240.1 239.9 239.3 239.1 239.1 239.2 239.3
## 52% 249.6 249.9 249.9 249.8 249.9 249.8 250.3 250.4 250.3 250.3 250.2
## 60% 253.3 253.0 253.7 253.4 254.1 253.8 253.8 254.2 254.0 253.9 254.3
## 70% 259.1 259.4 259.2 259.1 259.4 259.4 259.4 259.5 259.5 259.7 259.6
## 95% 282.2 282.0 282.3 282.7 282.5 282.4 282.7 282.5 282.0 283.0 282.4
##     [,100]
## 31%  239.3
## 52%  249.9
## 60%  254.1
## 70%  260.1
## 95%  282.0
</code></pre>

<h4>3.1.2  Generate  1000 random samples  with 100 time periods for oats price using the parameters from estimate</h4>

<p>One simulation, different time different result. And time period still is 100 (&ldquo;yuimu&rdquo; default: delta = 1/100).</p>

<pre><code class="r">require(yuima)
# initial value is 188
m1 = setModel(drift = &quot;theta*(mu-x)&quot;, diffusion = &quot;sigma&quot;, state.var = &quot;x&quot;, 
    time.var = &quot;t&quot;, solve.var = &quot;x&quot;, xinit = ouFit.ML(oats)[[2]])
Xoats = simulate(m1, true.param = list(mu = ouFit.ML(oats)[[2]], sigma = ouFit.ML(oats)[[3]], 
    theta = ouFit.ML(oats)[[1]]))
plot(Xoats)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-13"/> </p>

<p>Increasing the number of simulation to 1000, and time period still is 100 (&ldquo;yuimu&rdquo; default: delta = 1/100). Plot the mean of the 1000 silumtion result, different time , very similar result.</p>

<pre><code class="r">simnum = 1000
# specific qunatile (which we can pick any another quantile)
dist = c(0.31, 0.52, 0.6, 0.7, 0.95)
newsim = function(i) {
    simulate(m1, true.param = list(mu = ouFit.ML(oats)[[2]], sigma = ouFit.ML(oats)[[3]], 
        theta = ouFit.ML(oats)[[1]]))@data@original.data
}
# newsim(1) simulation 1000 times, each time there are 100 time periods
sim = sapply(1:simnum, function(x) newsim(x))
# transfor to time seires format.
m2 = t(sim)
moats &lt;- apply(m2, 2, mean)

# plot the mean of the 1000 time simulation for the 100 time periods
plot(moats, type = &quot;l&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-14"/> </p>

<pre><code class="r">
# find out the quantile to decribe the distribution
tile = sapply(1:100, function(x) quantile(m2[, x], dist))
tile
</code></pre>

<pre><code>##      [,1]  [,2]  [,3]  [,4]  [,5]  [,6]  [,7]  [,8]  [,9] [,10] [,11]
## 31% 186.2 185.8 185.6 185.5 185.4 185.4 185.2 185.1 185.0 184.8 184.7
## 52% 186.2 186.4 186.3 186.4 186.4 186.4 186.4 186.4 186.3 186.4 186.4
## 60% 186.2 186.5 186.6 186.7 186.8 186.9 186.9 186.9 186.9 186.9 187.0
## 70% 186.2 186.8 187.0 187.2 187.3 187.5 187.5 187.5 187.5 187.6 187.7
## 95% 186.2 187.8 188.6 189.0 189.3 189.7 190.1 190.4 190.6 191.0 191.0
##     [,12] [,13] [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22]
## 31% 184.7 184.6 184.6 184.5 184.4 184.4 184.4 184.3 184.2 184.1 183.9
## 52% 186.4 186.4 186.4 186.5 186.5 186.5 186.3 186.6 186.6 186.5 186.5
## 60% 187.1 187.0 187.1 187.2 187.2 187.2 187.2 187.4 187.4 187.4 187.3
## 70% 187.8 187.9 187.9 188.0 188.2 188.2 188.4 188.3 188.4 188.4 188.4
## 95% 191.2 191.5 191.4 191.7 191.9 191.9 192.2 192.7 193.0 193.1 193.2
##     [,23] [,24] [,25] [,26] [,27] [,28] [,29] [,30] [,31] [,32] [,33]
## 31% 184.0 183.9 183.9 183.9 183.9 183.8 183.8 183.8 183.8 183.7 183.7
## 52% 186.5 186.5 186.4 186.5 186.3 186.4 186.4 186.4 186.4 186.5 186.4
## 60% 187.5 187.4 187.3 187.3 187.3 187.3 187.4 187.4 187.5 187.4 187.4
## 70% 188.4 188.4 188.6 188.6 188.7 188.8 188.6 188.7 188.7 188.9 188.9
## 95% 193.4 193.3 193.5 194.0 193.9 194.0 194.1 194.2 194.7 194.7 194.6
##     [,34] [,35] [,36] [,37] [,38] [,39] [,40] [,41] [,42] [,43] [,44]
## 31% 183.6 183.5 183.4 183.3 183.4 183.3 183.2 183.1 183.0 183.0 183.1
## 52% 186.5 186.5 186.4 186.5 186.4 186.4 186.2 186.5 186.5 186.5 186.3
## 60% 187.5 187.7 187.5 187.4 187.5 187.6 187.5 187.7 187.7 187.8 187.7
## 70% 188.8 188.9 189.0 189.2 189.1 189.1 189.1 189.3 189.4 189.5 189.3
## 95% 194.6 195.1 195.3 195.3 195.6 195.7 195.7 195.9 196.2 196.0 196.3
##     [,45] [,46] [,47] [,48] [,49] [,50] [,51] [,52] [,53] [,54] [,55]
## 31% 183.0 183.0 183.0 183.0 182.9 183.0 182.9 182.7 182.7 182.8 182.9
## 52% 186.3 186.3 186.4 186.3 186.4 186.1 186.4 186.4 186.5 186.6 186.4
## 60% 187.7 187.7 187.7 187.7 187.8 187.6 188.0 187.8 187.9 187.8 187.9
## 70% 189.5 189.5 189.5 189.6 189.5 189.4 189.6 189.8 189.8 189.8 189.8
## 95% 195.6 196.0 195.9 196.0 196.4 196.3 196.3 196.6 196.8 197.2 197.1
##     [,56] [,57] [,58] [,59] [,60] [,61] [,62] [,63] [,64] [,65] [,66]
## 31% 182.9 182.9 183.0 183.0 182.9 182.8 182.7 182.9 182.8 182.9 182.7
## 52% 186.4 186.5 186.1 186.5 186.6 186.4 186.6 186.5 186.4 186.2 186.2
## 60% 187.9 187.9 187.8 187.8 187.8 187.8 187.9 187.9 187.7 187.9 187.7
## 70% 189.7 189.7 189.9 189.9 189.9 189.8 189.8 189.9 189.8 189.9 190.0
## 95% 197.1 197.0 197.0 197.1 197.3 197.2 197.6 197.7 197.9 198.3 198.3
##     [,67] [,68] [,69] [,70] [,71] [,72] [,73] [,74] [,75] [,76] [,77]
## 31% 182.7 182.6 182.5 182.7 182.5 182.4 182.3 182.2 182.3 182.2 182.3
## 52% 186.3 186.3 186.4 186.1 186.4 186.6 186.5 186.4 186.7 186.6 186.8
## 60% 187.8 187.8 187.8 187.7 187.8 188.0 188.0 188.1 188.3 188.3 188.5
## 70% 190.0 190.0 190.1 190.2 190.1 190.3 190.1 190.1 190.2 190.4 190.1
## 95% 198.2 198.3 198.7 198.6 198.8 198.9 199.2 198.9 199.1 199.2 199.4
##     [,78] [,79] [,80] [,81] [,82] [,83] [,84] [,85] [,86] [,87] [,88]
## 31% 182.3 182.4 182.2 182.3 182.1 182.1 182.1 182.0 181.9 181.6 181.8
## 52% 186.7 186.6 186.6 186.6 186.5 186.6 186.6 186.5 186.7 186.6 186.7
## 60% 188.2 188.4 188.3 188.2 188.2 188.1 188.1 188.2 188.4 188.2 188.1
## 70% 190.2 190.3 190.5 190.4 190.4 190.3 190.6 190.7 190.5 190.5 190.5
## 95% 199.3 199.6 199.5 199.9 199.8 200.2 200.6 200.5 200.6 200.6 200.8
##     [,89] [,90] [,91] [,92] [,93] [,94] [,95] [,96] [,97] [,98] [,99]
## 31% 181.8 181.6 181.7 181.6 181.5 181.6 181.6 181.6 181.5 181.4 181.5
## 52% 186.7 187.1 186.9 186.9 186.9 186.9 186.9 186.8 186.7 186.4 186.5
## 60% 188.2 188.3 188.4 188.2 188.2 188.3 188.3 188.4 188.3 188.3 188.3
## 70% 190.5 190.5 190.4 190.4 190.6 190.6 190.4 190.2 190.3 190.4 190.7
## 95% 201.1 200.8 200.7 200.7 200.5 200.8 200.6 200.7 201.1 201.2 201.0
##     [,100]
## 31%  181.2
## 52%  186.6
## 60%  188.3
## 70%  190.4
## 95%  201.1
</code></pre>

<h4>3.1.3  Generate  1000 random samples  with 100 time periods for barley price using the parameters from estimate</h4>

<p>One simulation, different time different result. And time period still is 100 (&ldquo;yuimu&rdquo; default: delta = 1/100).</p>

<pre><code class="r">require(yuima)
# initial value is 188
m1 = setModel(drift = &quot;theta*(mu-x)&quot;, diffusion = &quot;sigma&quot;, state.var = &quot;x&quot;, 
    time.var = &quot;t&quot;, solve.var = &quot;x&quot;, xinit = ouFit.ML(barley)[[2]])
Xbarley = simulate(m1, true.param = list(mu = ouFit.ML(barley)[[2]], sigma = ouFit.ML(barley)[[3]], 
    theta = ouFit.ML(barley)[[1]]))
plot(Xbarley)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-15"/> </p>

<p>Increasing the number of simulation to 1000, and time period still is 100 (&ldquo;yuimu&rdquo; default: delta = 1/100). Plot the mean of the 1000 silumtion result, different time , very similar result.</p>

<pre><code class="r">simnum = 1000
# specific qunatile (which we can pick any another quantile)
dist = c(0.31, 0.52, 0.6, 0.7, 0.95)
newsim = function(i) {
    simulate(m1, true.param = list(mu = ouFit.ML(barley)[[2]], sigma = ouFit.ML(barley)[[3]], 
        theta = ouFit.ML(barley)[[1]]))@data@original.data
}
# newsim(1) simulation 1000 times, each time there are 100 time periods
sim = sapply(1:simnum, function(x) newsim(x))
# transfor to time seires format.
m2 = t(sim)
mbarley &lt;- apply(m2, 2, mean)

# plot the mean of the 1000 time simulation for the 100 time periods
plot(mbarley, type = &quot;l&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-16"/> </p>

<pre><code class="r">
# find out the quantile to decribe the distribution
tile = sapply(1:100, function(x) quantile(m2[, x], dist))
tile
</code></pre>

<pre><code>##      [,1]  [,2]  [,3]  [,4]  [,5]  [,6]  [,7]  [,8]  [,9] [,10] [,11]
## 31% 188.8 188.2 188.0 187.8 187.7 187.6 187.4 187.4 187.3 187.1 186.9
## 52% 188.8 188.9 188.9 188.9 188.9 189.0 189.1 189.1 189.1 189.1 189.0
## 60% 188.8 189.1 189.2 189.3 189.4 189.4 189.6 189.7 189.7 189.8 189.8
## 70% 188.8 189.4 189.7 189.8 190.0 190.2 190.3 190.5 190.6 190.8 190.7
## 95% 188.8 190.8 191.5 192.1 192.5 192.8 193.4 193.6 193.9 194.3 194.7
##     [,12] [,13] [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22]
## 31% 187.0 186.9 186.8 186.7 186.6 186.4 186.4 186.3 186.2 186.2 186.0
## 52% 188.9 189.1 189.0 189.0 188.9 189.0 189.1 189.0 189.0 189.0 188.9
## 60% 189.7 189.8 189.8 189.8 190.0 190.1 189.9 189.9 189.9 190.0 189.9
## 70% 190.9 190.9 190.9 190.9 191.2 191.2 191.3 191.4 191.5 191.4 191.4
## 95% 194.7 195.5 195.7 196.1 196.3 196.4 196.7 197.1 197.1 197.3 197.8
##     [,23] [,24] [,25] [,26] [,27] [,28] [,29] [,30] [,31] [,32] [,33]
## 31% 186.1 185.9 186.0 185.9 186.1 185.9 185.9 185.9 185.7 185.7 185.6
## 52% 188.9 189.0 188.9 189.2 189.1 189.3 189.3 189.2 189.1 188.9 189.0
## 60% 190.0 190.0 190.1 190.2 190.3 190.3 190.3 190.4 190.2 190.2 190.4
## 70% 191.5 191.5 191.6 191.6 191.7 191.8 191.7 191.8 192.0 192.2 192.2
## 95% 197.9 197.9 198.3 198.2 198.4 198.4 198.3 198.5 198.8 198.9 198.8
##     [,34] [,35] [,36] [,37] [,38] [,39] [,40] [,41] [,42] [,43] [,44]
## 31% 185.4 185.3 185.2 185.2 185.3 185.2 185.3 185.1 185.0 185.1 185.0
## 52% 189.1 189.1 189.2 189.2 189.1 189.0 189.0 189.0 189.0 189.1 189.1
## 60% 190.4 190.4 190.3 190.4 190.4 190.3 190.4 190.7 190.5 190.5 190.4
## 70% 192.3 192.3 192.3 192.3 192.5 192.2 192.4 192.6 192.8 192.6 192.7
## 95% 198.9 198.9 199.1 199.6 199.8 200.2 200.5 200.7 200.6 200.9 201.2
##     [,45] [,46] [,47] [,48] [,49] [,50] [,51] [,52] [,53] [,54] [,55]
## 31% 185.1 185.0 184.9 184.9 184.8 184.8 184.9 184.9 184.7 184.8 184.5
## 52% 188.9 189.0 189.2 189.2 189.3 189.2 189.3 189.4 189.3 189.1 189.2
## 60% 190.6 190.5 190.6 190.9 190.9 190.9 190.8 190.9 190.9 190.8 191.0
## 70% 192.6 192.6 192.8 193.0 192.8 193.0 192.9 192.9 192.9 193.0 193.1
## 95% 200.9 201.3 201.7 202.1 201.7 201.9 202.2 202.3 202.4 202.7 202.8
##     [,56] [,57] [,58] [,59] [,60] [,61] [,62] [,63] [,64] [,65] [,66]
## 31% 184.4 184.5 184.3 184.5 184.4 184.4 184.5 184.5 184.3 184.6 184.4
## 52% 189.3 189.1 189.1 188.9 189.1 189.2 188.8 189.0 189.2 189.1 189.2
## 60% 190.9 190.7 190.7 190.7 190.8 190.7 190.5 190.8 190.8 191.0 190.7
## 70% 193.2 193.3 193.4 193.3 193.2 193.4 193.3 193.3 193.3 193.4 193.5
## 95% 202.9 203.0 203.1 203.2 203.1 203.0 203.1 203.2 203.2 203.6 203.6
##     [,67] [,68] [,69] [,70] [,71] [,72] [,73] [,74] [,75] [,76] [,77]
## 31% 184.3 184.3 184.1 184.2 184.0 183.8 183.8 183.8 183.8 184.1 184.1
## 52% 189.2 189.2 189.2 189.4 189.3 189.4 189.3 189.2 189.2 189.2 189.2
## 60% 190.9 190.8 190.9 191.2 191.3 191.1 191.2 191.3 191.3 191.1 191.3
## 70% 193.7 193.4 193.4 193.3 193.9 193.7 193.6 193.6 193.7 193.6 194.0
## 95% 203.6 203.9 204.3 204.4 204.4 203.9 204.1 204.1 204.5 204.4 204.6
##     [,78] [,79] [,80] [,81] [,82] [,83] [,84] [,85] [,86] [,87] [,88]
## 31% 184.0 183.8 183.9 183.7 183.8 183.5 183.5 183.7 183.4 183.3 183.2
## 52% 189.2 189.2 189.2 189.2 189.1 189.3 189.2 188.9 189.0 189.1 188.8
## 60% 191.3 191.1 191.2 191.0 191.2 191.1 191.3 191.1 191.4 191.5 191.2
## 70% 193.8 193.7 193.8 193.8 193.9 193.5 193.8 193.8 193.9 194.1 193.9
## 95% 205.0 204.4 204.8 204.8 204.5 204.7 205.1 205.0 205.3 205.2 205.4
##     [,89] [,90] [,91] [,92] [,93] [,94] [,95] [,96] [,97] [,98] [,99]
## 31% 183.2 183.2 183.1 183.2 183.1 183.0 183.1 183.3 183.5 183.2 183.2
## 52% 188.8 188.8 188.8 188.8 188.6 188.6 188.8 188.8 188.9 188.8 188.8
## 60% 191.0 191.1 191.0 190.9 190.8 190.5 190.8 190.8 190.7 190.8 191.1
## 70% 193.8 193.7 193.7 193.4 193.4 193.6 193.4 193.6 193.6 193.5 193.6
## 95% 205.5 205.6 205.4 205.5 206.0 206.3 206.0 206.3 206.0 206.1 206.1
##     [,100]
## 31%  183.3
## 52%  188.9
## 60%  191.2
## 70%  193.8
## 95%  206.2
</code></pre>

<h4>3.1.4  Generate  1000 random samples  with 100 time periods for canola price using the parameters from estimate</h4>

<p>One simulation, different time different result. And time period still is 100 (&ldquo;yuimu&rdquo; default: delta = 1/100).</p>

<pre><code class="r">require(yuima)
# initial value is 188
m1 = setModel(drift = &quot;theta*(mu-x)&quot;, diffusion = &quot;sigma&quot;, state.var = &quot;x&quot;, 
    time.var = &quot;t&quot;, solve.var = &quot;x&quot;, xinit = ouFit.ML(canola)[[2]])
Xcanola = simulate(m1, true.param = list(mu = ouFit.ML(canola)[[2]], sigma = ouFit.ML(canola)[[3]], 
    theta = ouFit.ML(canola)[[1]]))
plot(Xcanola)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-17"/> </p>

<p>Increasing the number of simulation to 1000, and time period still is 100 (&ldquo;yuimu&rdquo; default: delta = 1/100). Plot the mean of the 1000 silumtion result, different time , very similar result.</p>

<pre><code class="r">simnum = 1000
# specific qunatile (which we can pick any another quantile)
dist = c(0.31, 0.52, 0.6, 0.7, 0.95)
newsim = function(i) {
    simulate(m1, true.param = list(mu = ouFit.ML(canola)[[2]], sigma = ouFit.ML(canola)[[3]], 
        theta = ouFit.ML(canola)[[1]]))@data@original.data
}
# newsim(1) simulation 1000 times, each time there are 100 time periods
sim = sapply(1:simnum, function(x) newsim(x))
# transfor to time seires format.
m2 = t(sim)
mcanola &lt;- apply(m2, 2, mean)

# plot the mean of the 1000 time simulation for the 100 time periods
plot(mcanola, type = &quot;l&quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAeFBMVEX9/v0AAAAAADkAAGUAOWUAOY8AZrU5AAA5ADk5AGU5OWU5OY85ZrU5j9plAABlADllAGVlOQBlOY9lZmVltf2POQCPOTmPOWWPZgCPjzmPtY+P29qP2/21ZgC1/rW1/v3ajzna/tra/v39tWX924/9/rX9/tr9/v1l3h5+AAAAKHRSTlP///////////////////////////////////////////////////8AvqouGAAAAAlwSFlzAAALEgAACxIB0t1+/AAAEhdJREFUeJztnQubm7gVhlfT7symycxmW0/SNOOOG3vM//+HNRfbXCTQ5QhJfN/77I6JLY6OeQ1IIOC3ikDyW+oESBooHhSKB4XiQaF4UCgeFIoHheJBoXhQKB4UigeF4kGheFAoHhSKB4XiQaF4UCgeFIoHheJBoXhQKB4UigeF4kGheFAoHhSKB4XiQaF4UCgeFIoHheJBoXhQKB4UigeF4kGheFAoHhSKB4XiQaF4UCgeFIoHheJBoXhQKB4UigeF4kGheFAoHhSKB4XiQaF4UCgeFIoHheJBoXhQKB6UEPGK5ExE8QHzkthQPCgUDwrFg0LxoFA8KBQPCsWDQvGgUDwoFA8KxYOSs3j+ciJC8aCUJX7pZCKxJmPxE8uXNyheioLEK4GY5Er54vlb8CJn8aMISh+U4r2geFDyFa/GEfTi2dD3oxzxSh+U4v2geFAoHhSKB4XiQclW/ORwjdJG5VFcTygelHDx++YSvJ1z6AUoPi7B4vcX5YddtX90Db3AWLwavd7+SfFehIr/+PpeVafPv5pXp9ALjI/TUbwsoeLP396q6vhYHX//5Rh6nkkbXi+ep2p9Cd7Uf7wo9fuv48Oba+h5KD4yubbqKT4yxYmfNvUp3gcp8dKNO4qPTKZr/LTTTvGylC1ePzaDWBDcj3959gw9y0S8boriAwg/gPNDd7jWIvQsFB8biSN3e/W3SctuOfQsFB8bkUO29VGcqfsAIdMdOsULIyN+GNLupplWWemadONJivchz1Y9xUeH4kEJFn96ajbrmuYdxedM8GnZ17YzJ3taduJ70qLrTVK8D1KNO9Fj9dMmvF785IA+sSbLNZ7i4xO8j68HYkjv4+fFj3cEFO9Dlq16io8PxYMi0bhrh925hjbnoum6Ubw0AuLbEdZfXENrcpmcmtGcrakoXgQB8afPv2S6cxS/IsHiXx5+fm+vqXAMrctlekCG4iMR3rg7v6rH6ijQnVPtLGr85jTWcM9P8T5k1KrvrDuLp3kfshOvpm9OQlF8OJmJn8xE8ZHITbz+TYoXh+JBKVL86F2K94DiQclHvL44xUeC4kGheFAoHpTcxdsc1qF4D8oUP3yX4j2geFAoHpRsxJtKU3wcKB6UIsRrPuu/TfEeUDwoFA9KqeKr3iAtiveA4kGheFCSilfayWkZ7YeK4kNIK95CHsXHIaX4xqlaKEzxcUgtvvIWz318EFsQT/MeJBc/+GsotBSJ4t1JKH6wrpsLK4qPQSbiZ8pSfBQoHpR04genWGbFWzYWiAvpxS813yg+ChQPCsWDkkz84PDLXFGKjwLFg0LxoGQgfkEtxUeB4kGheFAoHpQsxM+WpHh/1OhV85GBVcTPl6R4f2KKPz2px4P7w4iU8R/TkhTviYoo/vztrTo8ut+vnuJX4C5+uoRCxddPpjg8uz+hwsHV8mOpKV7LfZWJIF5kjZ9nuSjFa4kqvt7HP4fu4+eheE9ux8J1e8tUrXqKj879dDfFQ7GO+JiNO4ESiPTFTxfRJtZ4mtdB8aDEFf/x8jxX8WxWllC8H5HFf/2hduaKZ7OSg+KnqNufSOLfq72uF0/xiVlBfL3B17in+KQMxU8WkYz4YcgrS1nJQfFTIotfqtnjM+GqUBk5p3gUYos/PTWbdceTNBQfncjiz69tZ+74u9NpWYqPTmTx18ad47F6io/OuF2ndB8b4RpfKur+EkV83YXnPj5DootfrNr5M+GqQJmI139uguJLJbb4ulFXb+2nu3iKT8oK4psG/emLU2iKj426veoXjoD4ZmQ1u3OZEV38y8PP7+/O4+opPjaxxdc9efVYHd26c+KiaH5MfPGLVbvXKloXJuo+QfFIUDwoFA8KxYNC8aBQPCjY4oF/DkozZSigpWjxy/dQ2S7I4i3umrRZlHbSUEIHxZcJjHhNRIW8jwcWr+LUUwiZio/gg+IHLH9xit8kuOJVrIrKgOJBoXhQKB4UigcFVryKVlEZ5Ck+hg69eFjzuYmPtwGm+AGZiW9Pm0SRQfED8hLfWY8jQ2n/ASre4muvLT7a6AiK75GX+LgtbYrvkZX4yA4ovkdW4iND8T1QxSvtu0BQPKh5MfEH0y3NAmsXpFjxKxzO8ijSiv/48+342DxQUrh2QUoVH6V7Kya+ucOR5jY3obULQvH9oMFFWvHnb2+X/06fKF6cOIP/xfbxF+dHpYzPm/KuXZBixa8xOsG9SDmtekMfLnPxkU5aUTzFexapxXf3p868O1ekeHX7EyFuUJHi1/hMzfdPWFF8GBQ/CR9QpBN/flXaG1SH1i5JWeL7yuVTFOvHv9Y9uYOjeYo3U4j47jmiWR+5K0P8TXUZ4otY42/1Ke27eXBXraoCxM/s432fHx+BAsSrgXh9whLVhJeJ9vz4GOhXoJzMb0q83/PjY1CA+C4b1Zuu5FOUE380HrnzfX58DCjeIZ5dq/7FsDWfbeqvv8RV72/CNIyofoq9E/H5infsyNlXL0tR4k39T5l6Qst0m/q946l46+qF0R0CzVD8+AearXjz82NvOD5+LBLaY9+p2hra91fJcI1WfWD10ihNtfmLl04RUHylGcOWlfj+EbvlOYQTcCizOK4+oyN3XaUUL7iPN4+rz+nIXVtrcvGmAdP9Lrz+M7EMwsssjqvP6cidqdqVE5l/GIhevGyOYuJnxtXndOTOBMW7l1kcV6/rxl2xqH4VchOv/VgyScRWvY4ixEtmSfEtqcTrDyF6Pg/MLYPgMrezc7vq8PCmK3F6MnX1KF6bRkniL925qtnRTwucX9vO3HE6Picb8etmoio/8YJZyrXqG7sat/fGXR7H6g1QvHOZblPfnKXRdtbLWOPX7GPcj8hvQPwM5jN3+YivARJvFci2cZf/RZMLJBDfO2TTS8C87ZFKUU5827iLUv9qZCPenEmG4s1Dr+qP6q29puFH8cWLrw7Gc6/XkzenL371rwbFOxVaPh//9f30+Vfm3bmatbJR1z+3bl3B4mf28R8vDz+/12v854y7czX5iF+YVyiFwEIWw6vPr+qxOrI716+nL14VLH5mHx9a/2qsKr6zXrx4i+HVvvWvBsU7FdrEadmGdOKHu3qLmWVSCCtE8X719G55QfFpiZmNmkxSfDZEFX8PTvFQ4idHZyg+HyKmQ/Hu9a9HVPG36LdXis+FeOncHFfjHwDFZwCE+H4qQVVRvG1kk3glaMMtlaCqKN428mi19hO/XGqhgFK2VVG8UGT99lwlEC9SE8XbRs5C/L260Joo3jqyVu/q4ivj6G23mijeOvJK4mdLULyGTYhf0ErxGqKl0+/IacXf/reONfM5xbsCIt72YbUULxVYa5fi0wMgvt3oUPwQFPHcx49IIv6+55cSP1eE4nXAiLeD4sUCa6WIiFf9KW0Rl3V9rqYbFL8YR/Umoojv3cbFGIjizVilY1Eoqnh9BAvx2qMIbhUNoPjFIj0rmrmDxQ+Mzot3WuAU71ho0k2eF38rQvGpSCvedmH4iVdOdegrGkLxkxLrih+22kx7coqfwU78YimKDw29NjbpLJ/TnJageMfQa5NQvEXcSbThv/svhr6DfR3aikZQ/FKJ3j/n7lkpIl5pi3RvOd6tl+KHZZbFj4oo7aRzXFMMig/HIp9FQdP+VFzxg537vHjH5U3xwyIFiNfEovg5ti7eDYofFslU/GCdnsTyWdIUPyoyW0qzSbX6lg5dLUN0ivenQPFqOEXxXlC8wzxY4qd7cF2EZOKVtoxtDm7zLIs/Pe3OrwU8oUJAvG6Fs/uSGxRfP35svyvgfvVu4rVlU4of7IVyEP/x9f387a2AJ1SEi1ejV8ugbanNia9X9+NzVR0fXUOvTqB4/WK3FG+/LJRpWk1vnOqWhNM8Fo27fXMv+6n3ksXr1tDE4o2FrJNwmge0VS8t3mFZeIj3WtAUPy7R2qd4SzbTuKP4hk2u8cY95FW80iWfk3ivHGYiTIESf2vQZyJ+Zqb04j9ejE8my1e8YUvZFz/XV7ZbKU1z25fMW/zXH2rnFXp1Yoi3/Y4Oy8LYWzfGSyT+/dKT1z6RjuLdy1WW4n22OuYAGqzEN08knLovVrwavDsu5SXegaLED0Ne8cknIj3B+i0lxd/ZYqt+3GYfN9f1NxnIV7xfDhRvEG/s9K0mfjZ2evGnJ9MDhzMWr99SKt3LpFQe4i03DDbza7EaiFFznA7BKUa8Ghag+MqhcVfQsXqKt5gLaY03mx79k+JrLl34AvfxA3n+4qN8xdEGaKEUW/XL9AUvix/9e3XxC7Ep3p4Q8dpuQErxtruExdn1WDXu6q19AePqKV47ux4b8U2D/vTFNfT66MUr05JOJb6Lmr/45lqKArpzFK+dXY/FQIyHn9/fi7iShuK1s+uxaNydX9VjdSygOzdYoBbiDbKr4GW+RCHifUOvz2CB9pZbbuKbsMuh7fr7S3MboHjNNMUHhV6fYsTXPUxr8Z45UHyA+Ijf0GL8EsXbMi9+mu6seLvNcUwo3hZJ8ffHRCeD4m1xFd9/ayRe9WZMhl23b3ZmIxQ/nbztgFOPI6Z4S0zi2+lZ8Ur7PsX7hF4fMfGZQPGWUPxkZiObEj8QTPGzbE/8ZP9M8Tq2K77/CzCJnxbOCoq3ZWPizXnbzmuG4kcTWUHxllD8aF4z2xJ/k9xND96j+D4UP5rICoq3ZUa8NluKjxA6Ba7ip73+rKB4W3zFZ/hVaijeFoofzmtmY+IrtTnxvqlRPMXr2Jz4e1IUPwe6+O7tHL9KjaJ4S/rD5O5rM8VP2L74a8uY4gdsTXzlJT7Lb1JD8dZQ/H3WOSh+NFNeULwPVuJDlm18KN4Hip8BRrwxWYqXDp0cip+B4pNfEzsHxfuwAfEB2VF8+8ecbOqLoWeheA9sxa+TjR8U74Pq/aH4IRSfNxTvA8Wbofi8oXgftiDeO+9Q8SU9oWIMxZvZ1BMqxlC8mU09oWJM71x71kdpZkgovqAnVIyheDObekLFmL74pIkEkFC8b+gMUBXFG6D4zEkuvsTGHcWb4RqfORTvA8UbsejOPXuGzoANiPcm/ADOD7XzCp0BFG/E6lj9Xml68SUszLt4PCTE1xt8jfsCFqkqIssoyIgfhrzin9VaULyJbbfqKd7I5sUXkGQcgsWfnprNeoknaSjezKL482vbmTtOh+AUsEwp3oR1467IY/UUb4Rr/FYJ3sfXIy2L3ccXO/ImHOxWPcWboPitgjyuvqJ4I5seV19RvJFNj6uvKN7IpsfVVxRvZNPj6iuKN7L1Vn0ZScaA4kGheFAoHhR08bBQPCgUDwrFg0LxoFA8KBQPCsWDQvGgUDwoFA8KxYNC8aDEFE9yJp74/m9AJkzmwbJNzCMYxSeKlToYxSeKlToYxSeKlToYxSeKlToYxSeKlToYxSeKlTqYkHhSGhQPCsWDQvGgUDwoFA8KxYNC8aBQPCgUD4qE+I8X3V3wfKhvkb6TC9jch1ck2PlVPbxJJXb5lvUdhSSCnT7dA7nFExBfL97DY3icS+p/vlWnP97EAh4uvyKZYPtdfRdnmVj1tzzIBDvWv6AukGM8AfH1HfCaX14wxzrv/U4q4Okff+1ksutu8ieTWH3juO62kYHB9g//uQToAjnGExDffJHLr1iGSyShgOdvPy8rgUiw0+d/15t6mcS6NV4msYvpLpBjPAHx9Z3sxcSfX5+lAh6e662fSLDTU/MLEkqs3RnLJHYR3wVyjJfZGt880FQm4CXKWW6N91mpTMH+eKvvF1n+Gi+3j2/WLKmAh2Zw+bPMPv6fzUKVSaxbNUWCnVLu4+uts0yrvvUuF7Be42WC7XftFkQiVrfGiwSrTXeBHONl1Y9vV9Jdhv347hGrMokdldhBgaT9eFIiFA8KxYNC8aBQPCgUDwrFg0LxoFA8KBQPCsWDQvGgUDwoFA8KxYNC8aBQPCgUDwrFg0LxoCCLHw5GbkZm4kDxVygehov4+qK47sLsv/+160ZR76WuE8gZdPFP7aV6F9fHyw+gVf7x9b9fRS4Myhl08Z9ulx9dNvX1pWf15EE9p84tOhR/fakvzH9RzUUu9UVOW4fi+2t8t4Xf/2vzu3iKby8xve/jj/UtC/73bfOrPMV3V5xeW/UPb9fbKWwbZPHQUDwoFA8KxYNC8aBQPCgUDwrFg0LxoFA8KBQPCsWDQvGgUDwoFA8KxYNC8aBQPCj/B2xvJZjFy0KHAAAAAElFTkSuQmCC" alt="plot of chunk unnamed-chunk-18"/> </p>

<pre><code class="r">
# find out the quantile to decribe the distribution
tile = sapply(1:100, function(x) quantile(m2[, x], dist))
tile
</code></pre>

<pre><code>##      [,1]  [,2]  [,3]  [,4]  [,5]  [,6]  [,7]  [,8]  [,9] [,10] [,11]
## 31% 507.7 506.8 506.6 506.3 506.0 505.9 505.8 505.4 505.3 505.2 504.9
## 52% 507.7 507.8 507.9 507.9 508.0 508.1 508.1 508.3 508.2 508.1 508.3
## 60% 507.7 508.2 508.4 508.6 508.7 508.9 509.0 509.1 509.3 509.2 509.4
## 70% 507.7 508.7 509.1 509.4 509.7 509.9 510.1 510.4 510.6 510.8 510.7
## 95% 507.7 510.7 511.7 513.0 513.9 514.5 515.1 515.8 516.2 517.0 517.2
##     [,12] [,13] [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22]
## 31% 505.0 504.8 504.7 504.6 504.6 504.4 504.4 504.4 503.9 504.0 503.6
## 52% 508.2 508.2 508.1 508.0 508.0 508.0 508.0 508.2 508.2 508.1 508.1
## 60% 509.4 509.3 509.4 509.6 509.5 509.8 509.9 509.9 509.7 509.9 509.9
## 70% 511.0 510.9 511.3 511.5 511.5 511.8 511.8 511.9 511.9 512.0 512.0
## 95% 517.5 518.2 518.7 518.8 519.3 520.2 520.3 520.8 521.4 521.5 522.0
##     [,23] [,24] [,25] [,26] [,27] [,28] [,29] [,30] [,31] [,32] [,33]
## 31% 503.5 503.5 503.4 503.4 503.3 503.1 503.2 503.1 503.1 502.5 502.8
## 52% 508.2 508.4 508.2 508.2 508.3 508.2 508.3 508.4 508.2 508.2 508.0
## 60% 510.0 509.9 510.0 510.0 510.2 510.2 509.9 510.2 510.3 510.2 510.1
## 70% 512.2 512.4 512.4 512.3 512.7 512.5 512.4 512.7 512.8 512.6 513.1
## 95% 522.4 523.0 522.8 522.7 522.5 522.8 523.6 523.8 524.1 524.9 525.3
##     [,34] [,35] [,36] [,37] [,38] [,39] [,40] [,41] [,42] [,43] [,44]
## 31% 502.6 502.6 502.7 502.6 502.4 501.9 501.9 502.3 502.0 502.1 502.0
## 52% 508.1 508.2 508.0 507.7 508.1 508.0 507.9 508.0 508.0 507.8 508.0
## 60% 510.1 510.0 510.0 510.1 510.2 510.2 510.4 510.6 510.4 510.5 510.5
## 70% 512.9 513.0 513.2 513.1 513.3 513.5 513.6 513.9 513.6 513.6 513.6
## 95% 525.4 525.7 526.9 525.9 525.6 525.9 526.2 526.4 526.6 527.6 528.1
##     [,45] [,46] [,47] [,48] [,49] [,50] [,51] [,52] [,53] [,54] [,55]
## 31% 502.0 501.4 501.3 501.2 501.1 500.9 501.3 501.2 501.1 501.1 501.0
## 52% 508.1 508.4 508.4 508.5 508.1 507.8 507.8 507.8 507.8 507.6 507.9
## 60% 510.6 510.5 510.8 510.7 510.7 510.2 510.3 510.3 510.3 510.1 510.2
## 70% 513.3 513.8 513.7 514.1 514.2 514.1 514.2 514.1 514.3 513.8 513.9
## 95% 527.1 527.5 527.3 527.9 529.0 529.2 529.3 530.2 529.8 530.0 529.8
##     [,56] [,57] [,58] [,59] [,60] [,61] [,62] [,63] [,64] [,65] [,66]
## 31% 500.8 500.9 500.5 500.6 500.5 500.5 500.5 500.2 500.3 500.2 500.0
## 52% 507.7 507.5 507.7 507.8 507.6 507.4 507.9 507.7 507.9 507.7 508.1
## 60% 510.4 510.1 510.5 510.6 510.6 510.6 510.3 510.5 510.8 510.3 510.6
## 70% 514.1 514.0 514.4 514.5 514.3 514.2 514.3 514.2 514.5 514.3 514.6
## 95% 530.6 530.9 531.1 532.0 532.2 532.1 532.9 532.8 533.2 534.0 534.3
##     [,67] [,68] [,69] [,70] [,71] [,72] [,73] [,74] [,75] [,76] [,77]
## 31% 499.7 499.5 499.4 499.5 499.2 498.9 499.4 499.4 499.2 499.1 498.6
## 52% 507.8 508.0 508.0 508.4 508.6 508.5 508.4 508.0 508.1 507.8 507.9
## 60% 510.9 511.2 511.2 510.8 511.1 510.9 511.2 511.4 511.1 511.2 511.5
## 70% 514.6 514.8 515.2 515.2 515.3 515.5 515.3 515.5 515.3 516.2 516.1
## 95% 534.1 534.6 534.7 534.1 534.2 534.9 534.9 534.8 535.4 535.6 535.8
##     [,78] [,79] [,80] [,81] [,82] [,83] [,84] [,85] [,86] [,87] [,88]
## 31% 499.2 498.7 498.5 498.6 498.5 498.3 498.4 498.5 498.2 498.3 498.5
## 52% 507.9 508.3 508.1 508.3 508.4 507.8 507.7 508.1 508.4 508.0 507.9
## 60% 511.2 511.4 510.9 511.4 511.4 512.0 512.0 511.9 512.0 511.4 511.1
## 70% 515.5 515.3 515.4 515.4 515.8 515.6 515.7 515.9 515.8 516.0 515.7
## 95% 534.9 534.9 535.9 536.5 536.2 536.8 536.2 536.1 536.4 536.7 536.3
##     [,89] [,90] [,91] [,92] [,93] [,94] [,95] [,96] [,97] [,98] [,99]
## 31% 498.2 498.4 498.0 497.9 497.8 498.1 498.1 498.5 498.3 498.7 498.4
## 52% 507.6 507.7 508.0 508.4 508.2 508.3 508.2 508.0 508.0 508.1 508.1
## 60% 511.1 511.7 511.8 511.5 511.7 511.6 511.3 511.8 511.8 512.1 511.6
## 70% 516.2 515.6 515.7 516.0 516.2 516.2 516.2 516.7 516.6 516.7 517.0
## 95% 536.5 536.1 536.4 537.3 537.9 537.8 537.1 537.3 537.4 538.4 537.8
##     [,100]
## 31%  498.7
## 52%  508.3
## 60%  511.3
## 70%  517.2
## 95%  537.5
</code></pre>

<h4>3.1.5  Generate  1000 random samples  with 100 time periods for dry peas price using the parameters from estimate</h4>

<p>One simulation, different time different result. And time period still is 100 (&ldquo;yuimu&rdquo; default: delta = 1/100).</p>

<pre><code class="r">require(yuima)
# initial value is 188
m1 = setModel(drift = &quot;theta*(mu-x)&quot;, diffusion = &quot;sigma&quot;, state.var = &quot;x&quot;, 
    time.var = &quot;t&quot;, solve.var = &quot;x&quot;, xinit = ouFit.ML(dry.peas)[[2]])
Xdry.peas = simulate(m1, true.param = list(mu = ouFit.ML(dry.peas)[[2]], sigma = ouFit.ML(dry.peas)[[3]], 
    theta = ouFit.ML(dry.peas)[[1]]))
plot(Xdry.peas)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-19"/> </p>

<p>Increasing the number of simulation to 1000, and time period still is 100 (&ldquo;yuimu&rdquo; default: delta = 1/100). Plot the mean of the 1000 silumtion result, different time , very similar result.</p>

<pre><code class="r">simnum = 1000
# specific qunatile (which we can pick any another quantile)
dist = c(0.31, 0.52, 0.6, 0.7, 0.95)
newsim = function(i) {
    simulate(m1, true.param = list(mu = ouFit.ML(dry.peas)[[2]], sigma = ouFit.ML(dry.peas)[[3]], 
        theta = ouFit.ML(dry.peas)[[1]]))@data@original.data
}
# newsim(1) simulation 1000 times, each time there are 100 time periods
sim = sapply(1:simnum, function(x) newsim(x))
# transfor to time seires format.
m2 = t(sim)
mdry.peas &lt;- apply(m2, 2, mean)

# plot the mean of the 1000 time simulation for the 100 time periods
plot(mdry.peas, type = &quot;l&quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAgVBMVEX9/v0AAAAAADkAAGUAOTkAOWUAOY8AZrU5AAA5ADk5AGU5OWU5OY85ZrU5j9plAABlADllAGVlOQBlOY9lZmVltf2POQCPOTmPOWWPZgCPjzmPtY+P29qP2/21ZgC1/rW1/v3ajzna24/a/rXa/tra/v39tWX924/9/rX9/tr9/v1a4D1vAAAAK3RSTlP///////////////////////////////////////////////////////8AI8mn0AAAAAlwSFlzAAALEgAACxIB0t1+/AAAErxJREFUeJztnQt727YVhot0i90us5NuTnap3WhbJJv//wdOlGiJIkDyAPhw4/nep41tiTiA+AokwNv5qSMq+al0A0gZKF4pFK8UilcKxSuF4pVC8UqheKVQvFIoXikUrxSKVwrFK4XilULxSqF4pVC8UiheKRSvFIpXCsUrheKVQvFKoXilULxSKF4pFK8UilcKxSuF4pVC8UqheKVQvFIoXikUrxSKVwrFK4XilULxSqF4pVC8UiheKRSvFIpXCsUrheKVQvFKoXilULxSKF4pFK8UilcKxSuF4pVC8UqheKVQvFIoXikx4g2pmYTiI8qS1FC8UiheKRSvFIpXCsUrheKVQvFKiRX/+uV79/pozMcfvqFJUQDie/fd4a++oUlRAOIPn36ce75faFKUaPGPH37/R9/jP1nbeoqvmfjB3dtXc9ftf7Y6/DQ0vwdVkW9UT/FVQfFKQYlfH9xRfFVkPIBD8zVB8UqJF/9yupDnaT00xddEtPiXo/LdU/dytxqa4msCcay+P3ojOHJH8TURK/7t23PX7e+6vX2WhuJrJnpTfz41t//wfA05dwEvzVdEzvPxFF8RFK+U+LNzD+LQFF8R8aP6f7nm8M7QFF8RiOnci3GclKX4uoHM4/uhve3eDk3z9YARLwxN8fWQ9fJqiq8HildKtPjDvemP2omusqX4eog+Vv/16fj/A8W3BmZw93Inu66e5qsB0eOP7P70K8U3BeDs3OmY7U4yj6f4esh8tyzN10Lu26RpvhIoXinZH4xA83WQ/4kYNF8FFK8UilcKxSuF4pVC8UqheKVQvFIoXikUrxSKV0p+8TRfBRSvFIpXCsUrheKVQvFKoXilULxSKF4p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" alt="plot of chunk unnamed-chunk-20"/> </p>

<pre><code class="r">
# find out the quantile to decribe the distribution
tile = sapply(1:100, function(x) quantile(m2[, x], dist))
tile
</code></pre>

<pre><code>##      [,1]  [,2]  [,3]  [,4]  [,5]  [,6]  [,7]  [,8]  [,9] [,10] [,11]
## 31% 279.5 278.7 278.4 278.2 278.0 277.8 277.6 277.3 277.3 277.1 277.0
## 52% 279.5 279.6 279.6 279.6 279.4 279.5 279.6 279.7 279.5 279.5 279.6
## 60% 279.5 279.9 280.0 280.0 280.0 280.1 280.2 280.4 280.4 280.4 280.4
## 70% 279.5 280.2 280.5 280.6 280.8 281.0 281.1 281.5 281.4 281.5 281.6
## 95% 279.5 281.8 282.8 283.2 283.8 284.5 284.9 285.3 285.6 286.0 286.5
##     [,12] [,13] [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22]
## 31% 276.8 276.7 276.5 276.5 276.5 276.2 276.2 276.0 276.0 275.9 275.8
## 52% 279.6 279.5 279.4 279.4 279.4 279.5 279.5 279.4 279.4 279.2 279.2
## 60% 280.5 280.4 280.5 280.4 280.3 280.6 280.5 280.7 280.6 280.5 280.5
## 70% 281.7 281.8 281.8 281.7 281.7 282.0 282.2 282.1 282.2 282.2 282.3
## 95% 286.5 287.2 287.4 287.9 288.2 288.5 288.8 288.9 289.0 289.8 289.8
##     [,23] [,24] [,25] [,26] [,27] [,28] [,29] [,30] [,31] [,32] [,33]
## 31% 275.8 275.7 275.7 275.8 275.5 275.8 275.7 275.4 275.1 274.8 274.7
## 52% 279.3 279.4 279.5 279.4 279.5 279.3 279.2 279.2 279.0 279.2 279.2
## 60% 280.7 280.8 280.9 281.0 281.0 281.0 281.0 280.9 280.8 280.7 280.7
## 70% 282.4 282.5 282.6 282.7 283.0 283.3 283.3 283.2 283.1 282.9 283.1
## 95% 290.0 290.1 291.2 291.0 291.0 291.0 291.3 291.5 292.2 292.6 292.9
##     [,34] [,35] [,36] [,37] [,38] [,39] [,40] [,41] [,42] [,43] [,44]
## 31% 274.7 274.7 274.7 274.6 274.5 274.3 274.2 274.3 274.4 274.0 274.4
## 52% 279.2 279.2 279.4 279.4 279.4 279.3 279.2 279.4 279.3 279.5 279.5
## 60% 281.0 281.1 281.0 281.1 281.2 281.0 281.1 281.4 281.4 281.2 281.6
## 70% 283.5 283.5 283.5 283.6 283.7 283.9 284.0 283.9 284.0 283.9 283.9
## 95% 292.8 293.3 293.2 293.2 293.5 293.2 294.1 294.2 294.4 294.8 294.7
##     [,45] [,46] [,47] [,48] [,49] [,50] [,51] [,52] [,53] [,54] [,55]
## 31% 274.4 274.1 274.2 274.5 274.1 274.2 274.0 274.0 273.9 273.8 273.9
## 52% 279.4 279.5 279.6 279.5 279.4 279.5 279.5 279.5 279.4 279.7 279.2
## 60% 281.3 281.5 281.5 281.6 281.3 281.5 281.6 281.6 281.6 281.6 281.6
## 70% 284.2 284.2 284.2 284.3 284.2 284.3 284.4 284.7 284.4 284.0 284.2
## 95% 294.7 294.4 294.7 294.5 294.6 295.0 295.2 295.5 295.7 296.3 296.5
##     [,56] [,57] [,58] [,59] [,60] [,61] [,62] [,63] [,64] [,65] [,66]
## 31% 273.9 273.6 273.8 273.5 273.6 273.1 273.2 273.2 273.5 273.3 273.2
## 52% 279.3 279.2 279.1 279.0 278.9 278.7 279.1 279.3 279.1 279.1 279.4
## 60% 281.5 281.3 281.3 281.4 281.4 281.6 281.4 281.3 281.3 281.4 281.2
## 70% 284.2 284.2 284.1 284.3 284.6 284.3 284.6 284.8 284.6 284.6 284.7
## 95% 296.8 296.8 297.1 297.3 297.9 297.6 298.1 297.8 298.5 298.3 298.7
##     [,67] [,68] [,69] [,70] [,71] [,72] [,73] [,74] [,75] [,76] [,77]
## 31% 273.0 273.2 273.0 273.5 273.2 273.2 272.9 273.0 273.1 272.7 272.8
## 52% 279.1 279.2 279.4 279.3 279.2 279.3 279.3 279.4 279.5 279.4 279.1
## 60% 281.6 281.4 281.7 281.8 281.8 281.8 281.6 281.7 281.7 281.7 281.8
## 70% 284.7 285.0 285.1 285.0 285.2 285.3 285.0 285.1 285.0 285.2 285.3
## 95% 298.4 298.7 298.5 298.9 298.8 298.8 299.5 299.3 299.5 299.8 299.7
##     [,78] [,79] [,80] [,81] [,82] [,83] [,84] [,85] [,86] [,87] [,88]
## 31% 272.6 272.5 272.7 272.4 272.5 272.2 272.3 272.2 271.7 271.9 271.9
## 52% 279.3 279.5 279.6 279.7 279.6 279.5 279.4 279.9 279.8 279.7 279.5
## 60% 281.7 281.9 281.9 281.8 282.2 282.3 282.6 282.6 282.3 282.3 282.4
## 70% 285.6 285.9 285.6 285.5 285.6 285.7 286.0 286.1 286.2 286.3 286.3
## 95% 299.3 299.9 299.8 300.0 300.0 300.8 300.4 300.4 300.9 301.0 300.7
##     [,89] [,90] [,91] [,92] [,93] [,94] [,95] [,96] [,97] [,98] [,99]
## 31% 271.8 272.3 272.3 272.5 272.4 272.1 272.0 272.1 272.4 272.3 272.1
## 52% 279.9 279.6 279.6 279.9 280.1 280.1 280.1 279.9 279.8 280.1 280.0
## 60% 282.4 282.3 282.5 282.6 282.7 282.7 283.0 283.1 282.8 283.1 282.9
## 70% 286.0 285.8 286.1 285.9 286.1 286.2 286.2 286.0 286.2 286.6 286.6
## 95% 301.1 301.2 301.3 301.2 301.7 301.3 302.0 301.5 302.0 302.1 303.0
##     [,100]
## 31%  272.3
## 52%  280.0
## 60%  282.9
## 70%  286.3
## 95%  302.4
</code></pre>

<h2>4  Conclusion</h2>

<p>This documents show we can use ouFit.ML function to estimate the parameter \( \theta \), \( \mu \), and \( \sigma \).
And them use the <strong>&ldquo;yuima&rdquo;</strong> package to generate the simulative price vector/matrices. </p>

</body>

</html>

