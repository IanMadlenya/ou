<!DOCTYPE html>
<!-- saved from url=(0014)about:internet -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta http-equiv="x-ua-compatible" content="IE=9" >

<title>Ornstein Uhlenbeck/Vasicek Model of Crop Prices in Alberta </title>

<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 12px;
   margin: 8px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 { 
   font-size:2.2em; 
}

h2 { 
   font-size:1.8em; 
}

h3 { 
   font-size:1.4em; 
}

h4 { 
   font-size:1.0em; 
}

h5 { 
   font-size:0.9em; 
}

h6 { 
   font-size:0.8em; 
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre {	
   margin-top: 0;
   max-width: 95%;
   border: 1px solid #ccc;
   white-space: pre-wrap;
}

pre code {
   display: block; padding: 0.5em;
}

code.r, code.cpp {
   background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * { 
      background: transparent !important; 
      color: black !important; 
      filter:none !important; 
      -ms-filter: none !important; 
   }

   body { 
      font-size:12pt; 
      max-width:100%; 
   }
       
   a, a:visited { 
      text-decoration: underline; 
   }

   hr { 
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote { 
      padding-right: 1em; 
      page-break-inside: avoid; 
   }

   tr, img { 
      page-break-inside: avoid; 
   }

   img { 
      max-width: 100% !important; 
   }

   @page :left { 
      margin: 15mm 20mm 15mm 10mm; 
   }
     
   @page :right { 
      margin: 15mm 10mm 15mm 20mm; 
   }

   p, h2, h3 { 
      orphans: 3; widows: 3; 
   }

   h2, h3 { 
      page-break-after: avoid; 
   }
}

</style>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: rgb(88, 72, 246)
   }

   pre .number {
     color: rgb(0, 0, 205);
   }

   pre .comment {
     color: rgb(76, 136, 107);
   }

   pre .keyword {
     color: rgb(0, 0, 255);
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: rgb(3, 106, 7);
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>


<!-- MathJax scripts -->
<script type="text/javascript" src="https://c328740.ssl.cf1.rackcdn.com/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



</head>

<body>
<h1>Ornstein Uhlenbeck/Vasicek Model of Crop Prices in Alberta </h1>

<h2>1 Introduction</h2>

<p>We use the historic data to estimate the parameters for Ornstein Uhlenbeck process of crop prices in Alberta. And then we use the estimated parameters for Monte Carlo simulation.</p>

<h2>2 Calibrating Ornstein Uhlenbeck Model</h2>

<h3>2.1 Method</h3>

<p>The Ornstein-Uhlenbeck or Vasicek process is   a stochastic process which is stationary, Gaussian, and Markovian. </p>

<p>Over time, the process tends to drift towards its long-term mean: such a process is called mean-reverting.</p>

<p>The Ornstein-Uhlenbeck or Vasicek process is the unique solution to the following stochastic differential equation:(Stochastic Differential Equation, 2008, p44.)</p>

<p>Ornstein-Uhlenbeck model
\[ dX_t =  - \theta_2 X_t dt +\theta_3dW_t,     \]</p>

<p>Vasicek modified it to </p>

<p>\[ dX_t = (\theta_1 - \theta_2X_t)dt +\theta_3dW_t,    X_0 = x_0 \]</p>

<p>\( (\theta_1 - \theta_2X_t)dt \) is <strong>deterministic part</strong>; \( \theta_3dW_t \) is <strong>stochastic part</strong>.</p>

<p>\( dW_t \) is the Brownian motion, which follows random normal distributioin \( N(0,t) \).</p>

<p>\( (\theta_1 - \theta_2X_t) \) is <strong>drift</strong>; \( \theta_3 \) is <strong>diffusion</strong>.</p>

<p>In finance, the model more often is written as:</p>

<p>\[  dS_t = \theta(\mu - S_t)dt + \sigma dW_t \]</p>

<p>where  \( \sigma \) is interpreted as the  instantaneous volatility ,   \( \sigma^2/(2\theta) \) is the long term variance;  \( \mu \) is the long-run equilibrium value of the process, and \( \theta \) is the speed of reversion.</p>

<p>\( \theta \) increases the speed at which the system stabilizes around the long term mean \( \mu \).</p>

<p>\( \sigma \) increases the amount of  randomness entering the system.</p>

<p>&ldquo;The Ornstein-Uhlenbeck process is one of several approaches used to model (with modifications) interest rates, currency exchange rates, and commodity prices stochastically. The parameter \( \mu \) represents the equilibrium or mean value supported by fundamentals; \( \sigma \) the degree of volatility around it caused by shocks, and \( \theta \) the rate by which these shocks dissipate and the variable reverts towards the mean.&rdquo;(Wikipedia)</p>

<p>For \( \theta_2>0 \),  \( X_t~ \) are assumed iid \[ N(\frac{\theta_1}{\theta_2},\frac{\theta_3^{2}}{2\theta_2}) \].</p>

<p>\[ \frac{\theta_1}{\theta_2} = \mu   ~~\mbox{and}~~ \theta_2 = \theta ~~\mbox{and}~~ \theta_3 = \sigma \].</p>

<p>For any \( t>=0 \), the density of the distribution of \( X_t \) given \( X_0 = x_0 \), with mean and variance respectively:</p>

<p>\[ m(t,x) = E_\theta(X_t ~|~ X_0 = x_0) = \frac{\theta_1}{\theta_2} + (x_0-\frac{\theta_1}{\theta_2})e^{-\theta_2t} \]</p>

<p>and</p>

<p>\[ v(t,x) = Var_\theta(X_t ~|~ X_0 = x_0) =\frac{\theta_3^2 (1- e^{-2 \theta_2 t} )}{2 \theta_2}   \]</p>

<h3>2.1.0 Data processing</h3>

<p>We got monthly price data of crops in Alberta from <strong>Statistics Canada</strong><a href="http://www5.statcan.gc.ca/subject-sujet/result-resultat?pid=920&amp;id=2024&amp;lang=eng&amp;type=ARRAY&amp;sortType=3&amp;pageNum=0">http://www5.statcan.gc.ca/subject-sujet/result-resultat?pid=920&amp;id=2024&amp;lang=eng&amp;type=ARRAY&amp;sortType=3&amp;pageNum=0</a>.</p>

<pre><code class="r">setwd(&quot;E:/Dropbox/book/economics/485/projects/pricemodel/oumodel&quot;)

crop.price &lt;- read.csv(&quot;abcropprice.csv&quot;, header = T, sep = &quot;,&quot;)
# set the date format
crop.price[, 1] &lt;- as.Date(crop.price[, 1], format = &quot;%d/%m/%Y&quot;)

head(crop.price)
</code></pre>

<pre><code>##         Date Wheat.excluding.durum  Oats Barley Canola Dry.peas
## 1 1985-01-01                 166.0 114.6  127.4  342.0       NA
## 2 1985-02-01                 167.2 116.2  127.4  347.3       NA
## 3 1985-03-01                 166.9 118.4  130.3  350.0       NA
## 4 1985-04-01                 164.8 115.7  127.4  363.8       NA
## 5 1985-05-01                 166.8 105.7  125.6  354.6       NA
## 6 1985-06-01                 166.6 102.2  121.4  349.6       NA
</code></pre>

<p>For the Ornstein Uhlenbeck Model, long term data has more breaks or jumps, so we only use the short term data which is from stable period and capture the current characteristics of the stochastic process. We decide to use the data after 2007.</p>

<pre><code class="r">price &lt;- crop.price[crop.price$Date &gt; &quot;2006-12-01&quot;, ]
head(price)
</code></pre>

<pre><code>##           Date Wheat.excluding.durum  Oats Barley Canola Dry.peas
## 265 2007-01-01                 169.9 149.0  134.5  339.1      181
## 266 2007-02-01                 170.7 152.6  142.7  350.1      189
## 267 2007-03-01                 174.5 163.4  144.8  353.0      205
## 268 2007-04-01                 167.2 165.3  147.2  354.0      230
## 269 2007-05-01                 165.2 165.3  154.4  362.6      239
## 270 2007-06-01                 167.4 167.4  160.8  370.8      249
</code></pre>

<h3>2.2  Calibration using Maximum Likelihood estimates</h3>

<p>There are many ways to calculate the parameters. We tried two ways. First, we use package &ldquo;sde.sim&rdquo; (Stochastic Differential Equation, 2008); </p>

<p>Recap
\[ \frac{\theta_1}{\theta_2} = \mu   ~~\mbox{and}~~ \theta_2 = \theta ~~\mbox{and}~~ \theta_3 = \sigma \].</p>

<h4>2.2.1 &ldquo;sde.sim&rdquo; package</h4>

<p>Get the necessary packeages and functions</p>

<pre><code class="r"># install.packages(&#39;stats4&#39;) install.packages(&#39;sde&#39;)
require(stats4)
</code></pre>

<pre><code>## Loading required package: stats4
</code></pre>

<pre><code class="r">require(sde)
</code></pre>

<pre><code>## Loading required package: sde
## Loading required package: MASS
## Loading required package: fda
## Loading required package: splines
## Loading required package: Matrix
## 
## Attaching package: &#39;fda&#39;
## 
## The following object is masked from &#39;package:graphics&#39;:
## 
##     matplot
## 
## Loading required package: zoo
## 
## Attaching package: &#39;zoo&#39;
## 
## The following objects are masked from &#39;package:base&#39;:
## 
##     as.Date, as.Date.numeric
</code></pre>

<pre><code>## 
## To check the errata corrige of the book, type vignette(&quot;sde.errata&quot;)
</code></pre>

<pre><code># Two functions from page 114


# Functions dcOU evaluates the conditional density of the process. It generates the density of the x which from cerntain distribution
dcOU&lt;- function (x, t, x0 , theta , log = FALSE ){
        Ex &lt;- theta [1] / theta [2]+( x0 - theta [1] / theta [2]) * exp (- theta [2] *t)
        Vx &lt;- theta [3]^2 *(1- exp (-2* theta [2] *t))/(2* theta [2])
        dnorm (x, mean =Ex , sd = sqrt (Vx), log = log )
}


# Function OU.lik generates the log likelihood function of X for the MLE process. 
OU.lik &lt;- function ( theta1 , theta2 , theta3 ){
        n &lt;- length (X)
        # deltat is the time interval between observations
        dt &lt;- deltat (X)-sum (dcOU (X [2: n], dt , X [1:(n -1)] , c( theta1 , theta2 , theta3 ), log = TRUE ))
}
# The function OU.lik needs as input the three parameters and assumes that sample observations of the process are available in the current R workspace in the ts object X.

</code></pre>

<h5>2.2.1.1 Calculate the parameters for wheat</h5>

<p>Mle is very sensitive for the start value. We choose theta1 =20, theta2 =0.1 , theta3 =1.
We cannot get it converg. It seems not working.
(The result value which the process converges to might not be the unique solution. )</p>

<pre><code>wheat &lt;- as.vector(price[,2]) # convert to vector 
head(wheat)
X &lt;- ts(data=wheat)
mle(OU.lik , start = list ( theta1 =20, theta2= 0.1 , theta3 =10) , method =&quot;L-BFGS-B&quot;, lower =c(-Inf ,0 ,0)) -&gt; fitwheat
summary ( fitwheat )
coef(fitwheat)[[1]]/coef(fitwheat)[[2]]
</code></pre>

<h4>2.2.2 Function &ldquo;ouFit.ML&rdquo;</h4>

<p>Second, we manually use the function from &ldquo;Calibrating the Ornstein-Uhlenbeck (Vasicek) model&rdquo;<a href="http://www.sitmo.com/article/calibrating-the-ornstein-uhlenbeck-model/">http://www.sitmo.com/article/calibrating-the-ornstein-uhlenbeck-model/</a></p>

<p>Function &ldquo;ouFit.ML&rdquo; is saved in file &ldquo;oufit.R&rdquo;.</p>

<pre><code class="r"># function for Calibration using Maximum Likelihood estimates
ouFit.ML = function(spread) {
    n = length(spread)
    delta = 1  # delta 
    Sx = sum(spread[1:n - 1])
    Sy = sum(spread[2:n])
    Sxx = sum((spread[1:n - 1])^2)
    Syy = sum((spread[2:n])^2)
    Sxy = sum((spread[1:n - 1]) * (spread[2:n]))
    mu = (Sy * Sxx - Sx * Sxy)/((n - 1) * (Sxx - Sxy) - (Sx^2 - Sx * Sy))
    theta = -log((Sxy - mu * Sx - mu * Sy + (n - 1) * mu^2)/(Sxx - 2 * mu * 
        Sx + (n - 1) * mu^2))/delta
    a = exp(-theta * delta)
    sigmah2 = (Syy - 2 * a * Sxy + a^2 * Sxx - 2 * mu * (1 - a) * (Sy - a * 
        Sx) + (n - 1) * mu^2 * (1 - a)^2)/(n - 1)
    sigma = sqrt((sigmah2) * 2 * theta/(1 - a^2))
    theta = list(theta = theta, mu = mu, sigma = sigma, sigmah2 = sigmah2)
    return(theta)
}

</code></pre>

<h5>2.2.2.1 Calculate the parameters for wheat</h5>

<pre><code class="r"># source(&#39;oufit.R&#39;) # not necessary

wheat &lt;- as.vector(price[, 2])  # convert to vector 
head(wheat)
</code></pre>

<pre><code>## [1] 169.9 170.7 174.5 167.2 165.2 167.4
</code></pre>

<pre><code class="r">plot(wheat, type = &quot;l&quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAeFBMVEX9/v0AAAAAADkAAGUAOTkAOWUAOY8AZrU5AAA5ADk5AGU5OWU5OY85ZrU5j9plAABlADllAGVlOQBlOY9lZmVltf2POQCPOTmPOWWPZgCP29qP2/21ZgC1/rW1/v3ajzna/rXa/tra/v39tWX924/9/rX9/tr9/v0Cgal9AAAAKHRSTlP///////////////////////////////////////////////////8AvqouGAAAAAlwSFlzAAALEgAACxIB0t1+/AAADrBJREFUeJztnQ17o7gRgI/d6ybd5pzNtfFeN2ncxh/8/39Ygz8CMdhImoER877PXuyLNYPk1wJJQPxbCS75beoKwDQg3imIdwrinYJ4pyDeKYh3CuKdgninIN4piHcK4p2CeKcg3imIdwrinYJ4pyDeKYh3CuKdgninIN4piHcK4p2CeKcg3imIdwrinYJ4pyDeKYh3CuKdgninIN4piHcK4p2CeKcg3imIdwrinYJ4pyDeKYh3CuKdgninIN4piHcK4p2CeKcg3imIdwrinYJ4pyDeKYh3CuKdgninIN4pKeILsIyi+IRY0AbxTkkWv7mvdxxf30JTw6Skit8tn+vH9bf3wNQwKanit09vrcfhqWFS6PFOST7Gbx85xucIo3qnIN4pEoO7am9/eYhHvGkExNcD+s0foalhUgTEbx7eW9O5gavBMCnJ4h+//Pqr6vEPEtM5PiujkT642y2Lu3ItM51jLzEapkb1BepHw5p4dvcjIXF2bvEqtHKH+PGQWKt/3VuXGNwVkXEQgcQCznohc3YO8SMidXaOHp8ZAmfnKvMrgWN88ekRNDE0qi8unoAeiHeKHfFFxzNQA/FOsSge8yNgRnzR8xx0QLxTTIrHvD6IdwrinYJ4p9gUj3l1EO8UxDsF8U4xKh7z2iDeKYh3CuKdYlU85pVBvFMQ7xTEOwXxTjErHvO6IN4piHcK4p1iVzzmVUG8UxDvFMPiMa+JZfGYVwTxTjEtHvN62BaPeTWMi8e8FtbFY14JxDvFvHjM62BfPOZVyEA85jVAvFMQ75QcxGNeAcQ7BfFOQbxTrIi/Xhjz4iDeKYh3CuKdgnin5CEe8+Ig3imIdwrinZKJeMxLg3inZCO+JqE20CYX8e1S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" alt="plot of chunk unnamed-chunk-5"/> </p>

<pre><code class="r">ouFit.ML(wheat)
</code></pre>

<pre><code>## $theta
## [1] 0.1198
## 
## $mu
## [1] 249.9
## 
## $sigma
## [1] 21.99
## 
## $sigmah2
## [1] 430.1
</code></pre>

<h5>2.2.2.2 Calculate the parameters for oats</h5>

<pre><code class="r">oats &lt;- as.vector(na.omit(price[, 3]))  # get rid of n/a and convert to vector 
head(oats)
</code></pre>

<pre><code>## [1] 149.0 152.6 163.4 165.3 165.3 167.4
</code></pre>

<pre><code class="r">plot(oats, type = &quot;l&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-6"/> </p>

<pre><code class="r">ouFit.ML(oats)
</code></pre>

<pre><code>## $theta
## [1] 0.08256
## 
## $mu
## [1] 186.2
## 
## $sigma
## [1] 9.471
## 
## $sigmah2
## [1] 82.68
</code></pre>

<h5>2.2.2.3 Calculate the parameters for barley</h5>

<pre><code class="r">barley &lt;- as.vector(na.omit(price[, 4]))  # get rid of n/a and convert to vector 
head(barley)
</code></pre>

<pre><code>## [1] 134.5 142.7 144.8 147.2 154.4 160.8
</code></pre>

<pre><code class="r">plot(barley, type = &quot;l&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-7"/> </p>

<pre><code class="r">ouFit.ML(barley)
</code></pre>

<pre><code>## $theta
## [1] 0.04971
## 
## $mu
## [1] 188.8
## 
## $sigma
## [1] 11.29
## 
## $sigmah2
## [1] 121.3
</code></pre>

<h5>2.2.2.4 Calculate the parameters for canola</h5>

<pre><code class="r">canola &lt;- as.vector(na.omit(price[, 5]))  # get rid of n/a and convert to vector 
head(canola)
</code></pre>

<pre><code>## [1] 339.1 350.1 353.0 354.0 362.6 370.8
</code></pre>

<pre><code class="r">plot(canola, type = &quot;l&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-8"/> </p>

<pre><code class="r">ouFit.ML(canola)
</code></pre>

<pre><code>## $theta
## [1] 0.04689
## 
## $mu
## [1] 507.7
## 
## $sigma
## [1] 18.46
## 
## $sigmah2
## [1] 325.5
</code></pre>

<h5>2.2.2.5 Calculate the parameters for Dry peas</h5>

<pre><code class="r">dry.peas &lt;- as.vector(na.omit(price[, 6]))  # get rid of n/a and convert to vector 
head(dry.peas)
</code></pre>

<pre><code>## [1] 181 189 205 230 239 249
</code></pre>

<pre><code class="r">plot(dry.peas, type = &quot;l&quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAeFBMVEX9/v0AAAAAADkAAGUAOTkAOWUAOY8AZrU5AAA5ADk5AGU5OWU5OY85ZrU5j9plAABlADllAGVlOQBlOY9lZmVltf2POQCPOTmPOWWPZgCP29qP2/21ZgC1/rW1/v3ajzna/rXa/tra/v39tWX924/9/rX9/tr9/v0Cgal9AAAAKHRSTlP///////////////////////////////////////////////////8AvqouGAAAAAlwSFlzAAALEgAACxIB0t1+/AAAEARJREFUeJztnYtW4zgSQEfds8D2MtDMLvTswJJd8vD//+HaCfTExA/JqtLDde/hkECiqoousiU7Dr80YJJfchcAeUC8URBvFMQbBfFGQbxREG8UxBsF8UZBvFEQbxTEGwXxRkG8URBvFMQbBfFGQbxREG8UxBsF8UZBvFEQbxTEGwXxRkG8URBvFMQbBfFGQbxREG8UxBsF8UZBvFEQbxTEGwXxRkG8URBvFMQbBfFGQbxREG8UxBsF8UZBvFEQbxTEGwXxRkG8URBvFMQbBfFGQbxREG8UxBsF8UZBvFFixDsoGUXxEW1BG8QbBfFGiRa/uznuMb6+hoaGrMSKPzw9Hm+3V2+BoSErseL3D6+9W//QkBVGvFGi9/H7e/bxNcKs3iiIN4rE5K7b2l/u4hFfNALijxP63W+hoSErAuJ3t2+95ZznaYCl8PckQrT4+y9//tGN+NtUyznEixA/uTs8uetmm2w5p7UhsUZ1s3rHkBehNvGObb0MEmfn7l7SHblDvBASx+pfWuupJndn4vkDiEHiAM72LtnZOXcWGPExSJ2dSzTiz8QzvY9C4OxcZ36TZh/vzr8jPoa6ZvWIF6Mq8b1pHeKjqFY8B3LiqEm8O7+D+DgqFo/5GCoS787vOoUEpkC8UeoR73r3ER8J4o1SjXh3+RPiI0C8USoVr5DAGIg3CuKNgnijIN4oiDcK4o1Si/jBYJhfDuKNgnijIN4oiDcK4o2CeKMg3iiINwrijYL4iol5/YjPhEDtURcTIT4T0bW7uDcaIz4PMdf6nitfHKYS8SOx6jUfId51rd3ZT0ujTIF4JSL2zwNvNI+OcgHilVgu3k3+uDTMZxCvg5MztjAO4rOwXPxFM8TXBOLjYtkT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" alt="plot of chunk unnamed-chunk-9"/> </p>

<pre><code class="r">ouFit.ML(dry.peas)
</code></pre>

<pre><code>## $theta
## [1] 0.05435
## 
## $mu
## [1] 279.5
## 
## $sigma
## [1] 14.08
## 
## $sigmah2
## [1] 187.7
</code></pre>

<h2>3 Generate the price vectors/matrices by simulation</h2>

<p>There are two packages we can use to generate Vasicek process. We try both and get different results. It may be because both use the random method to simulation.</p>

<p>We find the &ldquo;yuima&rdquo; is better than &ldquo;sde.sim&rdquo;</p>

<h3>3.1 &ldquo;yuima&rdquo; packages</h3>

<p>The simulation follows the method mentioned on &ldquo;1 4 Vasicek Model &rdquo;<a href="https://www.youtube.com/watch?v=5BpOYPNxWsA&amp;index=4&amp;list=PLRj8HuwfWZEsXW2pzAwAWYC8EZbD2ieOq">https://www.youtube.com/watch?v=5BpOYPNxWsA&amp;index=4&amp;list=PLRj8HuwfWZEsXW2pzAwAWYC8EZbD2ieOq</a></p>

<p>Recall &ldquo;yuima&rdquo; package uses this notation:</p>

<p>\[  dS_t = \theta(\mu - S_t)dt + \sigma dW_t \]</p>

<p>The delta of t<br/>
\[ dt=(1/n)=(1/100) \]</p>

<p>by default. We can change it by using \( grid=setSampling(Terminal=1,n=1000) \). </p>

<h4>3.1.1  Generate  1000 random samples  with 1000 time periods for wheats price using the parameters from estimate</h4>

<p>One simulation, different time different result. And time period still is 1000 (&ldquo;yuimu&rdquo; default: delta = 1/100, we change it to 1/1000).</p>

<pre><code class="r">require(yuima)
</code></pre>

<pre><code>## Loading required package: yuima
## Loading required package: expm
## 
## Attaching package: &#39;expm&#39;
## 
## The following object is masked from &#39;package:Matrix&#39;:
## 
##     expm
## 
## ############################################
## This is YUIMA Project package.
## Check for the latest development version at:
## http://R-Forge.R-Project.org/projects/yuima
## ############################################
## 
## Attaching package: &#39;yuima&#39;
## 
## The following object is masked from &#39;package:stats&#39;:
## 
##     simulate
</code></pre>

<pre><code class="r">grid = setSampling(Terminal = 1, n = 1000)
m1 = setModel(drift = &quot;theta*(mu-x)&quot;, diffusion = &quot;sigma&quot;, state.var = &quot;x&quot;, 
    time.var = &quot;t&quot;, solve.var = &quot;x&quot;, xinit = ouFit.ML(wheat)[[2]])
Xwheat = simulate(m1, true.param = list(mu = ouFit.ML(wheat)[[2]], sigma = ouFit.ML(wheat)[[3]], 
    theta = ouFit.ML(wheat)[[1]]), sampling = grid)
plot(Xwheat)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAclBMVEX9/v0AAAAAADkAAGUAOTkAOY8AZrU5AAA5ADk5AGU5OWU5OY85ZrU5j9plAABlADllAGVlOQBlOY9ltf2POQCPOTmPOWWPZgCPjzmPtY+P29qP2/21ZgC1/v3ajzna24/a/v39tWX924/9/rX9/tr9/v3y4mNqAAAAJnRSTlP/////////////////////////////////////////////////AKd6gbwAAAAJcEhZcwAACxIAAAsSAdLdfvwAABFNSURBVHic7Z2LeqO4GUBX6UzS6dTZ7U52224ybmJb7/+KjW0ECMRFSICk/5xvJna4/JZ1AroCv2gQyS97JwD2AfFCQbxQEC8UxAsF8UJBvFAQLxTECwXxQkG8UBAvFMQLBfFCQbxQEC8UxAsF8UJBvFAQLxTECwXxQkG8UBAvFMQLBfFCQbxQEC8UxAsF8UJBvFAQLxTECwXxQkG8UBAvFMQLBfFCQbxQEC8UxAsF8UJBvFAQLxTECwXxQkG8UBAvFMQLBfFCQbxQEC8UxAsF8UJBvFAQLxTECwXxQgkRryBlVhQfsC+sDeKFgnihIF4oiBcK4oWCeKEgXiiIFwrihYJ4oSBeKIgvH6cIxBePeyAO8cWDeKEgXhR17g/MuUB8oSjzMjDbBvGFgnihVLYH59chvlAQL5S77at05TSB+EJBvFAq8br52Vk/vjviM6U6zBEvDcQLBfFCQbxMlLbEq74NxBeJLf7WcdvfYgzE5wnihaKq8zvihXHNe6UQL46u+P5ADeKLpCPeMQ0nWPzp6Tbw97efzg+HfbiLVyuKv7z8uL1+fH13fTjsw/riz7/9tF7nh4b1UEa8vcTaZDwCR3yW9MXH77k7P1PGJ4aqxVsLuxuNQq0+cZzjL65ZdogvC9e8KufsyjWac49HTvV74Rbv3HD89w7Tlbs/XvXx8dP/dyp3e9AVrwYO+J6OGM2548Fqzs28TS7EoJvNyn0S0NHFc8TvSu/4cky5aNaM/NplVhl/oIzfi65411wbs2r01y7U6tMG8UJxiB/K9hVO9Q+v9NXvxH7ir331l5cD4vehO7VmRHxvz1Fmjs69PSJ+F9qzq24/Z7eiI43OHb98Q/wO2OKVckyuG9xzlDmjc4fry7HfnkP8+jSV+Fr8/D3HoFafNogXitJ16a5HW/HOPUdAfNrU4pW5hsJnzxEQnzaIFwrihWJK9pt4r5FwxGdNR7znniMgPm1s8b57joD4pLkX75V4vylPiM+ZugmvEC8KI14hXhZmSI4jXhi1eN9WPOLzphGvES8J5Xrx2nUIxCcN4oWyxLi96xCIT5mQHEZ8vgRdnYj4fEG8TMKuR0Z8tiBeKIgXCuKF4jnzorf3KIhPF8QLBfFCCctfxGcL4oWCeKEgXiiIFwriZRJ4y1jE5wrihRKYvYjPFcQLBfFCQbxQEC8UxAsF8UJBvExCcxfxmYJ4oSBeKIgXCuKFoEZ/DY7XBfGpgHihIF4oiJdJd74N4oWAeKF0L5RDvBBs8WHXS1YhRkF8InTEB06x1YjPBcQLJT3xp6frE4xV/9GyiI+J/aihBMRXT5PWH1/fPUODDx3x+1fuzHPjeX78uiQnniN+G5ITr8/PlPEbkJ74xaHBB0t8eNUO8bmg2vmZgvjz82FhaPDBFh8n4BgzavX/UT8WhQYfEhT/U7/ZVTtlCEwatEhS/K1q36/WIz4iSpsMVSmJXxIaPFD1j9vTRGNFHIZa/X60ZCNeErezu6rP76mJPz2ph1f66lfgXqynKv7aV395OSA+OjfBpsOu/SMN8Xfhb4+Ij42q1CcqvhqdO375hvi4JC7e9NkeacdHRt16wqrqXYLiF4eGcSrn1Y/7kqrUR3zJuMUrFWVsDvFJYs7plXiFeBmoWryuh7zMkvrwD/6Q8dWI3xrVE68RLwGHeKMa8SXTFn97QbwM6uaaGZdrxt+rJnycfEV8WiiXeLMO8eXSF2+vjPdB46sRvzHtxptuvVQrI37Q+GrEb0trniriJVGLX32OMuKT4q4c8eIw1te/KgHxSVEd64iXRiN+9U8aX434bamm0CJeGttdcIj4CMT7pojPiojio0UK/CTEzwHxPqELAvE+oQsC8T6hCyLaN90wyxAfAcT7hC4IxPuELod4jW/EZwXivUKXQ8jlq2rkt1VBfDiI9wpdDoj3Cl0OiPcKXQ7RxG+ZY4gPB/FeocsB8V6hywHxXqGLIehWk4jPFxXyVRGfL2HirWvjwhMz/4PHVyN+GiN+0fe1ygnEZ8Wg+DkZgPhsUXpQ/IwcsC6WQnxOuMWrma08xGeLS7y58/SMnRGfK5Z4ZZbNF08ZnymNeGWKdTVXfOdMgfiMaNwhfl7oQqhMKz/x/YdL2e/WB/GB1OLvNx+0xA9nQSbiz7+/f/68/Dn4UMkloQuhLV6VJl6fnh712/XxchFDF4IRr4oUr/XH0MPCF4cuBGNQ6eXilbVwGzjiA7HEK+NbeYivhacnnjJ+mPah2zwvbOJG09aTQ+vOu00zjFp9IAvFt4t3xOdI55w9Q7xCfPYoW3zle4l4pRGfCaavzl42W3xbtVK9SKsTLP70dCva+o+WlSu+fjsgXnXF6wzFV0+T1h9f3z1D585S8WabzMWb58bLe3583V7vLG1kDopvHihXb5udeLFHvHKLb3ph2s8XadYWI16fn2WW8a1GW29586Zg8YtDZ44R71p+f9P+rbWwEa8U4pNmqG7uFm+9mRDfbJuf+NPTj8uLUv0ivnzxzkEVp3hlia/+5y3+Wrl7+6zfnb6XW7lzCxYu/rMZd/nj1WrOmWenFS1+8NlwA+KbPwCrXG/vlpf46+H+cfhszj36hs6HvuDqCWGj39BTfMhF9ksIr9y93bKg7126+NauZoKGXT50xG+cXdTqp+lWzasGvL/4TvmA+MSxxd8rZ7PFV/W4+8FekvjTk3p4Lbuv3q6at8TP2bXupFPNGd+14dbZFaM5d3k5lC3erqjp2uSMXes+ufqgH/6UTYnQnPv8+fZYsHhTE18kvq7PmWsuShFfjc4dv3wTI95In/f9bPEjfy6Zidfn58P15dgfnitMfH3Cn3u0V3u39tu8l2YEavWTtMSrMPE6oUxB/CSmAW6cLxW/WgIXgfhJ4ohPLTsQP4lqnebvHn0a3YjPFpd4n71TO8nfQfwkVaWsquD5ik+vdL+D+EkQHzd0NrRaY/XlUV77J5kRiJ8E8XFDb0R4KhAfN/RGBKdCtV7qeTReAdLIiA6I9wmA+AihNyKueLVAfCIZ0QHxPgGWiU8SxPsESG2ILYCCxTfzJiKEqd4jPjz0uqhY4u3dER8eel3qsRHEuylWvEL8KIWKVxPiPcbT4yQoOYoUrxA/iUzxPlOnIqUpNYoVP1q587goGfGxQ69IdZFaNazm2mD+MY/42KFXZFy8qsXPSGGp3ksVr2uvPfEK8VdKFK8QP41U8bd/iB+kBPGqu1ZXa+dcuYr46KHXI1S8QnyO4ptrnJzi6/vQIH6MIsWrKfHW3W4KpVTxJgE9vXWf3izxRcyyclKa+PYVTqqludmgFj94P5r6kvaxW9bkToHiVfPecanbHPEa8UWKN28GuvEt8euldGcQ3wtQdeYjfqXQ62DfBb4vvvWb2zzib+Qovp0Ah/j2pv0kKsTfyEy86og3Lfb2Fs1b12yM5j7TRVftihffS0inbdePgPgbiC+VwsRbp+9A8bNuSJ8t5YlvJ8BbfN2Rf68VIn6F0CvQUeUvvhm6Q/xqoVcggnjdiC95iKZw8Qrxg0gQbzXeOzt0AhjxGvGrhV6BcPHaso34NUKvQHTxUVOXFohvL0S8IUXxw3EnxXd75zvruwU74tcIvULcnvjuHr2p1vb67pAO4tcIvTzuYOChORe2WXuP3mrEX0lWvDN4FPFCKEx8f0NrRW+vqs2uOtsLAPHuHr7iyVa8K/py8cq5tmTyEz/SjT4ifuCYbon3ff5A5ggRP3Qyr450xHeZFn96uk1e6D9TeEXxyi1+pJ03IV4jvsPcx4jrj6/vnqGXMjwdbqRWPlSIq+Z/0ROt+oSKP//203qdH3opA+IHzgLNTs4UIX6A9I54NSJ+ZC/tflCgJT5mMpMnuIw/P29bxiszA7b/aVPiXRfOaMQ7WatWvzyTVX3Q95eP7zclfnGSsgTxiHcxq3J3Pdv3i/j1xOuqw8VePtEcQ7xNBPG3Cv3pn3NDB/aO1uK7V09MlNHuWfKIH2CO+NP3d6s5Zy4/6p+L72tnfOwIqg7iKX6w6X8XL8x7uPjnh7/+vB7x36eac7b4xfnc/N34ih9aingHMyp3lxf1qD+mm3PWoHcq4k0JIKz3Rm9Zq09avLRW/PbizQhomHgTsP3LVEjEWwSLPz2ph9c5ffXGuJpjaZgh8ZNfZVB8nTpRhIq/9tVfXg5zxSvEJ0KMDhyt3x5njM4Z42H3muiIV81ixPsQ44j/5Pjl2wzx9chaQOvJLd7RlTeVnDpRdQBRBJfx5+fD9eXYb89tI145P8sjHuJdxBykiS5eI345GYvXMcXTc2cTdVi2Mq4mR9JmR0X8YrYVr2OLH5wwPz+eNOMVm4vXYeLt/ZqIC8MhfoC4M3CSFL94z7zZS/zSDEd8JDYVr9cRH1JlEMvG4qs1scXj3RvEC6UI8Zzp/dlF/IwPnrdbNcaPeH92E79Aluq1uhG/mALELy83JLOneF9diI9IquIHOgG64jXiF5KXeOflb4hfwo7iR1vf/T8LM5zfj+OdMkhYvOPOB8OXv4E3GYn3v+URDJOweNVd4q4WIH4RyVbuuuLVkHhYxH7ixzfoXV6H+LgkKl51xSvExyUz8RCLNMUrt3iIR7riNeLXZG/x7o2c4gOSAj0QL5QkxTvuNY33yKQpvr8K8ZFJVHxvf8RHJkHxzgsh8R6ZPcVr9+MDEL8F6YmvW+yIXxPECyUF8aq7rLU/M+dXIgPxjM+sQYLirbfm1veIjwzihbK/eDUsXhnx9N9EJwvxdNzFJwHxg+02xK9IauKt99UZQSM+PruL1xPix4btYTnpiO931yF+RXYVX53Bh8UrxK9FQuJb781axK9GBuJnxgIvkhZPZX499hXfLtj7zTY6alckIfG631GD+NXYWXy15a1VV/2DTUC8UFIRrxC/LYgXShLiNeI3JxHxCvEbg3ihBIs/Pd3mSvQfLYv4pAkVXz1NWn98ffcMbW1qptkgfitCxZvnxs94fvxYKphnszUpHfGI35DgMv78HKGMZ2bd5qRRq0f85iBeKHHEn771z/QLxFOp347gWv1zdXVbv5D3s4jzbYlQuftUbh3xyhCYNFiTCKf68/PX/4We6mFropTxpydHaw7xSZNIrR62BvFCiTE69/Aa2lcPmxOjr/7yckB8bsQZnXt7RHxmRBqdO37pN+gQnzIROnAO15djaM8dbAu1eqEgXiiIF8qa4iFl1hPf/TuIFypusGQTtmcwxAsNhnihwRAvNBjihQZDvNBgiBcaLKJ4yAnECwXxQkG8UBAvFMQLBfFCQbxQEC8UxAslgvjzs6pujNS8ixDsen+9H5FiNfdwihDs8nK7tChOsM9v6boe1Q9zEbtP/oeLv2bp8dF+FyHY+ddXffp7SAZbyTkG/hG1gr39cN0CbFmw67c8hh4sH9Xfjlf+h4u/XmJz/5Nr3kUI9nH9Bm8httrJOf3jX4FnD+tbBtIEO31/Dw749vDf+7f0yv9w8be0//pqvYsQ7EpYsFasyx9/BZ7q29/y36Gn+iZYlCPe2PbK/3Dx19Pe/eOadxGCaX27VjNOrOMhtIxvgp2eftyyOE7KIlSLavFe+Z/wEV9duxUnYaHiV/qW11rMR3Dtbp8jfqUy/nZkRUrY8TbPPOjPqPUtfw8W36rJhJ8kdS1+4zL+ekI2tfpDeK3ehAj2bicn9IhvBXsLPtW3vmXMI94r/6O1468fHq0d/xnsfpQG2WoSFq0dX33LUFVNsA8V3ClwF++b//TcCQXxQkG8UBAvFMQLBfFCQbxQEC8UxAsF8UJBvFAQLxTECwXxQkG8UBAvFMQLBfFCQbxQEC8UxFcEzgvPDsRXIF4mEeZM5wXiKzjihYJ4oSBeKIgXCuKFcnmhVg8CQLxQEC8UxAsF8UJBvFAQLxTECwXxQkG8UBAvFMQLBfFCQbxQEC8UxAsF8UJBvFD+D+qCTPfBM3X9AAAAAElFTkSuQmCC" alt="plot of chunk unnamed-chunk-10"/> </p>

<p>Increasing the number of simulation to 1000, and time period still is 100 (&ldquo;yuimu&rdquo; default: delta = 1/100). Plot the mean of the 1000 silumtion result, different time , very similar result.</p>

<pre><code class="r">simnum = 1000
dist = c(0.31, 0.52, 0.6, 0.7, 0.95)
newsim = function(i) {
    simulate(m1, true.param = list(mu = ouFit.ML(wheat)[[2]], sigma = ouFit.ML(wheat)[[3]], 
        theta = ouFit.ML(wheat)[[1]]))@data@original.data
}
# newsim(1) simulation 1000 times, each time there are 100 time periods
sim = sapply(1:simnum, function(x) newsim(x))
# transfor to time seires format.
m2 = t(sim)
mwheat &lt;- apply(m2, 2, mean)

# plot the mean of the 1000 time simulation for the 100 time periods
plot(mwheat, type = &quot;l&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-11"/> </p>

<pre><code class="r">
# find out the quantile to decribe the distribution
tile = sapply(1:100, function(x) quantile(m2[, x], dist))
tile
</code></pre>

<pre><code>##      [,1]  [,2]  [,3]  [,4]  [,5]  [,6]  [,7]  [,8]  [,9] [,10] [,11]
## 31% 249.9 248.8 248.3 248.0 247.6 247.4 247.5 247.2 246.9 246.7 246.6
## 52% 249.9 250.0 250.0 250.0 250.1 250.1 250.3 249.9 250.1 250.6 250.2
## 60% 249.9 250.6 250.7 250.7 250.8 251.1 251.3 251.3 251.3 251.8 251.6
## 70% 249.9 251.2 251.5 251.7 251.9 252.3 252.5 252.6 253.1 253.4 253.3
## 95% 249.9 253.4 254.9 256.1 257.2 257.8 258.7 260.0 260.4 260.7 261.4
##     [,12] [,13] [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22]
## 31% 246.4 246.3 245.9 245.6 245.7 245.7 245.5 245.5 245.4 245.4 245.2
## 52% 250.2 250.1 250.1 250.4 250.5 250.6 250.4 250.5 250.5 250.4 250.6
## 60% 251.8 251.7 251.7 251.9 252.1 252.4 252.3 252.5 252.3 252.4 252.5
## 70% 253.7 253.7 254.0 254.3 254.5 254.5 254.9 254.9 255.1 255.0 255.1
## 95% 261.8 262.0 262.3 262.6 263.5 262.9 264.3 265.1 265.1 266.3 266.4
##     [,23] [,24] [,25] [,26] [,27] [,28] [,29] [,30] [,31] [,32] [,33]
## 31% 245.1 244.8 244.5 244.6 244.6 244.5 244.5 244.7 244.3 244.6 244.1
## 52% 250.4 250.6 250.7 251.0 250.7 250.7 250.6 250.6 250.6 250.4 250.7
## 60% 252.6 252.9 252.9 253.1 253.0 252.9 252.9 253.0 253.1 253.2 253.2
## 70% 255.7 256.0 255.7 255.8 255.6 256.2 255.9 256.0 256.3 256.2 256.6
## 95% 266.6 267.0 267.8 268.0 268.5 268.6 268.5 268.9 269.6 269.0 269.0
##     [,34] [,35] [,36] [,37] [,38] [,39] [,40] [,41] [,42] [,43] [,44]
## 31% 244.1 244.2 244.2 243.8 243.6 244.2 244.0 243.8 243.5 243.7 243.4
## 52% 250.6 250.6 250.8 250.9 251.2 251.2 250.7 251.0 250.7 250.7 250.8
## 60% 253.4 253.7 253.7 253.4 253.7 253.7 253.9 253.7 253.5 254.1 253.7
## 70% 257.2 257.0 256.7 256.8 257.0 256.9 256.9 257.1 257.3 257.6 257.6
## 95% 269.6 269.8 270.6 271.0 270.9 271.0 272.3 272.1 273.1 273.2 272.6
##     [,45] [,46] [,47] [,48] [,49] [,50] [,51] [,52] [,53] [,54] [,55]
## 31% 243.5 243.4 243.0 243.0 242.7 243.1 242.7 242.7 242.7 242.5 242.6
## 52% 250.6 250.7 250.4 250.8 250.5 250.4 250.4 250.3 250.4 250.1 250.2
## 60% 253.8 253.9 254.0 254.2 254.0 254.0 253.9 254.1 253.7 253.5 253.5
## 70% 257.5 257.3 257.8 257.8 257.6 257.7 258.2 258.4 258.4 258.0 258.2
## 95% 273.4 272.8 273.7 273.8 274.5 274.9 274.8 274.6 274.7 274.8 275.1
##     [,56] [,57] [,58] [,59] [,60] [,61] [,62] [,63] [,64] [,65] [,66]
## 31% 242.8 242.8 242.6 242.4 241.9 241.7 241.8 241.4 241.4 241.1 240.4
## 52% 250.1 250.3 250.6 250.8 250.9 250.9 250.7 250.9 250.5 250.5 250.0
## 60% 253.9 253.7 253.8 254.0 254.0 253.9 253.8 253.5 253.8 253.6 253.7
## 70% 258.0 258.3 258.4 258.3 257.9 258.3 258.4 258.5 258.4 258.3 258.5
## 95% 275.1 275.7 275.8 276.5 276.7 277.7 277.9 277.6 278.4 277.4 277.3
##     [,67] [,68] [,69] [,70] [,71] [,72] [,73] [,74] [,75] [,76] [,77]
## 31% 240.9 241.0 240.7 240.5 240.6 240.3 240.6 240.6 240.7 240.2 240.5
## 52% 250.0 250.1 249.9 250.3 250.0 250.3 250.3 250.2 250.5 250.9 250.4
## 60% 253.3 252.9 253.3 253.6 253.4 253.5 254.0 254.1 254.0 253.9 254.4
## 70% 258.8 258.9 258.6 258.7 259.1 259.2 259.2 258.7 259.0 258.7 259.5
## 95% 277.4 278.0 279.0 278.8 278.7 278.6 279.2 278.9 279.1 279.0 279.7
##     [,78] [,79] [,80] [,81] [,82] [,83] [,84] [,85] [,86] [,87] [,88]
## 31% 240.1 240.6 240.5 240.3 240.2 240.2 240.1 239.9 240.0 239.8 240.2
## 52% 251.0 250.5 250.9 250.4 250.9 251.0 250.8 250.8 250.4 250.8 250.6
## 60% 254.7 254.3 254.6 254.5 254.8 255.1 255.1 255.0 255.5 255.0 254.9
## 70% 259.9 259.6 259.8 259.6 260.2 259.8 259.9 259.7 259.5 260.0 259.9
## 95% 280.1 280.4 280.5 280.3 280.1 281.0 280.7 281.3 282.3 281.7 281.6
##     [,89] [,90] [,91] [,92] [,93] [,94] [,95] [,96] [,97] [,98] [,99]
## 31% 239.6 239.5 239.8 239.5 239.7 239.0 239.2 239.4 238.7 239.2 239.0
## 52% 250.8 250.6 250.9 250.9 250.9 250.6 250.6 251.3 250.7 250.8 250.9
## 60% 254.9 254.7 255.3 255.7 255.6 255.5 255.7 254.8 254.8 255.5 255.0
## 70% 259.4 260.1 260.2 260.5 260.5 260.9 260.6 260.8 261.0 261.2 260.6
## 95% 282.1 282.4 282.3 282.7 283.5 283.4 283.5 283.2 283.1 282.9 282.9
##     [,100]
## 31%  238.8
## 52%  251.0
## 60%  255.4
## 70%  260.8
## 95%  282.4
</code></pre>

<h4>3.1.2  Generate  1000 random samples  with 100 time periods for oats price using the parameters from estimate</h4>

<p>One simulation, different time different result. And time period still is 100 (&ldquo;yuimu&rdquo; default: delta = 1/100).</p>

<pre><code class="r">require(yuima)
# initial value is 188
m1 = setModel(drift = &quot;theta*(mu-x)&quot;, diffusion = &quot;sigma&quot;, state.var = &quot;x&quot;, 
    time.var = &quot;t&quot;, solve.var = &quot;x&quot;, xinit = ouFit.ML(oats)[[2]])
Xoats = simulate(m1, true.param = list(mu = ouFit.ML(oats)[[2]], sigma = ouFit.ML(oats)[[3]], 
    theta = ouFit.ML(oats)[[1]]))
plot(Xoats)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-12"/> </p>

<p>Increasing the number of simulation to 1000, and time period still is 100 (&ldquo;yuimu&rdquo; default: delta = 1/100). Plot the mean of the 1000 silumtion result, different time , very similar result.</p>

<pre><code class="r">simnum = 1000
# specific qunatile (which we can pick any another quantile)
dist = c(0.31, 0.52, 0.6, 0.7, 0.95)
newsim = function(i) {
    simulate(m1, true.param = list(mu = ouFit.ML(oats)[[2]], sigma = ouFit.ML(oats)[[3]], 
        theta = ouFit.ML(oats)[[1]]))@data@original.data
}
# newsim(1) simulation 1000 times, each time there are 100 time periods
sim = sapply(1:simnum, function(x) newsim(x))
# transfor to time seires format.
m2 = t(sim)
moats &lt;- apply(m2, 2, mean)

# plot the mean of the 1000 time simulation for the 100 time periods
plot(moats, type = &quot;l&quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAe1BMVEX9/v0AAAAAADkAAGUAOTkAOWUAOY8AZrU5AAA5ADk5AGU5OWU5OY85ZrU5j9plAABlADllAGVlOQBlOY9lZmVltf2POQCPOTmPOWWPZgCPtY+P29qP2/21ZgC1/rW1/v3ajzna24/a/tra/v39tWX924/9/rX9/tr9/v0zHcAQAAAAKXRSTlP/////////////////////////////////////////////////////AFL0IIcAAAAJcEhZcwAACxIAAAsSAdLdfvwAABJOSURBVHic7Z2Letu4EUYX3jb2pll7s62TtLEbbSPZev8nLClREi8AOQCGxAzmP19iyxI1AHgEEqQIzi9HYJJfSlcAlAHijQLxRoF4o0C8USDeKBBvFIg3CsQbBeKNAvFGgXijQLxRIN4oEG8UiDcKxBsF4o0C8UaBeKNAvFEg3igQbxSINwrEGwXijQLxRoF4o0C8USDeKBBvFIg3CsQbBeKNAvFGgXijQLxRIN4oEG8UiDcKxBsF4o0C8UaBeKNAvFEg3igQbxSIN8qi+LfPP45vT859+LlFdcBWUMS37o+H37eoDtgKivjDp5/nng/qYVn80933b22P/4RtfU0QBnfvX9z9cf8rOnxVYFRvFIg3Cg7njILDOaPgcM4oOYdzDkgmU/zM4dxCaFCUfPGpoUFRIN4oXOI9gzuIlwx6vFEg3ijZ4g8Pz8243nfmDuIlkyv+/cvz8fV5cBxPPFIERckV3wzq3r++YHCnjuxNfdPd94/H4/4+NjQoSv7g7vW0WZ96h3jRYFRvFIjPQHMLGQ7n3P3OOZNf0mhuYfbhXDOk3937v5ZNr5USNB+xMhzOHXePNg/nnOYmosen4zS3kWMf/2h0H29bfHJo/bij4kZCfDoQnxRaP+76QyEQn4zr/dRH9uHcU/cd7HR0p3WVULEt/vj+5TEttHrc4Jc28jf1b3+8JIVWj3XxqaHVA/FpodUD8WmhteMmD1QB8alAfGJo7UB8YmjtjMRray3Ep+IGj9RdkwHxqUB8YmjluMFDfRfjQHwiA/GzX9DKXA8Qn0i/dQ7iI0Irx40fQzwxtHImrYN4YmjlRIgXuSIgPhGITw2tnLD40S0hhB7pQXwiIfHnEX7vliAQXxWexk3G9hBfIRCfHFo3AfFuuoyTuSayxR8eAldXi2wuGxTx122AxDWRK7693VnLfnqjO4nNZcMv3nkWqlT8ZV68tfnx5sWjx/efMiT+MocK+3jPKbqqxSeH1k2UeImrAuLT8Ir3PlGp+Jm8cwJbywdJ/HUzL3BVMIgP5Z0T2Fo+aI2rW3wo75zA1rJBbFvN4mfyzqXXSjwQbzTvXKR4gesCo/okID49tGog/gIGd4HFahcfH1ok1DrTl3Nxb9gMiB9AzZ0F8ZXlnXOeM+6B5Yjx3PWRLDi+lq0o7xz1xDrEV5Z3jnq6hSz+tqCw1ZG9qa8r7xzEdxjLO0c99iI3rb+/k7U+MKrvQx2C05sWEF9+3UB8n63ECxj4MhzOVZR3biPxEibXZB/OVZWFinrsBfGV5Z3jFx+IXn7doMf32UQ89STRunDs4+vJO+cmDxaWS4leifjk0BLxifc1A+IzQkvEc57Ne+SVI556cnBlIL6Hp5/7B+DZ4suvHIjv4Tm3xim+39mLr5zsw7ma8s65yR+eI6+Mg7GaxFeVd24s3nuPWojvqCjv3LDGznmfzTjv1vscFV852Mf7hvKB189/QXxeaDHEik//bg3iJbF4kQzE84aWQpz4vNMvDuLF4OI29XmNgng59I7OAhVmFb9Q1nZAfJT4zDZBvBj6p2gg/gbEQzx3aBkQxPdPsua2yUH8FhBqECHeMVwj6SYPSgHxET0+/3J4iN8ETvE8rYH4LSB00IHTDcSPghYE4q8/Ib6HJfHBpSGeNfT6QHx6+RB/hHjm0OtDOO4mi2dvTOm1U7F4R6gCSTwpUiwC1s4cmhMVQHxG+ZoTFUB8RvmaExXQxS/txSF+iuBEBQRd/XN2EN9Hc6ICTvH8bRGwduZQPKqnHIRBfAg74ucWhfgQh4/TLX3ppkF8TvmKp0lDfE75lKTCjfLKe/wad6JUL75V/+Ev9eLnl1yjKQJWzwy0ffzhwXM0V7hlpK/Urq8vdGmIZwy9MkunYYcvQ/yIusXfXoX4EXrzzkWKX7UuC4UXAT2esNwqQPw6xIkvgHbxQvPOucGv+YXKoFy81LxzEJ9XvNq8cxCfV7zavHMQn1e81rxzbvR7fqkiqBefGnpVID6z+KrFSzjelFq81rxzEJ9ZvNYsVBCfWbzSvHO0c7EQH0Zpj4f43OKV5p0jiRd+8VPZ0pWO6iE+t3Sd4p33YXihMkA8OxCfXXq94ot7Vy5e5IQKiM8uXWfeOYL48t61i5eYdw7is0tXuY93gcehZQoB8dwQxAvwDvHsQHx+6RC/HhDPjQv+sfDstkA8N8viJXiHeHbmxDvfk2WAeGbczF8QTyy9NvHdrS8gHuILUrQWtsS7838Z3iGeGYhnKLwu8ZfNPMRbFH9c43aFSUA8L94DuN6jshP3e0A8K+NiJ+KldHiI5wXiOQqvUrwUIJ4ViOconDSFyn+RLcQvoVp8e9erlv30fmcQv4Bq8Zfp0XKmSUM8R+EV9Hhxg/krqsVfptLI3cdDfErhFYzqIT6lcH3ip6VCfELh+tKPQTxL4fpmyyoSX7RGDIM7WenHIJ6lbH3pxyCepWx96cc8pbrgK4VRLz4p9EpAPEvZnfjdh587555ZQ68ExLOUfRb/9sdL8887grsg5lw9xLOU3Yn//KPp87Pi40OvRFC8PO/yxR937u5lv86mnrvxEM9S9vrpxyBeZNnXTf3RuxtnSD8G8SLLbsVfz8p6enV++jHmxnvDuRUK4kC4+EBf78hMP8Y9uwHiecpePf0YxMss+zqqD1xlkxG6WwjiRZZ9PYHTbMp3nl6dEbpbCOJFln3dx5//eZbITD+2ifjTsxAfU/ZZfDNub/55z9zlJiPinrOsSnzJOtH28Y3zvXO++5Pnph+DeJlFr55+bBvx7dMQH1P02unH2IUExUv0Ll98ezbee+IuI/RlGYiXWHQ3uDulH9lFmpckXs79TwZIFz/zJU166MsyEC+xaPT4VZEufmYfnzmhglt8OBjERxW9dvoxiBdadCd+P/MlTU76MfYTKyL1hpEuPug2J/RlEYiXWPTyhRjJoS+LQLzEoi/fx4f24xmhL4tYFp9WX5ZGlr0QA+I3e1NkEOzj10W6eOzjV0K4+FX38ayyLIjnOQlJ6/HBW5plhL4uAfGR79mwx68R+gjxEM8GxDOVrEy8Nu9p4lmaCfFFgXge1IlPqDHTF5oQXxaIZwHiuQpeVbwjLsdYpDggngWI5yoY4lcG4lkwIJ7rey2IL4ta8e03tu13OCm3O4P4PPFZrWUQf/q2/vB7bGiIb9Es/jRDmj4/3o0f8dnS5z2+zmLEP919//YjZn78RDyfL4hnK5cwuHv/4u6Pe/r8eIgfEFnn/snOrO9ntx/Vu/CDXGyJz/uWDuILo1Z8eyuU15hboUD8AK3iT3evbhOQxQ/uIL5Fq/j2MG4fdbuz65AE4ltCdZ7tNgLEX9KIR/R4iO+jVXxzIN+a30Xs4yG+T474nAYXGNVD/IDF0x2epzWKv22gIP6EcvHkwd2K4lV6X1xNvoUFiSeHdoPKU+qQWaB0UsW7I8Qzx9kWreJj885B/Igc8RlNZjlzF5N3DuJHpIi/7t/LiY/OOwfxI5SKj8475xHPZQzis4u9wp93DuJHqBUfGRrix/iqHTpGVy3+6MYvQ7znOeniY/POQfyYgPjg893vyVrML7UHfxYq32cV4n3PzYuf7jDzS+1BuhAjKu/ceuKVeo8R724PSotfs8dHNgric0vtwZ93ji4+9goTiM8ttcd6o3qIvwDx07dHNasi8b015LyLQvxiefLJEp/c6lLi/e2ZPBfTLK3iPRVfFO+5cjG70AGE2bKReedYxS9GUUFA/Hk9SRUfnXeOKJ7WLogvuKmPyzvXSXdLi9oVf+sWs+L9b04tdAL7Pr7be/GID60VZQxbMRIfGAVD/EJ5GhipdT3xbvLq+JEu8eOXwuJnKzj4AKn1PhXveo8DTfR8BNIL9QDxGzBuhDMsftyu0BFCZeK7xhLELzwZU6iXtfbxS4uaFn/75Y584heHVQOEiPdfo0/oDiqwI375WVPigwMaZ1n8+VO/LF6x92vdJ0Mfinhiy5fH0wNkiA9fZF65+NGTEN97ZTauEmbFL364qxbvfV9/QwjxxDKI79pI/NzIYzK2HSzkpm/Qx/ynF+J974H4asVPxraDhcZbQ5UQxdPWHXEhDeID76tO/NK6gfjJ8xBPLIL8LgniQ+9zwx+amf34Lh6yUpoP8SLRKP7wELjIdm3xvZUF8cQS6G8i3716P73fWbr4UPf2PRMY8utifqQyP+hfWqeBrpEr/jI9mjhNmlZ3m+KDrRApPrLHryJevfd1xfu7RvY+vptKQ9zHQ7wXkvjFD0bgbSuJD8MqPjg6qUL8/A4rU7x/FQkRP3wB4icvEl4fP3sdMa4jPi792BriK/A+//lNFH/bgfguYOIY3EWkH+MTfxvxGBEfbmYR8ZHpx0jivQtVLn4uUWy2eNpoeQB3+jF+8XmpdeWQIT60wlYVH5l+DOKDLInNER9XXEuRUX2k+KhKyQXijYqfYfZgL/TaRuIZB3ehsUrgb4ivpMcHFgmKN0A4w0/3uv+52c+LOPHET6gl74sUER+XfmyxHtSKQnyPEuIj048t1YM8dIX4HiXER6YfYztLAfE9Qmvarbmpj0s/tiCePoKB+B5FxMelH5sXP1sZiA/jWRvri4+pDcSvg3Lx83WB+DDTg+Fuz7k0pgrCnH5sbuy29GWLC/4BCoiPS0ZEHrQvLQDxAwqIj0s/luML4sPcfA9OhKno8YtAfJib7s3Ex6Ufg/h1KCF+uTb00ujhIH6AGfHwPqRq8f03Q/yQnm7Xf2bxCs4gMsXD+4iJeDd8fuYtAZjTj0H8StxEbyU+Lv0YxK9EAfFR6cd4xMP7hJvu7cTHhIb4lejpvv2oTTy8TxmJJ6wiiK+CqsUTtl9mGYqnrCF94uHdA8RbpTeko00f3lR8pjOID1O1+MGRChjQG9LRVpA68fDuJXrVQHwlEMd0/eXngHgtVC3+WMstrlYA4o0C8VaJXDcQXwtVi4f3MJH3+4P4WqhbPAgD8UaBeKNsK76dJdteYk253Rm8C4JB/GmG9OH35dAQLwgG8acZ0pT58RAviGzxT3ffv/2gzY+HeEHkD+7ev7j7454yPx7iBbHlqB7iBQHxRskWf3hwd8R72UK8IHLFt3evbifMQrwyOE7gHI+v9xCvDI4e37D720eIV0X2Pv7t6XRjBE/iOYiXDEb1RtlQPLxLgks8YXAH8ZJAjzcKxBuF4cwdNe8cxEuC4ziemHcO4iXBcOaOmncO4iWRvamn552DeEnkD+7IeecgXhIY1RsF4o3CcSEGMe8cxEsi+3COnoUK4iXBcSEGMe8cxEtiux4P76Lg2MfT8s5BvCi2G9VDvCgg3igQbxSIN0r+bFlq3jmIF0V2j4/KOwfEkL+pj8k7B8Sw6c2PgBwg3igQbxSINwrEGwXijQLxRoF4o0C8USDeKBBvlDXFA8msJ77/GeAJIzyY2IolBIP4QrFKB4P4QrFKB4P4QrFKB4P4QrFKB4P4QrFKB4P4QrFKB2MSD7QB8UaBeKNAvFEg3igQbxSINwrEGwXijQLxRuEQ//bku5t9CocH5575Ap5Sp7EEe/9yTrfJUrGmle3NBjiCHT7eAsXFYxDfrt6d5x7H8bQTsg+/vbAF3Llnptq1t/D+8JMnVtvKHU+wffsJ6gJFxmMQ39768DBNR5jA6dbor89cAQ//+POZp3bd3R15KtbeMbCJxBDs9e4/TYAuUGQ8BvGnhoRunhBNE4kp4PvX700nYAl2+PTvdlPPU7Gux/NUrDHdBYqMxyC+2QbyiW9vvMIUcPfYbv1Ygh0eTp8gpoqdd8Y8FWvEd4Ei4wnr8ad8pjwBmyjvfD0+pVOFgv32ctz/+kN/j+fbx596FlfA3eni8keeffw/TyuVp2Jd12QJdii5j2+3zjyj+rN3voBtj+cJ9vp83oJwxOp6PEuw1nQXKDKeqOP4cyd9Fngc3wThOvRuD8LYTgoUPY4HGoF4o0C8USDeKBBvFIg3CsQbBeKNAvFGgXijQLxRIN4oEG8UiDcKxBsF4o0C8UaBeKNAvFEg3iiWxQ8vRj5dmWkHiL8A8WZoxLeT4rqJ2X//87m7ivqVa56AZKyLfzhP1Wtc75sPwFn52+f/fmaZGCQZ6+I/XqcfNZv6dupZ+3DnHkvXbXUg/vKrnZj/5E6TXNpJTrUD8f0e323hX/9V/S4e4s9TTG/7+H17y4L/fa2+y0N8N+P0Mqq/e7ncTqFuLIs3DcQbBeKNAvFGgXijQLxRIN4oEG8UiDcKxBsF4o0C8UaBeKNAvFEg3igQbxSINwrEG+X/GigUGMtlV2IAAAAASUVORK5CYII=" alt="plot of chunk unnamed-chunk-13"/> </p>

<pre><code class="r">
# find out the quantile to decribe the distribution
tile = sapply(1:100, function(x) quantile(m2[, x], dist))
tile
</code></pre>

<pre><code>##      [,1]  [,2]  [,3]  [,4]  [,5]  [,6]  [,7]  [,8]  [,9] [,10] [,11]
## 31% 186.2 185.8 185.7 185.5 185.4 185.4 185.3 185.1 185.1 185.0 184.9
## 52% 186.2 186.3 186.4 186.4 186.4 186.5 186.5 186.5 186.4 186.4 186.5
## 60% 186.2 186.5 186.7 186.8 186.8 186.9 187.0 187.0 186.9 187.0 187.1
## 70% 186.2 186.8 187.1 187.2 187.4 187.4 187.6 187.6 187.5 187.6 187.8
## 95% 186.2 187.8 188.6 189.0 189.5 189.8 190.1 190.5 190.8 191.0 191.1
##     [,12] [,13] [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22]
## 31% 184.7 184.7 184.7 184.7 184.6 184.6 184.4 184.4 184.3 184.3 184.4
## 52% 186.4 186.5 186.6 186.5 186.7 186.7 186.6 186.5 186.6 186.6 186.6
## 60% 187.0 187.2 187.2 187.2 187.3 187.3 187.3 187.3 187.3 187.4 187.5
## 70% 187.9 187.9 188.0 188.2 188.1 188.3 188.3 188.3 188.4 188.5 188.6
## 95% 191.5 191.5 191.9 192.3 192.3 192.4 192.3 192.7 192.6 193.0 193.3
##     [,23] [,24] [,25] [,26] [,27] [,28] [,29] [,30] [,31] [,32] [,33]
## 31% 184.3 184.2 184.2 184.0 184.3 184.2 184.3 184.3 184.2 184.1 183.9
## 52% 186.6 186.5 186.4 186.6 186.5 186.5 186.6 186.7 186.7 186.7 186.6
## 60% 187.5 187.3 187.5 187.5 187.5 187.6 187.7 187.8 187.6 187.6 187.6
## 70% 188.6 188.6 188.7 188.7 188.8 188.9 188.9 188.8 189.0 188.8 189.0
## 95% 193.5 193.7 193.8 193.6 194.1 194.1 194.2 194.2 194.6 195.0 195.4
##     [,34] [,35] [,36] [,37] [,38] [,39] [,40] [,41] [,42] [,43] [,44]
## 31% 183.9 183.8 183.8 183.6 183.5 183.5 183.4 183.3 183.2 183.2 183.2
## 52% 186.6 186.6 186.7 186.6 186.8 186.7 186.6 186.6 186.6 186.7 186.6
## 60% 187.6 187.6 187.7 187.7 187.8 187.9 187.9 188.0 187.9 187.8 188.1
## 70% 189.0 189.4 189.3 189.3 189.3 189.4 189.6 189.7 189.6 189.7 189.9
## 95% 195.2 195.6 195.6 196.0 195.7 195.9 195.9 196.4 196.4 196.5 196.8
##     [,45] [,46] [,47] [,48] [,49] [,50] [,51] [,52] [,53] [,54] [,55]
## 31% 183.1 183.1 183.0 182.9 182.9 182.9 183.0 183.0 182.7 182.9 182.9
## 52% 186.7 186.7 186.9 186.8 186.7 186.8 186.6 186.7 186.7 186.7 186.9
## 60% 188.0 188.2 188.1 188.2 188.1 188.2 188.3 188.2 188.3 188.1 188.3
## 70% 190.0 189.9 189.9 189.8 190.0 189.9 190.0 189.9 190.0 190.0 190.2
## 95% 197.0 196.9 197.3 197.4 197.4 197.7 197.4 197.7 197.8 198.0 198.2
##     [,56] [,57] [,58] [,59] [,60] [,61] [,62] [,63] [,64] [,65] [,66]
## 31% 182.9 183.0 182.9 183.0 182.9 182.9 182.5 182.7 182.8 182.7 182.7
## 52% 186.9 186.8 186.9 186.8 186.8 186.7 186.8 186.7 186.7 186.6 186.8
## 60% 188.2 188.4 188.4 188.3 188.4 188.4 188.4 188.4 188.3 188.5 188.5
## 70% 190.2 190.2 190.2 190.4 190.4 190.0 190.2 190.6 190.6 190.6 190.6
## 95% 198.7 198.8 198.8 199.0 198.6 198.7 198.8 198.9 198.7 199.0 199.1
##     [,67] [,68] [,69] [,70] [,71] [,72] [,73] [,74] [,75] [,76] [,77]
## 31% 182.4 182.4 182.5 182.6 182.6 182.6 182.4 182.4 182.3 182.3 182.4
## 52% 186.9 186.8 186.7 186.8 186.9 186.7 186.8 186.7 186.6 186.7 186.5
## 60% 188.5 188.5 188.6 188.4 188.5 188.3 188.3 188.2 188.2 188.1 188.2
## 70% 190.5 190.5 190.7 190.6 190.5 190.4 190.5 190.5 190.5 190.5 190.5
## 95% 199.3 199.1 199.1 199.1 199.0 198.9 199.3 199.1 199.1 199.3 199.4
##     [,78] [,79] [,80] [,81] [,82] [,83] [,84] [,85] [,86] [,87] [,88]
## 31% 182.2 182.2 182.2 182.1 182.3 182.3 182.2 182.2 182.2 182.3 182.1
## 52% 186.4 186.6 186.4 186.4 186.7 186.4 186.5 186.5 186.6 186.6 186.6
## 60% 188.0 188.1 188.1 188.2 188.3 188.2 188.2 188.4 188.4 188.4 188.4
## 70% 190.6 190.5 190.7 190.7 190.7 190.7 190.6 190.8 190.8 190.9 191.0
## 95% 199.8 199.8 199.7 200.2 199.6 199.9 200.0 199.9 200.0 200.2 200.5
##     [,89] [,90] [,91] [,92] [,93] [,94] [,95] [,96] [,97] [,98] [,99]
## 31% 182.2 182.3 182.2 181.9 181.9 181.9 181.8 181.8 181.9 181.9 182.0
## 52% 186.6 186.6 186.6 186.4 186.6 186.5 186.5 186.6 186.6 186.6 186.4
## 60% 188.4 188.4 188.6 188.5 188.5 188.5 188.5 188.4 188.3 188.5 188.7
## 70% 190.9 191.0 190.9 190.9 190.8 190.8 190.8 191.0 191.1 191.1 191.1
## 95% 200.5 200.2 200.1 200.2 200.0 200.3 200.4 201.0 200.8 201.0 200.6
##     [,100]
## 31%  181.8
## 52%  186.4
## 60%  188.6
## 70%  191.1
## 95%  200.9
</code></pre>

<h4>3.1.3  Generate  1000 random samples  with 100 time periods for barley price using the parameters from estimate</h4>

<p>One simulation, different time different result. And time period still is 100 (&ldquo;yuimu&rdquo; default: delta = 1/100).</p>

<pre><code class="r">require(yuima)
# initial value is 188
m1 = setModel(drift = &quot;theta*(mu-x)&quot;, diffusion = &quot;sigma&quot;, state.var = &quot;x&quot;, 
    time.var = &quot;t&quot;, solve.var = &quot;x&quot;, xinit = ouFit.ML(barley)[[2]])
Xbarley = simulate(m1, true.param = list(mu = ouFit.ML(barley)[[2]], sigma = ouFit.ML(barley)[[3]], 
    theta = ouFit.ML(barley)[[1]]))
plot(Xbarley)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-14"/> </p>

<p>Increasing the number of simulation to 1000, and time period still is 100 (&ldquo;yuimu&rdquo; default: delta = 1/100). Plot the mean of the 1000 silumtion result, different time , very similar result.</p>

<pre><code class="r">simnum = 1000
# specific qunatile (which we can pick any another quantile)
dist = c(0.31, 0.52, 0.6, 0.7, 0.95)
newsim = function(i) {
    simulate(m1, true.param = list(mu = ouFit.ML(barley)[[2]], sigma = ouFit.ML(barley)[[3]], 
        theta = ouFit.ML(barley)[[1]]))@data@original.data
}
# newsim(1) simulation 1000 times, each time there are 100 time periods
sim = sapply(1:simnum, function(x) newsim(x))
# transfor to time seires format.
m2 = t(sim)
mbarley &lt;- apply(m2, 2, mean)

# plot the mean of the 1000 time simulation for the 100 time periods
plot(mbarley, type = &quot;l&quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAclBMVEX9/v0AAAAAADkAAGUAOWUAOY8AZrU5AAA5ADk5AGU5OWU5OY85j9plAABlADllAGVlOQBlOY9lZmVltf2POQCPOTmPZgCPtY+P29qP2/21ZgC1/rW1/v3ajzna/rXa/tra/v39tWX924/9/rX9/tr9/v0I3bOEAAAAJnRSTlP/////////////////////////////////////////////////AKd6gbwAAAAJcEhZcwAACxIAAAsSAdLdfvwAABDBSURBVHic7Z0Le6O4FYZXM02y2ziTbZ20tRt34wv//y8WfBUgQJcjJPF97zOT+CKdI/MiJGHs/FYRSH5L3QCSBooHheJBoXhQKB4UigeF4kGheFAoHhSKB4XiQaF4UCgeFIoHheJBoXhQKB4UigeF4kGheFAoHhSKB4XiQaF4UCgeFIoHheJBoXhQKB4UigeF4kGheFAoHhSKB4XiQaF4UCgeFIoHheJBoXhQKB4UigeF4kGheFAoHhSKB4XiQaF4UCgeFIoHheJBoXhQKB4UigeF4kGheFAoHhSKByVEvCI5E1F8QF0SG4oHJVT88e165Pj55RiaJCW4x58+Vn6hSVLCD/XHXxuv0CQpHONBoXhQpMQf3zm5Kwr2eFAoHpRw8dvzMn7tHJokJVj8tla+W1fbZ9fQJCnBZ+6aSd3h9XumyR13JilCxZ8+N1W1f672T9+Oob2geCmCD/XNyfqn7/2Px+k7yzf+vKB4KQqb1VO8FBQPSrD4w4t63pnelY0hKcrwgYnE5G73fJ7YO4b2geLFkFjO7VZznauneDEK6/Ec5KWQGONX843xFC9FWbN6iheD4kEpQLzSb1K8EBQPSv7X1WtLOMVTd2Lkf1291sspXo78r6un+CjkP8ZTfBSyF6/Lpng5ShB/j0TxclA8KBQPSu7ilR6J4uXIXLzSxbd2AhJG1uKV1tUrihclZ/Gqc4viBaF4UCgelIzFq+5tiheE4kGheFAKEf84gUfxMhQkXvUfJd6UIv7+tjzFy5Cb+O4STnuG4iWheFDKEc9DvSjZidevs5ILS7pQPCiZiX9cUjtYm+JFoHhQshPfutxGKizpQfGgUDwoFA9KfuKn3oSjeBEoHhSKByUv8XfnI3UpXoQMxVfj33TD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" alt="plot of chunk unnamed-chunk-15"/> </p>

<pre><code class="r">
# find out the quantile to decribe the distribution
tile = sapply(1:100, function(x) quantile(m2[, x], dist))
tile
</code></pre>

<pre><code>##      [,1]  [,2]  [,3]  [,4]  [,5]  [,6]  [,7]  [,8]  [,9] [,10] [,11]
## 31% 188.8 188.3 188.1 187.9 187.6 187.7 187.4 187.4 187.5 187.4 187.4
## 52% 188.8 189.0 188.9 188.9 189.0 188.9 189.0 189.1 189.2 189.3 189.2
## 60% 188.8 189.2 189.3 189.4 189.5 189.4 189.7 189.7 189.8 190.1 190.0
## 70% 188.8 189.5 189.6 189.9 190.1 190.2 190.5 190.6 190.7 190.9 191.0
## 95% 188.8 190.7 191.5 192.0 192.5 192.8 193.3 193.6 194.0 194.1 194.7
##     [,12] [,13] [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22]
## 31% 187.3 187.3 187.2 187.0 186.9 186.7 186.5 186.5 186.4 186.2 186.2
## 52% 189.2 189.1 189.3 189.4 189.3 189.5 189.5 189.3 189.1 189.1 189.1
## 60% 189.9 190.1 190.2 190.2 190.3 190.3 190.4 190.4 190.2 190.4 190.1
## 70% 191.0 191.2 191.3 191.3 191.5 191.6 191.6 191.8 191.7 191.9 191.9
## 95% 195.2 195.2 195.6 196.3 196.5 196.6 196.8 197.2 197.2 197.5 197.7
##     [,23] [,24] [,25] [,26] [,27] [,28] [,29] [,30] [,31] [,32] [,33]
## 31% 185.9 185.8 185.9 185.9 185.8 185.7 185.5 185.4 185.5 185.5 185.4
## 52% 189.0 188.9 188.7 188.6 188.7 188.7 188.7 188.7 188.8 188.9 189.0
## 60% 190.0 190.0 189.8 189.7 190.0 190.1 190.2 190.0 190.2 190.2 190.1
## 70% 191.7 191.5 191.6 191.7 191.7 191.7 191.6 191.8 191.9 192.1 192.3
## 95% 197.9 197.9 198.3 198.6 198.6 199.0 199.3 199.2 199.3 199.3 199.5
##     [,34] [,35] [,36] [,37] [,38] [,39] [,40] [,41] [,42] [,43] [,44]
## 31% 185.2 185.5 185.3 185.3 185.3 185.3 185.1 185.2 185.2 185.2 185.0
## 52% 188.9 188.7 189.0 188.8 188.9 188.8 189.1 189.1 189.0 188.9 189.1
## 60% 190.2 190.2 190.3 190.5 190.5 190.4 190.4 190.5 190.7 190.8 190.7
## 70% 192.1 192.1 192.4 192.2 192.4 192.4 192.5 192.7 192.8 193.0 192.9
## 95% 199.6 199.8 200.1 200.3 200.5 200.7 200.7 200.6 200.7 200.7 201.2
##     [,45] [,46] [,47] [,48] [,49] [,50] [,51] [,52] [,53] [,54] [,55]
## 31% 185.1 184.9 184.9 184.9 184.8 184.9 184.9 184.8 184.7 184.6 184.4
## 52% 188.9 188.9 188.9 189.0 189.3 189.0 189.0 188.9 188.8 188.8 189.1
## 60% 190.6 190.9 190.9 190.9 191.0 190.8 190.8 190.9 190.8 190.6 190.7
## 70% 192.9 193.0 192.9 192.8 192.7 192.8 193.1 192.9 193.4 193.3 193.1
## 95% 201.1 201.2 201.2 201.7 202.2 202.0 201.8 202.1 202.3 202.6 202.4
##     [,56] [,57] [,58] [,59] [,60] [,61] [,62] [,63] [,64] [,65] [,66]
## 31% 184.5 184.6 184.5 184.5 184.5 184.4 184.4 184.2 184.3 184.3 184.2
## 52% 188.9 188.9 188.9 189.0 189.2 189.3 189.0 188.9 189.0 189.1 189.2
## 60% 190.7 190.7 190.6 190.8 190.9 190.7 190.8 190.6 190.7 190.6 190.9
## 70% 193.0 192.8 193.2 193.1 193.1 192.9 193.1 193.1 193.2 193.4 193.5
## 95% 202.2 202.6 202.9 203.0 203.1 203.4 203.2 203.3 203.2 203.8 203.6
##     [,67] [,68] [,69] [,70] [,71] [,72] [,73] [,74] [,75] [,76] [,77]
## 31% 184.1 184.3 184.3 184.2 184.4 184.3 184.2 184.2 184.1 183.9 184.0
## 52% 189.3 189.1 189.2 189.3 189.3 189.3 189.0 188.9 188.8 189.0 188.9
## 60% 190.7 190.9 190.9 191.0 191.0 190.9 190.6 190.7 190.9 190.7 190.9
## 70% 193.2 193.3 193.4 193.3 193.4 193.5 193.4 193.4 193.5 193.4 193.4
## 95% 203.9 203.6 204.0 204.3 204.2 204.5 204.5 204.7 205.0 204.4 204.6
##     [,78] [,79] [,80] [,81] [,82] [,83] [,84] [,85] [,86] [,87] [,88]
## 31% 183.9 183.9 184.0 183.9 184.0 183.7 183.8 183.8 183.6 183.9 183.6
## 52% 188.7 188.6 188.8 189.0 188.8 188.7 188.9 188.9 189.0 189.2 189.0
## 60% 190.9 190.9 190.7 191.0 191.1 191.1 191.2 191.1 191.3 191.2 191.1
## 70% 193.5 193.7 193.7 193.7 193.8 193.5 193.6 193.6 193.5 193.6 193.8
## 95% 204.7 204.8 204.5 204.4 205.1 204.7 205.3 205.6 205.8 205.4 206.2
##     [,89] [,90] [,91] [,92] [,93] [,94] [,95] [,96] [,97] [,98] [,99]
## 31% 183.5 183.2 183.3 183.4 183.3 183.2 183.2 183.0 183.1 183.2 183.1
## 52% 189.0 189.2 189.1 189.2 189.2 189.3 189.1 188.9 188.8 189.0 188.6
## 60% 191.3 191.2 191.2 191.0 191.2 191.0 191.1 191.1 191.0 191.1 191.1
## 70% 193.7 194.0 194.1 193.8 193.9 194.2 194.1 194.1 194.1 194.3 194.4
## 95% 206.1 206.2 206.0 206.2 205.8 206.4 206.3 206.7 206.8 206.8 206.4
##     [,100]
## 31%  183.2
## 52%  188.7
## 60%  190.9
## 70%  194.5
## 95%  206.6
</code></pre>

<h4>3.1.4  Generate  1000 random samples  with 100 time periods for canola price using the parameters from estimate</h4>

<p>One simulation, different time different result. And time period still is 100 (&ldquo;yuimu&rdquo; default: delta = 1/100).</p>

<pre><code class="r">require(yuima)
# initial value is 188
m1 = setModel(drift = &quot;theta*(mu-x)&quot;, diffusion = &quot;sigma&quot;, state.var = &quot;x&quot;, 
    time.var = &quot;t&quot;, solve.var = &quot;x&quot;, xinit = ouFit.ML(canola)[[2]])
Xcanola = simulate(m1, true.param = list(mu = ouFit.ML(canola)[[2]], sigma = ouFit.ML(canola)[[3]], 
    theta = ouFit.ML(canola)[[1]]))
plot(Xcanola)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-16"/> </p>

<p>Increasing the number of simulation to 1000, and time period still is 100 (&ldquo;yuimu&rdquo; default: delta = 1/100). Plot the mean of the 1000 silumtion result, different time , very similar result.</p>

<pre><code class="r">simnum = 1000
# specific qunatile (which we can pick any another quantile)
dist = c(0.31, 0.52, 0.6, 0.7, 0.95)
newsim = function(i) {
    simulate(m1, true.param = list(mu = ouFit.ML(canola)[[2]], sigma = ouFit.ML(canola)[[3]], 
        theta = ouFit.ML(canola)[[1]]))@data@original.data
}
# newsim(1) simulation 1000 times, each time there are 100 time periods
sim = sapply(1:simnum, function(x) newsim(x))
# transfor to time seires format.
m2 = t(sim)
mcanola &lt;- apply(m2, 2, mean)

# plot the mean of the 1000 time simulation for the 100 time periods
plot(mcanola, type = &quot;l&quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAflBMVEX9/v0AAAAAADkAAGUAOTkAOWUAOY8AZrU5AAA5ADk5AGU5OWU5OY85ZrU5j9plAABlADllAGVlOQBlOY9lZmVltf2POQCPOTmPOWWPZgCPjzmPtY+P29qP2/21ZgC1/rW1/v3ajzna24/a/tra/v39tWX924/9/rX9/tr9/v2Gstw8AAAAKnRSTlP//////////////////////////////////////////////////////wAyqPBcAAAACXBIWXMAAAsSAAALEgHS3X78AAARCUlEQVR4nO2dC3ujuBmFV5l2nJ3OOJttk5m2kzRuxxf+/x8sYHwBJCGhTxc45312xzaGI5nXIImL81tFIPktdwVIHigeFIoHheJBoXhQKB4UigeF4kGheFAoHhSKB4XiQaF4UCgeFIoHheJBoXhQKB4UigeF4kGheFAoHhSKB4XiQaF4UCgeFIoHheJBoXhQKB4UigeF4kGheFAoHhSKB4XiQaF4UCgeFIoHheJBoXhQKB4UigeF4kGheFAoHhSKB4XiQaF4UCgeFIoHheJBoXhQKB4UigfFUfzhy0fcepDETIo/Pqkzn6h+TUxv8cenWjm3+LXhsqs/Pn3+r068IiUTLr5u4h91O/qJaJIVEfGzoklWKB4UKfHH59HOnuJLhls8KBQPSrD4w6Pa7LTHbyi+ZELFn76/VbtN7f/rL89okpVQ8U2nbrdl525xcIsHRaKN3/bbeMeDgiQr7NWDQvEoKOvLIU67+gYO50pHWPzp9aV93H9m565shMVfhnEczpUOt3hQpNv47qI7tvGlIy3euSSSF4oHJULnrtnbj5t4ii8LefFth/7wbaokkhd58e35GQ7nSkda/NPDzx8fPDtXPEMb4Z2706vaVHsO5wpHXrxzUSQnFA8KxYNC8aBQPCgUDwrFg0LxoFA8KBQPCsWDQvGgUDwoFA8KxYNC8aBQPCgUv3xmrViKXz4UD8qcFTtahuKXB8WDQvGgUDwoc35PjOJXAMWDQvGYqMua9VnBFL98KB4UigeF4kG5ifdYwxS/fC7ilc8apvjlQ/GgqG7VUjwYFA8KxYNyE++xiil++VA8KBQPSif88r/zQhMT+lB8eXiKV9d/xpPNUHx5UDwmqqJ4SHrSHdYx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" alt="plot of chunk unnamed-chunk-17"/> </p>

<pre><code class="r">
# find out the quantile to decribe the distribution
tile = sapply(1:100, function(x) quantile(m2[, x], dist))
tile
</code></pre>

<pre><code>##      [,1]  [,2]  [,3]  [,4]  [,5]  [,6]  [,7]  [,8]  [,9] [,10] [,11]
## 31% 507.7 506.8 506.5 506.2 505.9 505.7 505.5 505.5 505.3 505.3 505.0
## 52% 507.7 507.9 507.9 507.9 507.8 507.9 508.0 508.0 508.1 508.1 508.2
## 60% 507.7 508.2 508.4 508.6 508.5 508.6 508.7 508.9 509.0 509.3 509.4
## 70% 507.7 508.7 509.1 509.3 509.6 509.7 509.9 510.0 510.3 510.9 511.1
## 95% 507.7 510.9 512.0 513.0 513.9 514.3 515.0 515.1 515.9 516.6 516.8
##     [,12] [,13] [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22]
## 31% 505.0 504.7 504.6 504.5 504.3 504.3 504.4 504.4 504.4 504.1 503.6
## 52% 508.3 508.4 508.5 508.6 508.6 508.3 508.4 508.5 508.7 508.6 508.5
## 60% 509.4 509.6 509.9 510.0 509.9 509.8 509.8 510.2 510.2 510.3 510.5
## 70% 511.3 511.6 511.2 511.6 511.9 511.8 512.0 512.4 512.4 512.6 512.5
## 95% 517.5 517.9 518.2 518.8 518.9 519.3 519.8 520.4 520.7 521.0 521.2
##     [,23] [,24] [,25] [,26] [,27] [,28] [,29] [,30] [,31] [,32] [,33]
## 31% 503.6 503.3 503.4 503.4 503.4 503.3 503.1 503.1 502.9 502.6 502.7
## 52% 508.5 508.6 508.6 508.4 508.5 508.7 508.7 508.8 508.8 508.7 508.5
## 60% 510.4 510.4 510.3 510.2 510.3 510.4 510.8 510.8 510.6 510.6 510.8
## 70% 512.5 512.9 513.1 512.9 513.1 513.2 513.3 513.3 513.4 513.3 513.7
## 95% 521.9 522.0 522.5 523.1 523.1 523.4 523.5 524.5 525.2 524.2 524.6
##     [,34] [,35] [,36] [,37] [,38] [,39] [,40] [,41] [,42] [,43] [,44]
## 31% 502.4 502.4 502.5 502.3 502.3 502.0 502.2 502.3 502.1 502.1 501.9
## 52% 508.4 508.6 508.6 508.7 508.9 508.9 509.0 509.0 509.1 509.1 509.0
## 60% 510.6 510.9 510.8 511.1 511.1 511.4 511.2 511.2 511.3 511.2 511.4
## 70% 513.9 514.0 514.1 513.7 514.1 514.2 514.3 514.2 514.2 514.3 514.6
## 95% 525.0 525.0 525.7 525.9 526.9 527.0 527.8 527.3 527.5 528.0 528.1
##     [,45] [,46] [,47] [,48] [,49] [,50] [,51] [,52] [,53] [,54] [,55]
## 31% 501.6 501.7 501.5 501.9 501.9 502.3 502.0 501.5 501.4 501.5 501.1
## 52% 508.7 508.9 508.6 508.4 508.4 508.3 508.2 508.2 508.5 507.8 508.1
## 60% 511.5 511.3 511.3 511.5 511.1 511.1 511.3 511.5 511.5 511.8 511.5
## 70% 514.8 514.4 514.5 514.4 514.3 514.6 514.9 514.9 514.9 515.0 515.0
## 95% 528.1 528.6 528.9 529.4 530.2 530.3 529.8 530.2 530.3 530.2 530.5
##     [,56] [,57] [,58] [,59] [,60] [,61] [,62] [,63] [,64] [,65] [,66]
## 31% 501.3 501.4 501.3 500.7 500.7 500.9 500.9 500.7 500.6 500.6 500.4
## 52% 508.1 508.1 508.4 508.4 508.6 508.7 508.4 508.5 508.8 508.8 508.6
## 60% 510.9 510.9 511.3 511.2 510.9 510.9 511.1 511.3 511.4 511.1 511.1
## 70% 514.9 515.0 514.6 514.6 514.5 514.8 514.8 514.6 514.5 514.9 514.7
## 95% 530.5 531.3 531.1 531.0 532.0 532.1 532.6 533.1 533.4 533.2 533.3
##     [,67] [,68] [,69] [,70] [,71] [,72] [,73] [,74] [,75] [,76] [,77]
## 31% 500.5 500.0 500.4 500.3 500.3 499.8 499.8 500.2 499.5 499.9 499.8
## 52% 508.6 508.4 508.2 508.0 508.5 508.1 508.5 508.3 508.5 508.6 508.5
## 60% 510.8 511.1 510.7 511.0 511.2 511.0 511.4 511.7 511.4 511.8 511.6
## 70% 514.6 515.2 515.4 515.1 515.5 515.6 515.4 515.4 515.6 516.0 516.0
## 95% 533.0 533.1 533.6 533.5 533.4 533.8 534.0 535.0 534.7 534.6 535.0
##     [,78] [,79] [,80] [,81] [,82] [,83] [,84] [,85] [,86] [,87] [,88]
## 31% 499.6 499.4 499.7 499.2 499.8 500.0 499.6 499.7 499.4 499.6 499.5
## 52% 508.6 509.0 508.8 508.6 508.8 508.9 508.9 509.1 509.0 509.1 509.1
## 60% 512.1 512.1 511.9 511.9 511.9 512.1 512.2 512.2 512.2 512.3 512.2
## 70% 515.7 516.0 515.8 516.1 516.1 516.3 516.1 516.3 516.5 517.0 517.2
## 95% 535.7 536.3 536.6 537.0 536.5 536.8 536.7 536.5 536.8 537.5 536.6
##     [,89] [,90] [,91] [,92] [,93] [,94] [,95] [,96] [,97] [,98] [,99]
## 31% 499.4 499.7 499.3 498.9 499.0 499.0 498.7 499.3 499.0 499.6 499.0
## 52% 509.0 509.2 509.3 509.0 508.8 509.1 509.2 509.3 508.8 508.7 508.6
## 60% 512.7 512.6 512.3 512.5 512.3 512.2 512.4 513.0 513.3 512.9 512.7
## 70% 516.7 516.6 516.9 516.8 516.9 516.9 516.8 517.4 517.5 517.5 517.4
## 95% 537.3 536.6 536.9 537.5 537.4 537.0 537.5 537.4 537.3 537.6 537.6
##     [,100]
## 31%  499.3
## 52%  508.7
## 60%  512.4
## 70%  516.7
## 95%  537.9
</code></pre>

<h4>3.1.5  Generate  1000 random samples  with 100 time periods for dry peas price using the parameters from estimate</h4>

<p>One simulation, different time different result. And time period still is 100 (&ldquo;yuimu&rdquo; default: delta = 1/100).</p>

<pre><code class="r">require(yuima)
# initial value is 188
m1 = setModel(drift = &quot;theta*(mu-x)&quot;, diffusion = &quot;sigma&quot;, state.var = &quot;x&quot;, 
    time.var = &quot;t&quot;, solve.var = &quot;x&quot;, xinit = ouFit.ML(dry.peas)[[2]])
Xdry.peas = simulate(m1, true.param = list(mu = ouFit.ML(dry.peas)[[2]], sigma = ouFit.ML(dry.peas)[[3]], 
    theta = ouFit.ML(dry.peas)[[1]]))
plot(Xdry.peas)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAb1BMVEX9/v0AAAAAADkAAGUAOTkAOY8AZrU5AAA5ADk5AGU5OWU5OY85ZrU5j9plAABlADllAGVlOQBlOY9ltf2POQCPOTmPOWWPZgCPjzmPtY+P29qP2/21ZgC1/v3ajzna/v39tWX924/9/rX9/tr9/v0hSaxkAAAAJXRSTlP///////////////////////////////////////////////8AP89CTwAAAAlwSFlzAAALEgAACxIB0t1+/AAAD2RJREFUeJzt3Qtb4zYWgOFqpgM7OwudFtrtFgi3/P/fuARCItuSLFtHN5/ve56WTOJIct5cnMAwv+xJZb/UXgDVCXilAa804JUGvNKAVxrwSgNeacArDXilAa804JUGvNKAVxrwSgNeacArDXilAa804JUGvNKAVxrwSgNeacArDXilAa804JUGvNKAVxrwSgNeacArDXilAa804JUGvNKAVxrwSgNeacArDXilAa804JUGvNKAVxrwSgNeacArDXilAa804JUGvNKAVxrwSgNeacArDXilpcAbarmM8AnXpdwBrzTglQa80oBXGvBKA15pwCsNeKUBrzTglQa80pqA5y5SPuCVBrzSWoCf+94wZQh4pVWDN/ZJ5IsHvNKAV1oD8IbD+gqVhbe0ga8b8EoDXmnAK60ovHX4foY3Ecsg8arBn04CX6Vk+OfL97+J9fUhYuiBNvBVS4V/vb15//r07XF+aODbKRX+5efD4GtwaODbqfoj3sQsg8RLfo1/uY5+jR8+zIGvWsmjeuAbqjC8xQ181STezl3sop/qLecBPPKlSz64+/Nuv7t48/8xf3AHfENJvJ3bXQ3eznl/vQ7wDdXSIx78gkm8xl/FvcZbn9QAX72CR/VOePv9HfAFqwI/ugscvwJfMomn+i93UZ/Vjx7swFdN4rP619urFfCj784Yfsi6aDLfnbu/AL6zhL47t/v1+xz85PB9Ao98wQS+O3d1+LKbvp/zwttv5Ix9MfDlKndUD3xTNQMfsRgSrOS3ZY/nGvty4CtVHP78dh34mgGvtArw9gnjvoiyB7zSysMPLge+VsArDXilAa804JVWEd769Db6KiQV8EoDXmnAKw14pQGvtLrw402ALxbwSgNeacArrUV4+AsEvNKA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" alt="plot of chunk unnamed-chunk-18"/> </p>

<p>Increasing the number of simulation to 1000, and time period still is 100 (&ldquo;yuimu&rdquo; default: delta = 1/100). Plot the mean of the 1000 silumtion result, different time , very similar result.</p>

<pre><code class="r">simnum = 1000
# specific qunatile (which we can pick any another quantile)
dist = c(0.31, 0.52, 0.6, 0.7, 0.95)
newsim = function(i) {
    simulate(m1, true.param = list(mu = ouFit.ML(dry.peas)[[2]], sigma = ouFit.ML(dry.peas)[[3]], 
        theta = ouFit.ML(dry.peas)[[1]]))@data@original.data
}
# newsim(1) simulation 1000 times, each time there are 100 time periods
sim = sapply(1:simnum, function(x) newsim(x))
# transfor to time seires format.
m2 = t(sim)
mdry.peas &lt;- apply(m2, 2, mean)

# plot the mean of the 1000 time simulation for the 100 time periods
plot(mdry.peas, type = &quot;l&quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAgVBMVEX9/v0AAAAAADkAAGUAOTkAOWUAOY8AZrU5AAA5ADk5AGU5OWU5OY85ZrU5j9plAABlADllAGVlOQBlOY9lZmVltf2POQCPOTmPOWWPZgCPjzmPtY+P29qP2/21ZgC1/rW1/v3ajzna24/a/rXa/tra/v39tWX924/9/rX9/tr9/v1a4D1vAAAAK3RSTlP///////////////////////////////////////////////////////8AI8mn0AAAAAlwSFlzAAALEgAACxIB0t1+/AAAEkJJREFUeJztnQt746gVhpfMNM5OU3uzrZN2utbGbX3T//+BlSzb0QUQiMP1fO8zk4skDpDXSICQ/UsNWPJL7AKAOEA8UyCeKRDPFIhnCsQzBeKZAvFMgXimQDxTIJ4pEM8UiGcKxDMF4pkC8UyBeKZAPFMgnikQzxSIZwrEMwXimQLxTIF4pkA8UyCeKRDPFIhnCsQzBeKZAvFMgXimQDxTIJ4pEM8UiGcKxDMF4pkC8UyBeKZAPFMgnikQzxSIZwrEMwXimQLxTIF4pkA8UyCeKRDPFIhnCsQzBeKZAvFMgXimQDxTXMQLkDIexTukBb6BeKZAPFMgnikQzxSIZwrEMwXimQLxTIF4pkA8UyCeKeHE43WQFBDPFIhnCsQzxVX8+e2zPm+EeD7MhYb4pCAQ37qvT3+bCw3xSUEg/vR66Fq+PjTEJ4Wz+M3TH/9sW/zr5FwP8Snj3rm7vItVffw2afCT0DCfEgFn7qzE41XiGYhnCpX4+c4dxCcFWjxTkhUP835xF19dH8jZzoeG+JRwFl81yvfbulrNhob4lKCYq29nb4g7dwIXec+4ir987Or6uKqP07s0EJ8yzqf67tbc8Wn3FVLxIC7Ep0SivXqI9w3EM8X97tzaNLSdeJj3i3uv/qdsDC8NbaES4n1DMZyrhOSmLMSnDck4vu3aT91DfMrQiDcLDfEJEfIRKohPCIhnirP404toZ+0M5uotVAq7w4E9znP179vm/xric4Omc1etID4zKFp8w/77D4jPCoK7c9c52z3pOB7ivZNmrx7ivQPxTIF4poQUb65S2B0O7IF4pkA8UyCeKUmKF3aHgwVAPFNSFg/zHokifk4oxPsnhvjZByIh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" alt="plot of chunk unnamed-chunk-19"/> </p>

<pre><code class="r">
# find out the quantile to decribe the distribution
tile = sapply(1:100, function(x) quantile(m2[, x], dist))
tile
</code></pre>

<pre><code>##      [,1]  [,2]  [,3]  [,4]  [,5]  [,6]  [,7]  [,8]  [,9] [,10] [,11]
## 31% 279.5 278.8 278.5 278.3 278.1 278.0 277.8 277.6 277.3 277.3 277.3
## 52% 279.5 279.5 279.6 279.6 279.6 279.7 279.6 279.7 279.6 279.7 279.7
## 60% 279.5 279.8 280.0 280.0 280.1 280.4 280.3 280.4 280.5 280.5 280.4
## 70% 279.5 280.1 280.5 280.7 280.9 281.2 281.2 281.3 281.5 281.7 281.8
## 95% 279.5 281.7 282.8 283.2 283.9 284.3 284.9 285.4 286.2 286.4 286.7
##     [,12] [,13] [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22]
## 31% 277.3 277.2 277.1 277.0 276.9 276.8 276.5 276.6 276.7 276.4 276.2
## 52% 279.7 279.7 279.8 279.7 279.7 279.8 279.8 279.9 279.8 279.8 280.0
## 60% 280.6 280.7 280.9 280.7 281.0 281.0 280.9 281.1 281.0 281.1 281.1
## 70% 281.9 282.2 282.1 282.3 282.2 282.3 282.6 282.7 282.7 282.9 283.0
## 95% 287.0 287.5 287.8 287.6 288.4 288.5 288.9 289.4 289.3 289.5 289.5
##     [,23] [,24] [,25] [,26] [,27] [,28] [,29] [,30] [,31] [,32] [,33]
## 31% 276.1 275.9 276.0 276.0 275.8 275.7 275.5 275.5 275.4 275.6 275.2
## 52% 279.7 279.9 279.6 279.7 279.9 279.9 279.7 279.8 279.7 279.9 279.8
## 60% 281.1 281.2 281.1 281.1 281.1 281.4 281.2 281.4 281.4 281.3 281.4
## 70% 282.9 282.8 283.0 282.9 283.2 283.5 283.5 283.4 283.4 283.5 283.6
## 95% 290.2 290.2 290.3 290.3 291.3 291.1 291.5 291.1 291.6 292.1 292.3
##     [,34] [,35] [,36] [,37] [,38] [,39] [,40] [,41] [,42] [,43] [,44]
## 31% 275.3 275.4 275.2 275.0 275.1 275.0 274.8 274.9 274.7 274.6 274.6
## 52% 280.0 279.9 279.9 280.1 279.9 279.7 279.5 279.6 279.5 279.7 279.8
## 60% 281.6 281.5 281.5 281.5 281.4 281.5 281.2 281.2 281.4 281.3 281.4
## 70% 283.6 283.6 283.8 283.7 283.6 283.6 283.7 283.9 284.1 284.3 284.1
## 95% 292.7 292.3 292.4 292.7 292.8 293.1 293.4 293.8 294.0 294.3 294.1
##     [,45] [,46] [,47] [,48] [,49] [,50] [,51] [,52] [,53] [,54] [,55]
## 31% 274.5 274.5 274.3 274.4 274.0 273.8 273.9 274.0 274.0 274.0 274.1
## 52% 279.6 279.6 279.6 279.9 279.7 279.8 279.8 279.7 280.0 279.8 279.9
## 60% 281.5 281.2 281.6 281.5 281.4 281.7 281.7 281.9 281.9 281.8 281.8
## 70% 284.1 284.2 284.3 284.4 284.6 284.5 284.6 284.7 284.5 284.4 284.8
## 95% 295.3 295.5 295.2 295.5 296.1 296.2 296.3 296.7 296.7 296.7 296.3
##     [,56] [,57] [,58] [,59] [,60] [,61] [,62] [,63] [,64] [,65] [,66]
## 31% 274.1 274.1 274.0 273.9 273.9 273.9 274.0 273.8 273.9 273.9 274.3
## 52% 279.9 280.0 280.0 279.9 279.9 280.0 279.8 279.9 279.9 280.0 279.9
## 60% 282.1 282.1 282.2 282.2 282.2 282.1 282.2 282.3 282.3 282.4 282.4
## 70% 284.7 285.2 284.7 284.9 285.1 285.1 284.9 285.1 285.2 285.0 285.1
## 95% 296.2 296.7 296.8 296.7 296.8 296.8 297.2 297.1 297.0 297.6 298.1
##     [,67] [,68] [,69] [,70] [,71] [,72] [,73] [,74] [,75] [,76] [,77]
## 31% 273.8 273.7 273.8 273.9 273.7 273.3 273.3 273.6 273.5 273.6 273.5
## 52% 280.0 280.1 280.0 280.2 280.2 280.0 280.3 280.2 280.0 280.1 280.2
## 60% 282.4 282.3 282.4 282.3 282.5 282.5 282.3 282.2 282.3 282.5 282.1
## 70% 285.3 285.2 285.1 285.1 285.1 285.3 285.7 285.4 285.8 285.7 285.5
## 95% 297.8 298.2 298.4 298.1 298.6 299.0 299.1 299.0 299.4 299.9 299.5
##     [,78] [,79] [,80] [,81] [,82] [,83] [,84] [,85] [,86] [,87] [,88]
## 31% 273.5 273.2 273.2 273.3 273.2 273.2 272.9 273.3 273.4 273.1 273.1
## 52% 280.1 280.0 280.2 280.2 279.9 280.3 280.4 280.1 280.2 280.1 280.2
## 60% 282.4 282.6 282.2 282.2 282.2 282.2 282.3 282.8 282.7 282.9 282.6
## 70% 285.3 285.3 285.5 285.0 285.2 285.6 285.5 285.6 285.6 285.8 285.9
## 95% 299.7 300.1 299.6 300.0 300.0 300.2 300.5 300.8 300.7 300.3 300.2
##     [,89] [,90] [,91] [,92] [,93] [,94] [,95] [,96] [,97] [,98] [,99]
## 31% 272.9 273.0 272.9 273.0 273.0 273.0 273.2 273.0 272.5 272.4 272.5
## 52% 280.2 280.2 280.1 280.1 280.1 280.1 280.1 280.3 279.8 280.3 280.3
## 60% 282.8 282.7 282.6 282.6 282.6 282.5 282.4 282.5 282.6 282.8 282.8
## 70% 286.0 286.1 285.9 285.9 285.9 285.8 286.0 285.7 285.7 286.1 285.9
## 95% 300.1 300.0 300.3 300.1 300.8 300.3 300.7 300.8 300.7 301.2 301.2
##     [,100]
## 31%  272.7
## 52%  280.4
## 60%  282.6
## 70%  286.3
## 95%  301.0
</code></pre>

<h3>3.2 &ldquo;Sde.sim&rdquo; packages</h3>

<p>Recall &ldquo;sde.sim&rdquo; package uses this notation:</p>

<p>\[ dX_t = (\theta_1 - \theta_2X_t)dt +\theta_3dW_t,    X_0 = x_0 \]</p>

<p>For &ldquo;sde.sim&rdquo; packages, each price simulation uses different random seed. When we try the same random seed, all prices have the same trend.</p>

<h4>3.2.1 Generate  1 random samples with 1000 time periods for wheat price using the parameters from estimate</h4>

<pre><code class="r">set.seed(123)

thetaw &lt;- c(ouFit.ML(wheat)[[1]] * ouFit.ML(wheat)[[2]], ouFit.ML(wheat)[[1]], 
    ouFit.ML(wheat)[[3]])
Xwheat &lt;- sde.sim(X0 = ouFit.ML(wheat)[[2]], model = &quot;OU&quot;, theta = thetaw, N = 1000, 
    delta = 1)
</code></pre>

<pre><code>## 
## T set to = 1000.000000
</code></pre>

<pre><code class="r">plot(Xwheat, main = &quot; Ornstein - Uhlenbeck &quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAilBMVEX9/v0AAAAAADkAAGUAOTkAOY8AZrU5AAA5ADk5AGU5OQA5OWU5OY85ZrU5j9plAABlADllAGVlOQBlOY9lZjlltf2POQCPOTmPOWWPZgCPj2WPtY+P29qP2/21ZgC1tWW124+1/rW1/tq1/v3ajzna24/a/rXa/tra/v39tWX924/9/rX9/tr9/v2Tum2yAAAALnRSTlP///////////////////////////////////////////////////////////8Ago9zVQAAAAlwSFlzAAALEgAACxIB0t1+/AAAFsVJREFUeJzt3Qt7o0h2BuA97m17J+mRZ7OxZpK0vZu0NmnJqv//9wKCgrpRFyigivN9z0xbAupUwStu8kV/EgjL/GnvASD7BPBMA3imATzTAJ5pAM80gGcawDMN4JkG8EwDeKYBPNMAnmkAzzSAZxrAMw3gmQbwTAN4pgE80wCeaQDPNIBnGsAzDeCZpn74z1ci+vrTs8THm7r0lx9Tddo59/OXH+3/noWH2RMl6kj18LcXavP0PrnEB71NzlMC+KpyP9OzaHG//ryfn/6dnr6fv/ydqAVoXxKtYvOyaBa5NF/eOpv7sIgaDf4fL+38blLfcmjVPXgcY/pZ7Sjk8s3DqNfZ3qkd/vbyEGjQ3x/EX//v/DgCPHengP75c/PKaHOSNt0iWlT4oUQzSbYcpvYPmn71WV9+tMtf6nCvHv7a+zXH827nb/49NVO//uxfEt2h/vGkRe3hu0W0Shr86dGinTS0HFo9Hny+Pr0Ps24vjxfIW7P8P15Om2+DWTkUfHuif/z7+dqqUXc8b+Gv1F8JdPD9Im3D9oTweKTCDyW+/BhaDlO7c3xTdZh1pU67eTX8SyU7fPXw2qG+g3+cbJupj8u+ZpIDXi4iLHhtvgHfT3XBd6++4bVWQWqH1y/uNHghur19ONS3seDVSifRH8sV+KGlAq8e6ts8DvUXOnXn+DqO9bXDK7dzBnw3o7s6kxd3naUb/nGJ3l+rKfBDSxVeu7iTU7oLiFpu6aqH7y6pW0TXob6d0nztkZovHvjufHASBrxsqR7q5e3cB40PHlcAzSLXOnb5+uGRWQE80wCeaQDPNIBnGsAzDeCZBvBMA3imATzTAJ5pAM80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" alt="plot of chunk unnamed-chunk-20"/> </p>

<h4>3.2.2  Generate  1 random samples  with 1000 time periods for oats price using the parameters from estimate</h4>

<pre><code class="r">set.seed(321)

thetao &lt;- c(ouFit.ML(oats)[[1]] * ouFit.ML(oats)[[2]], ouFit.ML(oats)[[1]], 
    ouFit.ML(oats)[[3]])
Xoats &lt;- sde.sim(X0 = ouFit.ML(oats)[[2]], model = &quot;OU&quot;, theta = thetao, N = 1000, 
    delta = 1)
</code></pre>

<pre><code>## 
## T set to = 1000.000000
</code></pre>

<pre><code class="r">plot(Xoats, main = &quot; Ornstein - Uhlenbeck &quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-21"/> </p>

<h4>3.2.3 Generate  1 random samples  with 1000 time periods for barley price using the parameters from estimate</h4>

<pre><code class="r">set.seed(132)

thetab &lt;- c(ouFit.ML(barley)[[1]] * ouFit.ML(barley)[[2]], ouFit.ML(barley)[[1]], 
    ouFit.ML(barley)[[3]])
# set initial value as the long term mean mu.
Xbarley &lt;- sde.sim(X0 = ouFit.ML(barley)[[2]], model = &quot;OU&quot;, theta = thetab, 
    N = 1000, delta = 1)
</code></pre>

<pre><code>## 
## T set to = 1000.000000
</code></pre>

<pre><code class="r">plot(Xbarley, main = &quot; Ornstein - Uhlenbeck &quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAilBMVEX9/v0AAAAAADkAAGUAOTkAOY8AZrU5AAA5ADk5AGU5OQA5OWU5OY85ZrU5j9plAABlADllAGVlOQBlOY9lZjlltf2POQCPOTmPOWWPZgCPj2WPtY+P29qP2/21ZgC1tWW124+1/rW1/tq1/v3ajzna24/a/rXa/tra/v39tWX924/9/rX9/tr9/v2Tum2yAAAALnRSTlP///////////////////////////////////////////////////////////8Ago9zVQAAAAlwSFlzAAALEgAACxIB0t1+/AAAFd9JREFUeJzt3Qtb47gVBuAeKNBtp2GmLdltu9ALtCUh+v9/r75bsi6WZMm2fL7v2Z2QWDqW9ca3ADO/EQjL/GbrASDbBPBMA3imATzTAJ5pAM80gGcawDMN4JkG8EwDeKYBPNMAnmkAzzSAZxrAMw3gmQbwTAN4pgE80wCeaQDPNIBnGsAzDeCZpnz4r2cievh0tHh7kVvfv9vq1Etu5/v3+n9H42GxpUQZKR7++kR17l6tLd7oxbpMCuCLyu1Mj6LGffi8ne/+Qne/nu//QVQD1G+JWrF6W1RNPqqHl9bmNjSRo8D/86le3r7U9Rx6tV80x5huUT2Kvn31pdf7bOuUDn99agQq9NeG+OF/5+YI8NieArrnj9U7o86pt2mbKJHhhxLVS33P4dXui2q96qL797r9RxnuxcNfOr/qeN7u/NWfp+rVh8/uLdEe6psnNWoH3zZRKinwp6ZH/dLQc+jVfPH1fPc6LLo+NW+Ql6r9P59Oq89BVA4FX5/omz+/nms1ao/nNfyFuiuBFr5rUnesTwjNVzL8UOL+feg5vNqe46uqw6ILtdrVu+H3hezwxcMrh/oWvjnZVq82l33VSwb4vonQ4JXlE/juVRN8++4b3msFpHR49eJOgRei3duHQ30dDV6udBLdsVyCH3pK8PKhvk5zqP+gU3uOL+NYXzq8dDs3gW8XtFdn/cVda2mGby7Ru2s1CX7oKcMrF3f9K+0FRCm3dMXDt5fUNaLpUF+/Uj12SNWDA749H5zEBL7vKR/q+9u5Nxq/aK4AqiaXMnb58uGRqACeaQDPNIBnGsAzDeCZBvBMA3imATzTAJ5pAM80gGcawDMN4JkG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" alt="plot of chunk unnamed-chunk-22"/> </p>

<h4>3.2.4 Generate  1 random samples with 1000 time periods for canola price using the parameters from estimate</h4>

<pre><code class="r">set.seed(312)

thetac &lt;- c(ouFit.ML(canola)[[1]] * ouFit.ML(canola)[[2]], ouFit.ML(canola)[[1]], 
    ouFit.ML(canola)[[3]])
Xcanola &lt;- sde.sim(X0 = ouFit.ML(canola)[[2]], model = &quot;OU&quot;, theta = thetac, 
    N = 1000, delta = 1)
</code></pre>

<pre><code>## 
## T set to = 1000.000000
</code></pre>

<pre><code class="r">plot(Xcanola, main = &quot; Ornstein - Uhlenbeck &quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAhFBMVEX9/v0AAAAAADkAAGUAOY8AZrU5AAA5ADk5AGU5OQA5OWU5OY85ZrU5j9plAABlADllAGVlOQBlOY9lZjlltf2POQCPOTmPOWWPZgCPj2WPtY+P29qP2/21ZgC1tWW124+1/rW1/tq1/v3ajzna24/a/tra/v39tWX924/9/rX9/tr9/v0UYhVAAAAALHRSTlP/////////////////////////////////////////////////////////AMfWCYwAAAAJcEhZcwAACxIAAAsSAdLdfvwAABYISURBVHic7d2LeuO2EQXgjnftpE3stKmdtI3dtHa6kjXv/37lnSAJgAAJgADnnC/Z1ZLEAOIv3iTZ/BMjIvOnoweAHBPACw3ghQbwQgN4oQG80ABeaAAvNIAXGsALDeCFBvBCA3ihAbzQAF5oAC80gBcawAsN4IUG8EIDeKEBvNAAXmgALzSAF5ry4T+fiOjrN8sSb8/q0l/eTXXqObeXL+/1/5aFh9mGEmWkePjrA9W5ezUu8UbPxnlKAF9Ubi90zzXu12+3l7u/091vL1/+TVQD1C+JWrF6WVSLfFR/Pbc2t2ERNRP43x/q+e2kruXQqn3Q7GO6WfUo+uWrh06vs6NTOvz1oRGo0F8b4q//e2n2APftIaD79331yqjz2Nu0i0yiwg8lqkl9y2Fq96Dqdzrry3u9/EcZ7sXDXzq/an/ebvzVn4/V1K/fupdEu6tv/lGjdvDtIpNKE/jHpkU9aWg5tGoefD7dvQ6zrg/NC+S5Wv73h8fk62BTTgVfH+ibPz+fajVq9+c1/IW6M4EWvlukblgfEJpHKvxQ4sv70HKY2h7jq6rDrAu12tWr4c+FbPDFw0929S18c7CtpjanfdUkDXy/CC/gJ/Nn8N1UHXz76hteawWkdPjpyd0Enrnd2oddfZ0FvFrpkbt9uQI/tFTg1V19nWZX/0GP7TG+jH196fDK5dwMvp3Rnp31J3etpR6+OUXvztUU+KGlCj85ueuntCcQpVzSFQ/fnlLXiLpdfT2l+rtDqv6ywLfHg0eewfct1V19fzn3RuOD5gygWuRSxiZfPjyyKYAXGsALDeCFBvBCA3ihAbzQAF5oAC80gBcawAsN4IUG8EIDeKEBvNAA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" alt="plot of chunk unnamed-chunk-23"/> </p>

<h4>3.2.5 Generate  1 random samples with 1000 time periods for dry.peas price using the parameters from estimate</h4>

<pre><code class="r">set.seed(231)

thetad &lt;- c(ouFit.ML(dry.peas)[[1]] * ouFit.ML(dry.peas)[[2]], ouFit.ML(dry.peas)[[1]], 
    ouFit.ML(dry.peas)[[3]])
Xdry.peas &lt;- sde.sim(X0 = ouFit.ML(dry.peas)[[2]], model = &quot;OU&quot;, theta = thetad, 
    N = 1000, delta = 1)
</code></pre>

<pre><code>## 
## T set to = 1000.000000
</code></pre>

<pre><code class="r">plot(Xdry.peas, main = &quot; Ornstein - Uhlenbeck &quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAilBMVEX9/v0AAAAAADkAAGUAOTkAOY8AZrU5AAA5ADk5AGU5OQA5OWU5OY85ZrU5j9plAABlADllAGVlOQBlOY9lZjlltf2POQCPOTmPOWWPZgCPj2WPtY+P29qP2/21ZgC1tWW124+1/rW1/tq1/v3ajzna24/a/rXa/tra/v39tWX924/9/rX9/tr9/v2Tum2yAAAALnRSTlP///////////////////////////////////////////////////////////8Ago9zVQAAAAlwSFlzAAALEgAACxIB0t1+/AAAFqJJREFUeJzt3Qt7o0h2BuA97m17O+mRZ7OxZ5KMvZu0NmnJrv//98KdulM3oOB83zNjqwV1KPEKKCRZ/EkgLPOnvTuA7BPAMw3gmQbwTAN4pgE80wCeaQDPNIBnGsAzDeCZBvBMA3imATzTAJ5pAM80gGcawDMN4JkG8EwDeKYBPNMAnmkAzzSAZ5rjw388E9HXn5453l/kub/8cNVpp3y+fvnR/u+ZeZrsKHGMHB7+/kRtHt6cc7zTi3OaFMAfKp+v9Cha3K8/P18f/p0e/nj98neiFqB9SrSKzdOimeXa/HrpbT6nWeQo8P94aqf3dw0tp1b9jW4fM0xqezHO39wMep7tnaPD3586gQb9rSP++n+v3R7gsT8EDP9+bJ4ZbS6jTT+LEhl+KtHcNbac7h1uNMtVJ3350c5/PYb74eFvg1+zP+83/ubnpbn368/hKdHv6rt/tKgDfD+LUkmBv3Qt2rumllOr7sbH88PbNOn+1D1BXpr5//F02XwdJOVU8O2Bvvv58dyqUb8/b+FvNIwEevhhlrZhe0DobsnwU4kvP6aW0739Mb6pOk26Ua/dPBv+5SAb/OHhlV19D98dbJt7u2Ffc5cFfpxFGPDKdA1+uNcG3z/7pufaAXJ0eHVwp8AL0W/t066+jQEvV7qIYV8uwU8tJXh5V9+m29Vf6dIf44+xrz86vHQ6p8H3E/rR2Ti46y3t8N0QfRirSfBTSxleGdyN9/QDiKOc0h0evh9St4i2XX17T/N7QGp+eeD748FFaPBjS3lXP57OvdN8oxsBNLPcjrHJHx8eSQrgmQbwTAN4pgE80wCeaQDPNIBnGsAzDeCZBvBMA3im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" alt="plot of chunk unnamed-chunk-24"/> </p>

<h2>4  Conclusion</h2>

<p>This documents show we can use ouFit.ML function to estimate the parameter \( \theta \), \( \mu \), and \( \sigma \).
And them use the <strong>&ldquo;yuima&rdquo;</strong> package to generate the simulative price vector/matrices. </p>

</body>

</html>

